<!-- macro JglossHead "gotchas" --><!-- generated --><!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>gotchas : Java Glossary</title>
<meta http-equiv="lang" content="en">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta name="Author" content="Roedy Green  (250) 361-9093 of Canadian Mind Products. For email see contact page.">
<meta name="Copyright" content="Canadian Mind Products 1996-2010">
<meta name="Description" content="Canadian Mind Products Java &amp; Internet Glossary : gotchas">
<meta name="Generator" content="CMP Static HTML Macros">
<meta name="Keywords" content="definition, glossary, gotchas, introduction, Java, overview, precis, primer, Roedy Green, terminology">
<link href="../mindprod.css" type="text/css" rel="stylesheet" media="screen">
<link href="../jdisplay.css" type="text/css" rel="stylesheet" media="screen">
<link rel="meta" href="../labels.rdf" type="application/rdf+xml" title="ICRA labels">
<link rel="home" href="../index.html">
<link rel="icon" href="../image/icon16/jgloss.png">
<link rel="alternate" type="application/rss+xml" title="Canadian Mind Products | Java Glossary" href="http://mindprod.com/rss/jgloss.xml">
<link rel="prev" href="g.html">
</head>
<body><a name="TOP"></a>

<span class="ad"><script type="text/javascript"><!--
google_ad_client="pub-3625079171090429";
google_ad_width=180;
google_ad_height=150;
google_ad_format="180x150_as";
google_ad_type = "text_image";
google_ad_channel="";
google_color_border = "336699";
google_color_bg = "ffffff";
google_color_link = "0000ff";
google_color_url = "008000";
google_color_text = "000000";
// --></script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></span>
<span class="translate"><script type="text/javascript" src="http://www.gmodules.com/ig/ifr?url=http://www.google.com/ig/modules/translatemypage.xml&amp;up_source_language=en&amp;w=160&amp;h=60&amp;title=&amp;border=&amp;output=js"></script></span>
<div class="titlejgloss"><h1>&nbsp;<a name="TITLE"></a>gotchas : Java Glossary</h1></div>
<span class="nowrap"><a class="plain" href="../index.html#TITLE" target="_top"><img src="../image/navigate/home.png" alt="go to home page" width="24" height="24" align="middle" border="0"></a>
<a class="plain" href="g.html" target="_top"><img src="../image/navigate/back.png" alt="G words" width="24" height="24" align="middle" border="0"></a>
<a class="plain" href="jagg.html" target="_top"><img src="../image/navigate/localfind.png" alt="local find" width="24" height="24" align="middle" border="0"></a>
<a class="plain" href="gotchas.html" target="_top"><img src="../image/navigate/fullscreen.png" alt="full screen, hide local find menu" width="24" height="24" align="middle" border="0"></a>
<a class="plain" href="http://www.google.com/search?q=gotchas+Java"><img src="../image/navigate/googlesearch.png" alt="Google search web for more information on this topic" width="22" height="22" align="middle" border="0"></a>
<a class="plain" href="#BOTTOM"><img src="../image/navigate/tobottom.png" alt="jump to foot of page" width="24" height="24" align="middle" border="0"></a>
<a class="plain" href="http://www.altavista.com/babelfish/tr?url=http://mindprod.com/jgloss/gotchas.html"><img src="../image/navigate/babelfish.png" alt="translate this page with Babelfish" width="32" height="32" align="middle" border="0"></a>
</span> <span class="indexletters"><a href="punct.html">punctuation</a> <a href="0-9.html">0-9</a> <a href="a.html">A</a> <a href="b.html">B</a> <a href="c.html">C</a> <a href="d.html">D</a> <a href="e.html">E</a> <a href="f.html">F</a> <a href="g.html">G</a> <a href="h.html">H</a> <a href="i.html">I</a> <a href="j.html">J</a> <a href="k.html">K</a> <a href="l.html">L</a> <a href="m.html">M</a> <a href="n.html">N</a> <a href="o.html">O</a> <a href="p.html">P</a> <a href="q.html">Q</a> <a href="r.html">R</a> <a href="s.html">S</a> <a href="t.html">T</a> <a href="u.html">U</a> <a href="v.html">V</a> <a href="w.html">W</a> <a href="x.html">X</a> <a href="y.html">Y</a> <a href="z.html">Z</a> (<a href="masterindex.html">all</a>)</span>
<ul class="breadcrumb"><li class="firstbreadcrumb">You are here :</li>
<li><a class="plain" href="../index.html#TITLE" target="_top">home</a></li>
<li><a class="plain" href="jgloss.html" target="_top">Java Glossary</a></li>
<li><a class="plain" href="g.html" target="_top">G words</a></li>
<li><span class="term">gotchas</span></li>
<li class="lastbreadcrumb">&nbsp;</li></ul>
<span class="copyright">&copy;<span class="date">1996-2010</span> Roedy Green, Canadian Mind Products</span>
<br><!-- /generated by JglossHead -->
<dl>
<dt><a name="GOTCHAS"></a><span class="gotcha">Gotchas</span><!-- alias gotchyas -->
<!-- alias gochyas --><!-- alias gotyas --><!-- alias #OVERRIDE override --></dt>
<dd>
A gotcha is a nasty surprise in the Java language or the standard libraries. Some might call them bugs, some
features. Sometimes they are the result of incompetence or carelessness on the part of the language designers and
sometimes they are just quirky things that cannot be helped. Here is a chart of the some dangerous waters.
<p>I spoke on this topic in <span class="date">1997-11</span> at the <a class="offsite" href="http://www.SoftwareSummit.com">Colorado Summit Conference</a>, and again in <span class="date">1999-11</span>.</p>
<table class="gridmenu" summary="menu"><!-- this mennu is manually composed because of the bifficulty numbers --><thead><tr><th>Gotcha</th>
<th>Difficulty</th></tr></thead>
<tbody><tr><td><a href="#EXTENSIONS">Inconsistent extensions</a></td>
<td align="center">1</td></tr>
<tr><td><a href="#KANSAS">We Aren&rsquo;t In Kansas Anymore
<br>
basic differences from C</a></td>
<td align="center">1</td></tr>
<tr><td><a href="#FALLTHRU">Default Fall Through</a></td>
<td align="center">1</td></tr>
<tr><td><a href="#REPLACE">String.replace</a></td>
<td align="center">1</td></tr>
<tr><td><a href="#MICROFONTS">Microscopic Fonts</a></td>
<td align="center">1</td></tr>
<tr><td><a href="#SEPARATOR">Separator vs Terminator</a></td>
<td align="center">1</td></tr>
<tr><td><a href="#DOUBLE">double Double Toil and Trouble</a></td>
<td align="center">1</td></tr>
<tr><td><a class="redirect" href="inconsistencies.html">Inconsistencies</a></td>
<td align="center">2</td></tr>
<tr><td><a href="#TOSTRING">toString blues</a></td>
<td align="center">2</td></tr>
<tr><td><a href="#IMPOTENTCASTS">Impotent Casts</a></td>
<td align="center">2</td></tr>
<tr><td><a href="#CHAR">Is char a character or a number?</a></td>
<td align="center">2</td></tr>
<tr><td><a href="#OCTAL">Octal</a></td>
<td align="center">2</td></tr>
<tr><td><a href="#CONSTRUCTORS">The Case of The Disappearing Constructors</a></td>
<td align="center">2</td></tr>
<tr><td><a href="#HEX">Missing Hex</a></td>
<td align="center">2</td></tr>
<tr><td><a href="#SIN">Math.sin</a></td>
<td align="center">2</td></tr>
<tr><td><a href="#BEEP">Where&rsquo;s the Beep?</a></td>
<td align="center">2</td></tr>
<tr><td><a href="#ROOT">Where&rsquo;s the Root Directory?</a></td>
<td align="center">2</td></tr>
<tr><td><a href="#FOREACH">for each</a></td>
<td align="center">2</td></tr>
<tr><td><a href="#FOR">Unstoppable <i>for</i></a></td>
<td align="center">2</td></tr>
<tr><td><a href="#UPPERCASE">Upper Case Surprises</a></td>
<td align="center">2</td></tr>
<tr><td><a class="redirect" href="shift.html#SHIFTLESSHIFT">Shiftless Shift</a></td>
<td align="center">2</td></tr>
<tr><td><a href="#SUBSTRING">String.substring</a></td>
<td align="center">2</td></tr>
<tr><td><a href="#NAN">Incomparable NaN</a></td>
<td align="center">2</td></tr>
<tr><td><a class="redirect" href="string.html#COMPARISON">String Comparison</a></td>
<td align="center">2</td></tr>
<tr><td><a href="#STRINGBUFFER">StringBuffer.equals</a></td>
<td align="center">2</td></tr>
<tr><td><a href="#VALUEOF">ValueOf and null</a></td>
<td align="center">2</td></tr>
<tr><td><a href="#FINAL">Final vs Const</a></td>
<td align="center">2</td></tr>
<tr><td><a href="#OVERFLOW">Overflow</a></td>
<td align="center">2</td></tr>
<tr><td><a href="#OVERRIDE">Override vs Shadow</a></td>
<td align="center">3</td></tr>
<tr><td><a href="#SETLOCATION">&ldquo;broken&rdquo; setLocation, setSize, setBackground, setForeground</a></td>
<td align="center">3</td></tr>
<tr><td><a href="#UNSIGNEDBYTES">Unsigned Bytes</a></td>
<td align="center">3</td></tr>
<tr><td><a href="#MODULUS">Modulus</a></td>
<td align="center">3</td></tr>
<tr><td><a class="redirect" href="array.html#ARRAYINITGOTCHAS">Array Initialisation</a></td>
<td align="center">3</td></tr>
<tr><td><a class="redirect" href="array.html#ARRAYCOMPAREGOTCHAS">Array Comparison</a></td>
<td align="center">3</td></tr>
<tr><td><a class="redirect" href="array.html#MATRIXGOTCHAS">Matrix Initialisation</a></td>
<td align="center">3</td></tr>
<tr><td><a class="redirect" href="array.html#ARRAYSTOREEXCEPTION">ArrayStoreException</a> arrays of Dogs and
Dalmatians</td>
<td align="center">3</td></tr>
<tr><td><a href="#STATICINIT">Static Initialisers</a></td>
<td align="center">3</td></tr>
<tr><td><a href="#INSTANCEINIT">Instance Initialisers</a></td>
<td align="center">3</td></tr>
<tr><td><a href="#CONSTRUCTORINIT">Constructor Initialisation</a></td>
<td align="center">3</td></tr>
<tr><td><a href="#CASTS">Casts</a> Dalmatians are Dogs</td>
<td align="center">3</td></tr>
<tr><td><a href="#IMPLICITCASTS">Implicit Casts</a></td>
<td align="center">3</td></tr>
<tr><td><a href="#CONCATENATION">Concatenation</a></td>
<td align="center">3</td></tr>
<tr><td><a href="#STUTTERING">M y O u t p u t L o o k s L i k e T h i s</a></td>
<td align="center">3</td></tr>
<tr><td><a class="redirect" href="cascadedassignment.html">Cascaded Assignment Operators</a></td>
<td align="center">3</td></tr>
<tr><td><a class="redirect" href="pseudorandom.html">Pseudo Random Numbers</a></td>
<td align="center">3</td></tr>
<tr><td><a href="#FINALIZE">Finalizers Are Not Destructors</a></td>
<td align="center">3</td></tr>
<tr><td><a href="#FINALLY">Finally</a></td>
<td align="center">3</td></tr>
<tr><td><a href="#THREADS">Thread Safety</a></td>
<td align="center">3</td></tr>
<tr><td><a href="#BIGDECIMAL">java.math.BigDecimal</a></td>
<td align="center">3</td></tr>
<tr><td><a class="redirect" href="date.html#DATEGOTCHAS">java.util.Date</a></td>
<td align="center">4</td></tr>
<tr><td><a class="redirect" href="gregoriancalendar.html#GREGORIANCALENDARGOTCHAS">java.util.GregorianCalendar</a></td>
<td align="center">4</td></tr>
<tr><td><a href="#DRAWRECT">java.awt.Graphics.drawRect</a></td>
<td align="center">4</td></tr>
<tr><td><a href="#DRAWSTRING">java.awt.Graphics.drawString</a></td>
<td align="center">4</td></tr>
<tr><td><a href="#GRIDBAGLAYOUT">GridBagLayout</a></td>
<td align="center">4</td></tr>
<tr><td><a href="#NULLLAYOUT">Null Layout</a></td>
<td align="center">4</td></tr>
<tr><td><a href="#DEPRECATION">Deprecation Blues</a></td>
<td align="center">4</td></tr>
<tr><td><a href="#BUFFEREDREADER">java.io.BufferedReader &amp; BufferedInputStream</a></td>
<td align="center">4</td></tr>
<tr><td><a href="#APPLETRESTRICTIONS">Applets Can&rsquo;t Use The Local Hard Disk</a></td>
<td align="center">4</td></tr>
<tr><td><a href="#SERIALIZATION">Reconstituted Serialized Objects</a></td>
<td align="center">4</td></tr>
<tr><td><a href="#REPAINT">&quot;Broken&quot; Repaint</a></td>
<td align="center">4</td></tr>
<tr><td><a href="#HIDDEN">Hidden Components Won&rsquo;t Stay Hidden</a></td>
<td align="center">4</td></tr>
<tr><td><a href="#DIALOG">Dialog.setBackground Does Not Work</a></td>
<td align="center">4</td></tr>
<tr><td><a href="thread.html#GOTCHAS">Threads</a></td>
<td align="center">4</td></tr>
<tr><td><a href="#SOCKET">Socket To Me</a></td>
<td align="center">4</td></tr>
<tr><td><a class="redirect" href="keystroke.html#KEYSTROKENAMEGOTCHAS">Keystroke Names</a></td>
<td align="center">4</td></tr>
<tr><td><a href="#JSP">JSP Import Blues</a></td>
<td align="center">4</td></tr>
<tr><td><a class="redirect" href="jtable.html#TABLECELLRENDERER">TableCellRenderer</a></td>
<td align="center">4</td></tr>
<tr><td><a href="errormessages.html">Misleading Error Messages</a></td>
<td align="center">5</td></tr>
<tr><td><a href="#CREDITS">Credits</a></td>
<td align="center">-</td></tr>
<tr><td><a href="#BOOKS">Books</a></td>
<td align="center">-</td></tr></tbody></table>
<h2 class="gotcha"><a name="EXTENSIONS"></a>Inconsistent Extensions</h2>
Sometimes the extension should be obvious, e.g. <span class="ext">*.java</span> when compiling, or <span class="ext">*.class</span> when executing. You would think the extension would be optional. It is not. Sometimes you
must specify it, and sometimes you must not. And sometimes you can get away with doing it either way, on some
platforms. Here are the rules that will always work.
<table class="standard"><thead><tr><th>Where</th>
<th>Extension Mandatory?</th>
<th>Example</th></tr></thead>
<tbody><tr><td>compiling</td>
<td>mandatory</td>
<td><!-- macro JDisplay gotchas.example201.bat --><!-- generated --><pre class="bat"><span class="keyword">CD </span><span class="separator">\</span>MyDir
javac<span class="operator">.</span>exe <span class="operator">-</span>classpath <span class="operator">. </span>HelloWorld<span class="operator">.</span>java</pre><!-- /generated by JDisplay --></td></tr>
<tr><td>executing</td>
<td>must exclude</td>
<td><!-- macro JDisplay gotchas.example202.bat --><!-- generated --><pre class="bat"><span class="keyword">CD </span><span class="separator">\</span>MyDir
java<span class="operator">.</span>exe <span class="operator">-</span>classpath <span class="operator">. </span>HelloWorld</pre><!-- /generated by JDisplay --></td></tr>
<tr><td>Applet</td>
<td>mandatory</td>
<td><!-- macro JDisplay gotchas.example501.html --><!-- generated --><pre class="html"><span class="htmltag">&lt;applet</span>
<span class="htmltag">code=</span><span class="htmlstring">&quot;HelloWorld.class&quot;</span>
<span class="htmltag">width=</span><span class="htmlstring">&quot;230&quot;</span>
<span class="htmltag">height=</span><span class="htmlstring">&quot;240&quot;</span><span class="htmltag">&gt;</span>
  <span class="htmltag">&lt;img src=</span><span class="htmlstring">&quot;image/NoJava4U.jpg&quot;</span><span class="htmltag">&gt;</span>
<span class="htmltag">&lt;/applet&gt;</span></pre><!-- /generated by JDisplay --></td></tr></tbody></table>
<h2 class="gotcha"><a name="KANSAS"></a>We Aren&rsquo;t In Kansas Anymore</h2>
<span class="writteninc">C</span>/<span class="writtenincpp">C++</span> programmers will attempt to write code
like this: <!-- macro JDisplay gotchas.example101.javafrag --><!-- generated --><pre class="java"><span class="keyword">if </span><span class="fence1">(</span> <span class="var">width </span><span class="fence1">)</span>
   <span class="fence1">{</span>
   <span class="method">widen</span><span class="fence1">(</span> <span class="var">width </span><span class="fence1">)</span><span class="semicolon">;</span>
   <span class="fence1">}</span>
<span class="keyword">if </span><span class="fence1">(</span> <span class="var">myDog </span><span class="fence1">)</span>
   <span class="fence1">{</span>
   <span class="var">myDog</span><span class="operator">.</span><span class="method">bark</span><span class="fence1">(</span><span class="fence1">)</span><span class="semicolon">;</span>
   <span class="fence1">}</span></pre><!-- /generated by JDisplay -->
You need to spell these out longhand in <span class="writteninjava">Java</span> :
<!-- macro JDisplay gotchas.example102.javafrag --><!-- generated --><pre class="java"><span class="keyword">if </span><span class="fence1">(</span> <span class="var">width </span><span class="operator">!= </span><span class="decimallow">0 </span><span class="fence1">)</span>
   <span class="fence1">{</span>
   <span class="method">widen</span><span class="fence1">(</span> <span class="var">width </span><span class="fence1">)</span><span class="semicolon">;</span>
   <span class="fence1">}</span>
<span class="keyword">if </span><span class="fence1">(</span> <span class="var">myDog </span><span class="operator">!= </span><span class="keyword">null </span><span class="fence1">)</span>
   <span class="fence1">{</span>
   <span class="var">myDog</span><span class="operator">.</span><span class="method">bark</span><span class="fence1">(</span><span class="fence1">)</span><span class="semicolon">;</span>
   <span class="fence1">}</span></pre><!-- /generated by JDisplay -->
However, for boolean variables you can say things like: <!-- macro JDisplay gotchas.example103.javafrag --><!-- generated --><pre class="java"><span class="keyword">if </span><span class="fence1">(</span> <span class="var">tooWide </span><span class="fence1">)</span>
   <span class="fence1">{</span>
   <span class="method">widen</span><span class="fence1">(</span> <span class="var">width </span><span class="fence1">)</span><span class="semicolon">;</span>
   <span class="fence1">}</span></pre><!-- /generated by JDisplay -->
Beware, you can also inadvertently say things like like: <!-- macro JDisplay gotchas.example104.javafrag --><!-- generated --><pre class="java"><span class="keyword">if </span><span class="fence1">(</span> <span class="var">tooWide </span><span class="operator">= </span><span class="keyword">true </span><span class="fence1">)</span>
   <span class="fence1">{</span>
   <span class="method">widen</span><span class="fence1">(</span> <span class="var">width </span><span class="fence1">)</span><span class="semicolon">;</span>
   <span class="fence1">}</span></pre><!-- /generated by JDisplay -->
Note: that the <span class="operator">=</span> above is an assignment operator, not an <span class="operator">==</span> comparison operator. The if is always true.
<h2 class="gotcha"><a name="FALLTHRU"></a>Default Fall Through</h2>
C programmers are familiar with this, but those coming from languages designed by Professor Wirth will gasp in
astonishment that Java would allow such unstructured code. <!-- macro JDisplay gotchas.example105.javafrag --><!-- generated --><pre class="java"><span class="keyword">switch </span><span class="fence1">(</span> <span class="var">k </span><span class="fence1">)</span>
   <span class="fence1">{</span>
   <span class="keyword">case </span><span class="decimallow">1</span><span class="operator">:</span>
      <span class="class">System</span><span class="operator">.</span><span class="var">out</span><span class="operator">.</span><span class="method">println</span><span class="fence1">(</span> <span class="string">&quot;hello&quot;</span> <span class="fence1">)</span><span class="semicolon">;</span>
   <span class="keyword">case </span><span class="decimallow">2</span><span class="operator">:</span>
      <span class="class">System</span><span class="operator">.</span><span class="var">out</span><span class="operator">.</span><span class="method">println</span><span class="fence1">(</span> <span class="string">&quot;hi&quot;</span> <span class="fence1">)</span><span class="semicolon">;</span>
   <span class="fence1">}</span></pre><!-- /generated by JDisplay -->
When k is 1, the program will print out both <span class="output">&quot;hello &quot;</span> and <span class="output">&quot;hi&quot;</span>. Case clauses fall though by default. You won&rsquo;t get a syntax error or even a
warning if you leave out the break after each case.
<p>Because the syntax for defining cases and labels is so similar, it is easy to make an error like this: The
programmer left out a space and, instead of handling n == 3, he defined a goto label called case3 in his switch
statement.</p> <!-- macro JDisplay gotchas.example106.javafrag --><!-- generated --><pre class="java"><span class="keyword">switch </span><span class="fence1">(</span> <span class="var">n </span><span class="fence1">)</span>
   <span class="fence1">{</span>
   <span class="keyword">case </span><span class="decimallow">1</span><span class="operator">:</span>
      <span class="operator">...</span>
   <span class="keyword">case </span><span class="decimallow">2</span><span class="operator">:</span>
      <span class="operator">...</span>
      <span class="var">case3</span><span class="operator">:</span>
      <span class="operator">...</span>
   <span class="keyword">case </span><span class="decimallow">4</span><span class="operator">:</span>
      <span class="operator">...</span>
   <span class="fence1">}</span></pre><!-- /generated by JDisplay -->
In JDK <span class="version">1.4+</span> you can use the <span class="bat">javac.exe -Xswitchcheck</span> to get
the compiler to warn you if you do this. However, there is no syntax to tell Java when you meant to do it
deliberately, e. g. a <span class="keyword">break case</span> or <span class="keyword">fallthrough</span>
keyword.
<h2 class="gotcha"><a name="REPLACE"></a>String.replace</h2>
<!-- macro JDisplay gotchas.replace.javafrag --><!-- generated --><pre class="java"><span class="commentslashslash">// String.replace produces a new String. It does not modify the original.</span>
<span class="commentslashslash">// Since String is immutable, no method cAN modify the original.</span>

<span class="class">String </span><span class="vardef">aa </span><span class="operator">= </span><span class="string">&quot;peal&quot;</span><span class="semicolon">;</span>
<span class="class">String </span><span class="vardef">bb </span><span class="operator">= </span><span class="var">aa</span><span class="operator">.</span><span class="method">replace</span><span class="fence1">(</span> <span class="charliteral">'a'</span><span class="operator">, </span><span class="charliteral">'e'</span> <span class="fence1">)</span><span class="semicolon">;</span>

<span class="class">System</span><span class="operator">.</span><span class="var">out</span><span class="operator">.</span><span class="method">println </span><span class="fence1">(</span> <span class="var">aa </span><span class="operator">+ </span><span class="string">&quot; &quot;</span> <span class="operator">+ </span><span class="var">bb </span><span class="fence1">)</span><span class="semicolon">;</span>
<span class="commentslashslash">// Prints &quot;peal peel&quot; not &quot;peel peel&quot;</span>
<span class="commentslashslash">// Newbies often expect String aa to be changed too.</span></pre><!-- /generated by JDisplay -->
<span class="class">String</span>. <span class="method">replace</span> does not modify the input <span class="class">String</span>. It could not, even if it wanted to, since <span class="class">String</span>s are
immutable. Further, the Javadocs for <span class="method">replace</span> explain that <span class="method">replace</span> creates a new <span class="class">String</span>.
<!-- macro Sun "String.replace" "api/java/lang/String.html#replace(char,%20char)" --><!-- generated --><div class="sun">Sun&rsquo;s Javadoc on <span class="classdef">String</span><span class="methoddef">.replace</span> : available:<ul><li>on the web at <a class="sun" href="http://java.sun.com/javase/6/docs/api/java/lang/String.html#replace(char,%20char)">java.sun.com</a></li>
<li>in the current <a href="file:///J:/Program%20Files/java/jdk1.6.0_18/docs/api/java/lang/String.html#replace(char,%20char)">JDK <span class="version">1.6.0_18</span></a> or in the old <a href="file:///J:/Program%20Files/java/jdk1.5.0_22/docs/api/java/lang/String.html#replace(char,%20char)">JDK <span class="version">1.5.0_22</span></a> on your local Windows <a class="plain" href="jdrive.html"><span class="drive">J:</span> drive</a>.</li></ul></div>
<!-- /generated by Sun -->This gotcha is not Sun&rsquo;s fault. The same applies to <span class="class">String</span>. <span class="method">toUpperCase</span> and <span class="class">String</span>.
<span class="method">toLowerCase</span>.
<h2 class="gotcha"><a name="MICROFONTS"></a>Microscopic Fonts</h2>
Sometimes fonts will come out too tiny to see. Likely it means you have reversed the last two parmameters when
you created the font, a error the compiler cannot detect since <span class="class">Font</span> does not use
<span class="keyword">enum</span>s, just enumerated <span class="keyword">int</span> constants.
<!-- macro JDisplay font.gotchas.javafrag --><!-- generated --><pre class="java"><span class="commentslashslash">// OOPS, DON'T DO THIS!</span>
<span class="var">component</span><span class="operator">.</span><span class="method">setFont</span><span class="fence1">(</span> <span class="keyword">new </span><span class="class">Font</span><span class="fence2">(</span> <span class="string">&quot;Dialog&quot;</span><span class="operator">, </span><span class="decimallow">12</span><span class="operator">, </span><span class="class">Font</span><span class="operator">.</span><span class="constant">BOLD </span><span class="fence2">)</span><span class="fence1">)</span><span class="semicolon">;</span>

<span class="commentslashslash">// do this instead:</span>
<span class="var">component</span><span class="operator">.</span><span class="method">setFont</span><span class="fence1">(</span> <span class="keyword">new </span><span class="class">Font</span><span class="fence2">(</span> <span class="string">&quot;Dialog&quot;</span><span class="operator">, </span><span class="class">Font</span><span class="operator">.</span><span class="constant">BOLD</span><span class="operator">, </span><span class="decimallow">12 </span><span class="fence2">)</span><span class="fence1">)</span><span class="semicolon">;</span></pre><!-- /generated by JDisplay -->
<p><!-- macro Qualified Font.createFont --><!-- generated --><span class="class">Font</span><span class="operator">.</span><span class="method">createFont</span><!-- /generated by Qualified -->
produces a font 1 point high, too tiny to see. You must use <span class="class">Font</span>. <span class="method">deriveFont</span> before you can use it.</p>
<h2 class="gotcha"><a name="SEPARATOR"></a>Separator vs Terminator</h2>
Java is rather loosey goosey about the use of <span class="term">separators</span> and a <span class="term">terminators</span>.
<ul><li>Semicolons <b>terminate</b> Java source code statements. You need one after the last statement in a
group.</li>
<li>Commas <b>separate</b> parameters or arguments in a method. You must not have a comma after the last
parameter/argument in the group.</li>
<li>Commas <b>separate</b> (or optionally <b>terminate</b>) elements in an array literal e.g.
<!-- macro JDisplay array.literal.javafrag --><!-- generated --><pre class="java"><span class="commentslashslash">// Using comma to separate elements of an array literal</span>
<span class="keyword">int</span><span class="fence1">[</span><span class="fence1">]</span> <span class="vardef">x </span><span class="operator">= </span><span class="fence1">{</span> <span class="decimallow">10</span><span class="operator">, </span><span class="decimallow">20</span><span class="operator">, </span><span class="decimallow">30 </span><span class="fence1">}</span><span class="semicolon">;</span>

<span class="commentslashslash">// Using comma to terminate elements of an array literal</span>
<span class="keyword">int</span><span class="fence1">[</span><span class="fence1">]</span> <span class="vardef">y </span><span class="operator">= </span><span class="fence1">{</span>
           <span class="decimallow">10</span><span class="operator">,</span>
           <span class="decimallow">20</span><span class="operator">,</span>
           <span class="decimallow">30</span><span class="operator">,</span>
           <span class="fence1">}</span><span class="semicolon">;</span>

<span class="commentslashslash">// both forms are legal.</span></pre><!-- /generated by JDisplay --></li>
<li><span class="char">\n</span> should <b>terminate</b> each line (including the last one) in a <a href="textfile.html">text file</a>, even though the corresponding system property that defines the
platform-dependent end of line marker is called <span class="property">line.separator</span>. The system
property <span class="property">line.separator</span> is a misnomer. It would better have been called
<span class="property">line.terminator</span>.</li></ul>
<h2 class="gotcha"><a name="DOUBLE"></a>double Double Toil and Trouble</h2>
The compiler for languages such as Eiffel goes through Houdiniesque contortions to let you treat primitives as
objects while simultaneously giving primitives express treatment when you don&rsquo;t need the objectness. In
such languages, you can write code analogous to this:
<div class="bali"><span class="comment">/* This <b>won&rsquo;t</b> work in <span class="writteninjava">Java</span> ! */</span>
<br>
int <b>ii</b> = -42;
<br>
int <b>jj</b> = ii.abs();
<br>
String <span class="ac">s</span> = ii.toString();</div>
But in <span class="writteninjava">Java</span>, you can&rsquo;t use instance methods on primitives. However, you
still need set of standard methods to deal with <span class="keyword">byte</span>s, <span class="keyword">short</span>s, <span class="keyword">char</span>s, <span class="keyword">int</span>s, <span class="keyword">float</span>s and <span class="keyword">double</span>s. So Sun created a set of classes called
<span class="keyword">Byte</span>, <span class="keyword">Short</span>, <span class="keyword">Character</span>
(not Char), <span class="keyword">Integer</span> (not Int), <span class="keyword">Float</span> and <span class="keyword">Double</span>. They wrote everything to fiddle with primitives as <span class="keyword">static</span>
methods! What else could they do?
<p>You need to treat primitives as objects for another purpose &mdash; so that you can put them into containers
such as <span class="class">ArrayList</span>s or <span class="class">Vector</span>s. In Java, you must manually
wrap your primitive up in an object. Sun provides a set of immutable object wrapper classes called: <span class="class">Byte</span>, <span class="class">Short</span>, <span class="class">Character</span> (not Char),
<span class="class">Integer</span> (not Int), <span class="class">Float</span> and <span class="class">Double</span>, the very same classes that house your <span class="keyword">static</span> methods for
fiddling with primitives! It might have been clearer had they called these classes names like <span class="class">ImmutableByte</span> or <span class="class">ByteWrapper</span>, but they didn&rsquo;t. You can&rsquo;t
change the value of the primitive inside any of these wrapper objects. All you can do is create a new object with
a new immutable primitive sitting inside.</p>
<p>To make matters all the more confusing, the <span class="class">Double</span> class then has double duty, to
deal with both <span class="keyword">double</span> primitives and <span class="class">Double</span> wrapper
objects. The instance methods for <span class="class">Double</span> manipulate <span class="class">Double</span>
objects and the <span class="keyword">static</span> methods for <span class="class">Double</span> manipulate
<span class="keyword">double</span> primitives. These methods naturally have similar if not identical names! The
same problem occurs for all the other primitive/class pairs, but most newbies seem to trip over it first with
<!-- macro JDisplay gotchas.example1.javafrag --><!-- generated --><pre class="java"><span class="keyword">double </span><span class="vardef">d</span><span class="semicolon">; </span><span class="commentslashstar">/* double primitive */</span>
<span class="class">Double </span><span class="vardef">dd</span><span class="semicolon">; </span><span class="commentslashstar">/* Double wrapper */</span>
<span class="class">String </span><span class="vardef">g</span><span class="semicolon">;</span>
<span class="var">g </span><span class="operator">= </span><span class="class">Double</span><span class="operator">.</span><span class="method">toString</span><span class="fence1">(</span> <span class="var">d </span><span class="fence1">)</span><span class="semicolon">; </span><span class="commentslashstar">/* double primitive */</span>
<span class="var">g </span><span class="operator">= </span><span class="var">dd</span><span class="operator">.</span><span class="method">toString</span><span class="fence1">(</span><span class="fence1">)</span><span class="semicolon">; </span><span class="commentslashstar">/* Double wrapper */</span></pre><!-- /generated by JDisplay -->
See the <a href="conversion.html">conversion</a> for help in interconverting the various primitives and wrappers.
<h2 class="gotcha"><a name="TOSTRING"></a>toString Blues</h2>
<span class="key">toString</span> is defined on every object to allow you to convert it to a <span class="class">String</span>. However, the <span class="class">String</span> you get is often nothing like you would
expect.
<p>With the default <span class="method">toString</span>, you just get the class name and hashcode of the object,
which looks like gibberish, e.g. <span class="output">[C@ad3ba4</span>.</p>
<p><!-- macro JDisplay gotchas.example3.javafrag --><!-- generated --><pre class="java"><span class="keyword">char</span><span class="fence1">[</span><span class="fence1">]</span> <span class="vardef">c </span><span class="operator">= </span><span class="fence1">{</span> <span class="charliteral">'a'</span> <span class="operator">, </span><span class="charliteral">'b'</span> <span class="operator">, </span><span class="charliteral">'c'</span><span class="fence1">}</span><span class="semicolon">;</span>
<span class="class">System</span><span class="operator">.</span><span class="var">out</span><span class="operator">.</span><span class="method">println</span><span class="fence1">(</span> <span class="var">c</span><span class="operator">.</span><span class="method">toString</span><span class="fence2">(</span><span class="fence2">)</span> <span class="fence1">)</span><span class="semicolon">;</span></pre><!-- /generated by JDisplay -->
will print out the address of c, not the characters that compose it. You must use <span class="java"><span class="keyword">new</span><span class="class">String</span> <span class="fence1">(</span> <span class="keyword">char</span><span class="operator">[]</span> <span class="fence1">)</span></span> to convert a
<span class="keyword">char</span> array to a <span class="class">String</span>.
<p><span class="method">Label.toString()</span> is not an alias for <span class="method">Label.getText()</span>.
It will print out a summary of the <span class="class">Label</span> fields like this: <span class="output">java.awt.Label[label0,0,0,0x0,invalid,align=left,text=def]</span></p>
<p>How then do you convert to <span class="class">String</span>? With a hodgepodge of techniques that rival
French verbs for irregularity.</p>
<div class="see"><a class="applet" href="../applet/converter.html">conversion</a></div>
<h2 class="gotcha"><a name="IMPOTENTCASTS"></a>Impotent Casts</h2>
Casts that reasonable people would expect to work, are invalid in <span class="writteninjava">Java</span>. For
example, you can&rsquo;t cast an <span class="keyword">int</span> to a <span class="class">String</span> or the
reverse with (<span class="keyword">int</span>) <span class="string">&quot;42&quot;</span> or (<span class="class">String</span>) <span class="numeric">42</span>. Instead you must use a hodge podge of methods to
interconvert the basic types whose names are more chaotic than French irregular verbs. It is a disgrace. It is
such a mess, that I wrote an <span class="class">Applet</span>, called <a class="applet" href="../applet/converter.html">Converter</a> to generate the necessary conversion code.
<h2 class="gotcha"><a name="CHAR"></a>Is char a character or a number?</h2>
<span class="keyword">char</span> can be thought of as a character or an unsigned <span class="statistic">16</span>-bit integer. This ambiguity catches up with us in a statement like this:
<!-- macro JDisplay gotchas.example107.javafrag --><!-- generated --><pre class="java"><span class="class">String </span><span class="vardef">x </span><span class="operator">= </span><span class="string">&quot;foo&quot;</span> <span class="operator">+ </span><span class="charliteral">'s'</span><span class="semicolon">;</span></pre><!-- /generated by JDisplay -->
In JDK <span class="version">1.6+</span>, <span class="var">x</span> is <span class="string">&quot;foos&quot;</span>. In early JDK <span class="version">1.2</span> it is <span class="string">&quot;foo115&quot;</span>, but was fixed for the release version.
<h2 class="gotcha"><a name="OCTAL"></a>Octal</h2>
I have not seen octal used since the days of the Univac 1106 (except for Unix file permissions), however Java has
carried on the C and <span class="writtenincpp">C++</span> tradition. Any numeric <a href="literal.html">literal</a> with a lead zero on it is considered base 8, octal. Beware, programmers are used to
using lead zeros simply to align numbers in columns.
<h2 class="gotcha"><a name="CONSTRUCTORS"></a>The Case of The Disappearing Constructors</h2>
When you define a <a href="constructor.html">constructor</a>, you must <b>not</b> specify a return type, even
though it behaves much like a static factory method that returns an object. You may not even specify a
<span class="keyword">void</span> return type. It is best to think of constructors as like parameterless instance
methods that operate on the current object.
<p>Even though a constructor is similar to static method that returns a new object, you may not declare the
constructor static. It is not static, since it works on specific default object. <span class="keyword">this</span> is defined in the constructor.</p>
<p>If you do any of these things, the compiler will think your constructor is just an ordinary method. You will
be baffled by the compiler&rsquo;s complaints that you have not defined a suitable constructor to match the
arguments you provide.</p>
<p>It may help if you realise that <span class="keyword">new</span> allocates/creates the object and the
constructor initializes it. Therefore the constructor has no need to return an object.</p>
<p>If you don&rsquo;t provide any constructors at all, Java will automatically provide you with a default
constructor the form: <!-- macro JDisplay gotchas.example4.javafrag --><!-- generated --><pre class="java"><span class="keyword">public </span><span class="classdef">MyClass</span><span class="fence1">(</span><span class="fence1">)</span>
   <span class="fence1">{</span>
   <span class="keyword">super</span><span class="fence1">(</span><span class="fence1">)</span><span class="semicolon">;</span>
   <span class="fence1">}</span></pre><!-- /generated by JDisplay -->
However, if you get ambitious and write an extra constructor, say like this:
<!-- macro JDisplay gotchas.example5.javafrag --><!-- generated --><pre class="java"><span class="keyword">private </span><span class="classdef">MyClass</span><span class="fence1">(</span> <span class="keyword">int </span><span class="vardef">fudgicles </span><span class="fence1">)</span>
   <span class="fence1">{</span>
   <span class="keyword">this</span><span class="operator">.</span><span class="var">fudgicles </span><span class="operator">= </span><span class="var">fudgicles</span><span class="semicolon">;</span>
   <span class="fence1">}</span></pre><!-- /generated by JDisplay -->
The default constructor will disappear! You have to then provide it yourself explicitly.
<p>You will most likely come across this problem when you see the following error message:</p>
<div class="output">load: com.mindprod.mypackage.MyApplet.class can&rsquo;t be instantiated. java.lang.InstantiationException:
com/mindprod/mypackage/MyApplet</div>
<p>In English, it means you are missing the default public constructor for your Applet. See <a href="constructor.html">constructor</a>.</p>
<h2 class="gotcha"><a name="HEX"></a>Missing Hex</h2>
In Java Strings, you can no longer say <span class="string">&quot;\xf2&quot;</span>, <span class="string">&quot;\a&quot;</span> or <span class="string">&quot;\v&quot;</span> as you can in <span class="writtenincpp">C++</span>. Happily <span class="string">&quot;\n&quot;</span>, <span class="string">&quot;\r
&quot;</span>, <span class="string">&quot;\\&quot;</span>, <span class="string">&quot;\'&quot;</span> and
<span class="string">&quot;\&quot;&quot;</span> still work. To encode control characters without specific
abbreviations you must now use octal, e.g. <span class="string">&quot;\012&quot;</span> for a linefeed, formerly
<span class="string">&quot;\x0a &quot;</span>. Octal character constants must be exactly 3 digits. See <a href="literal.html">literal</a> in the Java &amp; Internet Glossary.
<p>The new hex Unicode technique <span class="string">&quot;\u003f&quot;</span> has a catch. It is not suitable
for encoding control characters. It is evaluated in a pre-processor pass and converted to a character, then the
code is compiled. If for example you wrote <span class="string">&quot;\u000a&quot;</span>, this gets converted
to: <!-- macro JDisplay gotchas.example109.javafrag --><!-- generated --><pre class="java"><span class="gibberish">&quot;</span>
<span class="gibberish">&quot;</span></pre><!-- /generated by JDisplay -->
Since the <span class="string">\u000a</span> gets converted to a newline character. It definitely won&rsquo;t
work for Cr and Lf. It might work for some of the other control chars in some compilers. I suggest using the
octal forms for safety.
<h2 class="gotcha"><a name="SIN"></a>Math.sin</h2>
Every novice tries code like this: <!-- macro JDisplay gotchas.example6.javafrag --><!-- generated --><pre class="java"><span class="keyword">double </span><span class="vardef">x </span><span class="operator">= </span><span class="decimallow">90</span><span class="semicolon">;</span>
<span class="keyword">double </span><span class="vardef">y </span><span class="operator">= </span><span class="method">sin</span><span class="fence1">(</span> <span class="var">x </span><span class="fence1">)</span><span class="semicolon">;</span>
<span class="keyword">double </span><span class="vardef">z </span><span class="operator">= </span><span class="method">tan</span><span class="fence1">(</span> <span class="var">x </span><span class="operator">+ </span><span class="constant">PI </span><span class="fence1">)</span><span class="semicolon">;</span></pre><!-- /generated by JDisplay -->
And stares and stares at it wondering why it won&rsquo;t work. You need to write it this way:
<!-- macro JDisplay gotchas.example7.javafrag --><!-- generated --><pre class="java"><span class="commentslashslash">// converting degrees to radians, manually.</span>
<span class="keyword">static final double </span><span class="constant">CONVERT_DEGREES_TO_RADIANS </span><span class="operator">= </span><span class="class">Math</span><span class="operator">.</span><span class="constant">PI </span><span class="divoperator">/ </span><span class="decimallow">180</span><span class="semicolon">;</span>
<span class="keyword">double </span><span class="vardef">x </span><span class="operator">= </span><span class="decimallow">90 </span><span class="operator">* </span><span class="constant">CONVERT_DEGREES_TO_RADIANS</span><span class="semicolon">;</span>
<span class="keyword">double </span><span class="vardef">y </span><span class="operator">= </span><span class="class">Math</span><span class="operator">.</span><span class="method">sin</span><span class="fence1">(</span> <span class="var">x </span><span class="fence1">)</span><span class="semicolon">;</span>
<span class="keyword">double </span><span class="vardef">z </span><span class="operator">= </span><span class="class">Math</span><span class="operator">.</span><span class="method">tan</span><span class="fence1">(</span> <span class="var">x </span><span class="operator">+ </span><span class="class">Math</span><span class="operator">.</span><span class="constant">PI </span><span class="fence1">)</span><span class="semicolon">;</span></pre><!-- /generated by JDisplay -->
There are three places to trip up:
<ol><li>the Math package works in radians, not degrees. 360 degrees = 2 pi radians.</li>
<li>You need the Math.sin instead of plain sin because sin, cos, tan etc. are <b>static</b> functions. Compared
with other languages you may have used, Java is picky and verbose. It wants the &quot;Math.&quot; even when
there is no name clash with a sin function in some class other than Math or some package other than java.lang.
Java wants to avoid even the possibility of an eventual name clash by making you qualify with Math.sin now. In
a similar way, you must precede <b>all</b> static function and method invocations with the classname.</li>
<li>You need the Math.PI instead of plain PI because PI is a static constant. In a similar way you must precede
<b>all</b> static constants with the class name.</li>
<li>JDK <span class="version">1.2</span> has added two convenience methods:
<!-- macro JDisplay gotchas.example8.javafrag --><!-- generated --><pre class="java"><span class="commentslashslash">// built-in radians &lt;-&gt; degrees methods.</span>
<span class="keyword">public static double </span><span class="method">toDegrees </span><span class="fence1">(</span> <span class="keyword">double </span><span class="vardef">angleInRadians </span><span class="fence1">)</span><span class="semicolon">;</span>
<span class="keyword">public static double </span><span class="method">toRadians </span><span class="fence1">(</span> <span class="keyword">double </span><span class="vardef">angleInDegrees </span><span class="fence1">)</span><span class="semicolon">;</span></pre><!-- /generated by JDisplay --></li></ol>
<span class="java">Math.sin(Double.PI) != 0</span> since <span class="constant">Double.PI</span> isn&rsquo;t
precisely equal to the irrational number PI. So <span class="method">Math.sin(Double.PI)</span> shouldn&rsquo;t
be expected to be exactly equal to sin(PI). Similarly <span class="method">Math.cos( Math.toRadians( 90 )
)</span> is not bang on zero either.
<p>Further, every time you do a <a href="floatingpoint.html">floating point</a> calculation you loose a little
precision. It all adds up.</p>
<p>In Java 5.0 you no longer need the <span class="class">Math.</span> in <span class="class">Math</span>.
<span class="method">sin</span>() so long as you add an <span class="keyword">import</span> like this:
<!-- macro JDisplay gotchas.mathdot.javafrag --><!-- generated --><pre class="java"><span class="keyword">import static </span><span class="var">java</span><span class="operator">.</span><span class="var">lang</span><span class="operator">.</span><span class="class">Math</span><span class="semicolon">;</span></pre><!-- /generated by JDisplay -->
<h2 class="gotcha"><a name="BEEP"></a>Where&rsquo;s the Beep?</h2>
Java does not have a built-in set of sounds. It ignores <span class="char">'\a'</span> in console output,
though you can use <span class="string">\007</span>.
<p>In JDK <span class="version">1.6+</span> You can make a simple beep with j <span class="method">java.awt.Toolkit.beep()</span>. I have seen reports that beep does not work properly on some
platforms.</p>
<p>In JDK <span class="version">1.0.2</span> you can use <!-- macro JDisplay gotchas.example110.javafrag --><!-- generated --><pre class="java"><span class="class">System</span><span class="operator">.</span><span class="var">out</span><span class="operator">.</span><span class="method">print </span><span class="fence1">(</span> <span class="string">&quot;\007&quot;</span> <span class="fence1">)</span><span class="semicolon">;</span>
<span class="class">System</span><span class="operator">.</span><span class="var">out</span><span class="operator">.</span><span class="method">flush</span><span class="fence1">(</span><span class="fence1">)</span><span class="semicolon">;</span></pre><!-- /generated by JDisplay -->
You can also play <a href="au.html">AU</a>, <a href="wav.html">wav</a>, midi and aiff files with <span class="method">AudioClip.play</span>.
<p>See sound in the Java &amp; Internet Glossary for more details.</p>
<h2 class="gotcha"><a name="ROOT"></a>Where&rsquo;s the Root Directory?</h2>
You might look a long time through <span class="class">java.io.*</span> trying to find the directory operations,
before you find them hiding in the <span class="class">File</span> class e.g. list a directory to find out the
files in it. However, <!-- macro JDisplay gotchas.example9.javafrag --><!-- generated --><pre class="java"><span class="class">File </span><span class="vardef">dir </span><span class="operator">= </span><span class="keyword">new </span><span class="class">File</span><span class="fence1">(</span> <span class="gibberish">&quot;C:\\&quot; );</span>
<span class="class">String</span><span class="fence1">[</span><span class="fence1">]</span> <span class="vardef">files </span><span class="operator">= </span><span class="var">dir</span><span class="operator">.</span><span class="method">list</span><span class="fence2">(</span><span class="fence2">)</span><span class="semicolon">;</span></pre><!-- /generated by JDisplay -->
won&rsquo;t cut it. To look at the root. You must say: <!-- macro JDisplay gotchas.example10.javafrag --><!-- generated --><pre class="java"><span class="class">File </span><span class="vardef">dir </span><span class="operator">= </span><span class="keyword">new </span><span class="class">File</span><span class="fence1">(</span> <span class="string">&quot;C:\\.&quot;</span> <span class="fence1">)</span><span class="semicolon">;</span>
<span class="class">String</span><span class="fence1">[</span><span class="fence1">]</span> <span class="vardef">files </span><span class="operator">=</span><span class="var">dir</span><span class="operator">.</span><span class="method">list</span><span class="fence1">(</span><span class="fence1">)</span><span class="semicolon">;</span></pre><!-- /generated by JDisplay -->
Be aware that <span class="string">&quot;\&quot;</span> in <span class="writteninjava">Java</span> Strings has to
be written as <span class="string">&quot;\\&quot;</span>.
<p>This makes reading Strings representing filenames confusing. Unix systems use the &quot;/&quot; path separator
character instead of &quot;\&quot;. Macintoshes use &quot;:&quot; and have interesting twists like &quot;::&quot;
for up instead of &quot;/../&quot; as in Unix. To write platform independent code, you should use the system
properties <span class="property">file.separator</span> and <span class="property">path.separator</span>, or use
the <span class="class">File</span> methods that construct filenames for you from parts.</p>
<p>Then you might well ask, how do you find out which drives are available? In JDK <span class="version">1.2</span> there is a new method: <!-- macro JDisplay gotchas.example11.javafrag --><!-- generated --><pre class="java"><span class="class">File</span><span class="fence1">[</span><span class="fence1">]</span> <span class="vardef">roots </span><span class="operator">= </span><span class="class">File</span><span class="operator">.</span><span class="method">listRoots</span><span class="fence1">(</span><span class="fence1">)</span><span class="semicolon">;</span></pre><!-- /generated by JDisplay -->
<h2 class="gotcha"><a name="FOREACH"></a>For Each Gaps</h2>
<span class="keyword">for :</span> pronounced <span class="keyword">for each</span> is a shorthand extension to
the regular <span class="keyword">for</span>. It lets you iterate over Iterators, Collections and arrays with a
terse syntax. However, it will not let you iterate over the characters of a <span class="class">String</span> or
let you look at the index while you are iterating <!-- macro JDisplay foreachloop.javafrag --><!-- generated --><div class="jdisplay"><iframe src="snippet/iframe/foreachloop.javafrag.html" width="511" height="580" scrolling="yes" frameborder="1"></iframe></div><!-- /generated by JDisplay -->
<h2 class="gotcha"><a name="FOR"></a>Unstoppable <i>for</i></h2>
<!-- macro JDisplay gotchas.example111.javafrag --><!-- generated --><pre class="java"><span class="importantkeyword">for </span><span class="fence1">(</span> <span class="keyword">long </span><span class="vardef">i</span><span class="operator">=</span><span class="class">Long</span><span class="operator">.</span><span class="constant">MAX_VALUE </span><span class="operator">-</span><span class="decimallow">2</span><span class="semicolon">; </span><span class="var">i</span><span class="operator">&lt;=</span><span class="class">Long</span><span class="operator">.</span><span class="constant">MAX_VALUE</span><span class="semicolon">; </span><span class="var">i</span><span class="operator">++ </span><span class="fence1">)</span>
   <span class="fence1">{</span>
   <span class="commentslashstar">/* ...*/</span>
   <span class="fence1">}</span></pre><!-- /generated by JDisplay -->
How many times will that <span class="keyword">for</span> loop execute? Until you kill the process! It will loop
endlessly because <span class="java">i</span> can never get bigger than <span class="constant">Long.MAX_VALUE</span> to terminate the loop. There are similar problems with <span class="constant">Integer.MAX_VALUE</span>, <span class="constant">Long.MIN_VALUE</span> and <span class="constant">Integer.MIN_VALUE</span>. You get used to thinking of the upper limit as the logical stopping point,
where canonical for loops actually stop on one past that value.
<h2 class="gotcha"><a name="UPPERCASE"></a>Upper Case Surprises</h2>
Take a look at the source of <span class="method">java.lang.String.toUpperCase()</span>. You might expect it to
contain only some very simple code of the form: <!-- macro JDisplay gotchas.example112.javafrag --><!-- generated --><pre class="java"><span class="keyword">if </span><span class="fence1">(</span> <span class="charliteral">'a'</span> <span class="operator">&lt;= </span><span class="var">theChar </span><span class="operator">&amp;&amp; </span><span class="var">theChar </span><span class="operator">&lt;= </span><span class="charliteral">'z'</span> <span class="fence1">)</span> <span class="var">theChar </span><span class="operator">-= </span><span class="fence1">(</span><span class="charliteral">'a'</span> <span class="operator">-</span><span class="charliteral">'A'</span> <span class="fence1">)</span><span class="semicolon">;</span></pre><!-- /generated by JDisplay -->
However, you will discover the code is quite elaborate. For example, it tests if the current locale is Turkish to
call special code to cope with the dotless i. It tests for the German &szlig; and converts it to a <b>pair</b> of
letters &quot;SS &quot;! If you are only working with English, you might want to roll your own more streamlined
version. If you take a string to lower case then back to upper case then back to lower case, you won&rsquo;t
necessarily end up where you started.
<h2 class="gotcha"><a name="SUBSTRING"></a>String.substring</h2>
In other languages, to extract a substring, you give an offset where the string starts and a length in
characters. In Java, you provide two zero-based offsets. The first points to the start of the string as you might
expect, and the second points one past the end of the string. <!-- macro JDisplay gotchas.example115.javafrag --><!-- generated --><pre class="java"><span class="string">&quot;abcdefg&quot;</span><span class="operator">.</span><span class="method">substring</span><span class="fence1">(</span> <span class="decimallow">3</span><span class="operator">, </span><span class="decimallow">5 </span><span class="fence1">)</span> <span class="var">gives </span><span class="string">&quot;de&quot;</span><span class="operator">.</span>
<span class="string">&quot;abcdefg&quot;</span><span class="operator">.</span><span class="method">substring</span><span class="fence1">(</span> <span class="decimallow">3</span><span class="operator">, </span><span class="decimallow">7 </span><span class="fence1">)</span> <span class="var">gives </span><span class="string">&quot;defg&quot;</span><span class="operator">.</span>
<span class="string">&quot;abcdefg&quot;</span><span class="operator">.</span><span class="method">substring</span><span class="fence1">(</span> <span class="decimallow">3</span><span class="operator">, </span><span class="decimallow">8 </span><span class="fence1">)</span> <span class="var">gives </span><span class="class">StringIndexOutOfBoundsException</span><span class="operator">.</span></pre><!-- /generated by JDisplay -->
<p>If you specify offsets that are outside the span of the string, you don&rsquo;t get a truncated or null
string; you raise a <span class="class">StringIndexOutOfBoundsException</span>. One way to remember the way it
works is that you specify the first character to include and the first character to exclude. But not quite. You
are allowed to be just barely past the end.
<br>
<!-- macro JDisplay gotchas.example116.javafrag --><!-- generated --><pre class="java"><span class="string">&quot;emptiness&quot;</span><span class="operator">.</span><span class="method">substring</span><span class="fence1">(</span> <span class="decimallow">9 </span><span class="fence1">)</span></pre><!-- /generated by JDisplay -->
returns &quot;&quot; (an empty string)
<br>
<!-- macro JDisplay gotchas.example117.javafrag --><!-- generated --><pre class="java"><span class="string">&quot;emptiness&quot;</span><span class="operator">.</span><span class="method">substring</span><span class="fence1">(</span> <span class="decimallow">10 </span><span class="fence1">)</span></pre><!-- /generated by JDisplay -->
gives a <span class="class">StringIndexOutOfBoundsException</span>
<p>Why do it this way?</p>
<ul><li>Often you have an index scooting along a string, pointing the beginnings of each token in succession. To
pull out the token you need only the old and new values of this index.</li>
<li>Edsger Dijkstra (one of the earlier pioneers of computer languages) put up a logical argument for having
range defined by their first value and value-after-the-end.</li>
<li>the difference between the <b>end</b> and <b>begin</b> is the length.</li>
<li>checking for empty range is done simply by checking if <span class="java">begin == end</span>.</li></ul>
There is another way of looking at the indexing that fits the Java behaviour in a more natural way. The index
does not identify a character in the string, it identifies a position <b>between</b> the characters of the
string, starting at 0 and ending at the string length. For example, <span class="string">&quot;APPLE&quot;</span>
has indexing like this:
<div class="output">(0) A (1) P (2) P (3) L (4) E (5)</div>
<p>Then: <!-- macro JDisplay gotchas.example.substring.javafrag --><!-- generated --><pre class="java"><span class="var">s </span><span class="operator">= </span><span class="string">&quot;APPLE&quot;</span><span class="operator">.</span><span class="method">substring</span><span class="fence1">(</span> <span class="decimallow">1</span><span class="operator">, </span><span class="decimallow">4 </span><span class="fence1">)</span><span class="semicolon">; </span><span class="commentslashslash">// gives &quot;PPL&quot;.</span>
<span class="var">s </span><span class="operator">= </span><span class="string">&quot;APPLE&quot;</span><span class="operator">.</span><span class="method">substring</span><span class="fence1">(</span> <span class="decimallow">3</span><span class="operator">, </span><span class="decimallow">3 </span><span class="fence1">)</span><span class="semicolon">; </span><span class="commentslashslash">// gives &quot;&quot;.</span>
<span class="var">s </span><span class="operator">= </span><span class="string">&quot;APPLE&quot;</span><span class="operator">.</span><span class="method">substring</span><span class="fence1">(</span> <span class="decimallow">0</span><span class="operator">, </span><span class="decimallow">5 </span><span class="fence1">)</span><span class="semicolon">; </span><span class="commentslashslash">// gives &quot;APPLE&quot;.</span></pre><!-- /generated by JDisplay -->
Beware of using <span class="method">substring</span> with only one argument.
<!-- macro JDisplay gotchas.example119.javafrag --><!-- generated --><pre class="java"><span class="class">String </span><span class="vardef">tail </span><span class="operator">= </span><span class="var">x</span><span class="operator">.</span><span class="method">substring</span><span class="fence1">(</span> <span class="var">endindex </span><span class="fence1">)</span><span class="semicolon">;</span></pre><!-- /generated by JDisplay -->
gets you the tail end of a string starting at <span class="var">endindex</span>. It does <b>not</b> get you the
beginning of the string ending at endindex. <!-- macro JDisplay gotchas.example120.javafrag --><!-- generated --><pre class="java"><span class="var">head </span><span class="operator">= </span><span class="var">x</span><span class="operator">.</span><span class="method">substring</span><span class="fence1">(</span> <span class="decimallow">0</span><span class="operator">, </span><span class="var">length </span><span class="fence1">)</span><span class="semicolon">;</span></pre><!-- /generated by JDisplay -->
gets you the first part of the string, the first length characters.
<h2 class="gotcha"><a name="NAN"></a>Incomparable NaN</h2>
When you divide by zero with double, take the square root of a negative number, overflow the maximum
representable value etc. the result is a magic number called <span class="constant">Double.NaN</span>,
<span class="constant">Double.POSITIVE_INFINITY</span> or <span class="constant">Double.NEGATIVE_INFINITY</span>.
You check the result with: <!-- macro JDisplay gotchas.example121.javafrag --><!-- generated --><pre class="java"><span class="keyword">if </span><span class="fence1">(</span> <span class="class">Double</span><span class="operator">.</span><span class="method">isNaN</span><span class="fence2">(</span> <span class="var">d </span><span class="fence2">)</span> <span class="fence1">)</span></pre><!-- /generated by JDisplay -->
or with <!-- macro Qualified Double.isInfinite --><!-- generated --><span class="class">Double</span><span class="operator">.</span><span class="method">isInfinite</span><!-- /generated by Qualified -->. You <b>can&rsquo;t</b>
test it directly with: <!-- macro JDisplay gotchas.example122.javafrag --><!-- generated --><pre class="java"><span class="keyword">if </span><span class="fence1">(</span> <span class="var">d </span><span class="operator">== </span><span class="class">Double</span><span class="operator">.</span><span class="class">NaN </span><span class="fence1">)</span></pre><!-- /generated by JDisplay -->
Though for some bizarre reason you can use <span class="operator">==</span> to compare with <span class="class">Double</span>. <span class="constant">POSITIVE_INFINITY</span>. There is a corresponding <span class="class">Float</span>.<span class="constant">NaN</span> and <!-- macro Qualified Float.isNaN --><!-- generated --><span class="class">Float</span><span class="operator">.</span><span class="method">isNaN</span><!-- /generated by Qualified -->
. The theory is making NaN not equal to itself allows a quick and dirty way to test for a calculation going
haywire. <!-- macro JDisplay gotchas.example13.javafrag --><!-- generated --><pre class="java"><span class="keyword">if </span><span class="fence1">(</span> <span class="var">result </span><span class="operator">!= </span><span class="var">result </span><span class="fence1">)</span>
   <span class="fence1">{</span>
   <span class="class">System</span><span class="operator">.</span><span class="var">out</span><span class="operator">.</span><span class="method">println</span><span class="fence1">(</span> <span class="string">&quot;oops&quot;</span> <span class="fence1">)</span><span class="semicolon">;</span>
   <span class="fence1">}</span></pre><!-- /generated by JDisplay -->
<h2 class="gotcha"><a name="STRINGBUFFER"></a>StringBuffer.equals</h2>
Beware of code like this that will compile happily: <!-- macro JDisplay gotchas.stringbuffer.javafrag --><!-- generated --><div class="jdisplay"><iframe src="snippet/iframe/gotchas.stringbuffer.javafrag.html" width="614" height="382" scrolling="no" frameborder="1"></iframe></div><!-- /generated by JDisplay -->
The problem is <span class="class">StringBuffer</span>.<span class="method">equals</span> checks if two
references point to the same <span class="class">StringBuffer</span>, something you almost never want to do.
<span class="class">StringBuilder</span> has the same gotcha.
<h2 class="gotcha"><a name="VALUEOF"></a>ValueOf and null</h2>
<!-- macro JDisplay gotchas.example15.javafrag --><!-- generated --><pre class="java"><span class="keyword">int</span><span class="fence1">[</span><span class="fence1">]</span> <span class="vardef">intArray </span><span class="operator">= </span><span class="keyword">null</span><span class="semicolon">;</span>
<span class="class">String</span><span class="operator">.</span><span class="method">valueOf</span><span class="fence1">(</span> <span class="var">intArray </span><span class="fence1">)</span><span class="semicolon">; </span><span class="commentslashslash">// produces the String &quot;null&quot;</span>
<span class="keyword">char</span><span class="fence1">[</span><span class="fence1">]</span> <span class="vardef">charArray </span><span class="operator">= </span><span class="keyword">null</span><span class="semicolon">;</span>
<span class="class">String</span><span class="operator">.</span><span class="method">valueOf</span><span class="fence1">(</span> <span class="var">charArray </span><span class="fence1">)</span><span class="semicolon">; </span><span class="commentslashslash">// throws NullPointerException</span></pre><!-- /generated by JDisplay -->
<h2 class="gotcha"><a name="FINAL"></a>Final vs Const</h2>
Java has a keyword <span class="keyword">final</span> and <span class="writtenincpp">C++</span> has a keyword
<span class="c">const</span>. They are similar, but don&rsquo;t fall into the trap of thinking they are
identical. Declaring a variable <span class="keyword">final</span> will prevent the value of that variable from
being changed after initialisation. However, if that variable is a reference to an object, it will <b>not</b>
necessarily prevent the various fields in that object from being changed, e. g.
<!-- macro JDisplay gotchas.example123.javafrag --><!-- generated --><pre class="java"><span class="keyword">final </span><span class="class">Thing </span><span class="vardef">thing </span><span class="operator">= </span><span class="keyword">new </span><span class="class">Thing</span><span class="fence1">(</span> <span class="decimallow">7 </span><span class="fence1">)</span><span class="semicolon">;</span>
<span class="var">thing </span><span class="operator">= </span><span class="var">otherThing</span><span class="semicolon">;  </span><span class="commentslashslash">// generates a compiler error</span>
<span class="var">thing</span><span class="operator">.</span><span class="method">setSize</span><span class="fence1">(</span> <span class="decimallow">10 </span><span class="fence1">)</span><span class="semicolon">; </span><span class="commentslashslash">// ok</span>
<span class="var">thing</span><span class="operator">.</span><span class="var">girth </span><span class="operator">= </span><span class="decimallow">6</span><span class="semicolon">;     </span><span class="commentslashslash">// ok</span></pre><!-- /generated by JDisplay -->
This also applies to parameters declared <span class="keyword">final</span>.
<h2 class="gotcha"><a name="OVERFLOW"></a>Overflow</h2>
Java is cavalier about overflow. There are no compile-time warnings or run-time exceptions to let you know when
your calculations have become too big to store back in an int or long. There is no warning for float or double
overflow either. One place you often get nailed is when some calculations are done as int, high order parts are
truncated, then promoted to long.
<p>Watch out for chains of multiplied integer constants: <!-- macro JDisplay gotchas.example124.javafrag --><!-- generated --><div class="jdisplay"><iframe src="snippet/iframe/gotchas.example124.javafrag.html" width="800" height="90" scrolling="yes" frameborder="1"></iframe></div><!-- /generated by JDisplay -->
<p>IBM&rsquo;s <span class="class">BigDecimal</span> and <a class="offsite" href="http://users.belgacombusiness.net/arci/math/">Arcimath BigDecimal</a> have provisions for detecting overflow and
generating an exception. You can roll your own with code like this in standard Java.
<!-- macro JDisplay gotchas.example125.javafrag --><!-- generated --><div class="jdisplay"><iframe src="snippet/iframe/gotchas.example125.javafrag.html" width="800" height="332" scrolling="yes" frameborder="1"></iframe></div><!-- /generated by JDisplay -->
or this one to detect overflow in multiplication: <!-- macro JDisplay gotchas.example126.javafrag --><!-- generated --><div class="jdisplay"><iframe src="snippet/iframe/gotchas.example126.javafrag.html" width="800" height="464" scrolling="yes" frameborder="1"></iframe></div><!-- /generated by JDisplay -->
<p>If you know both values are positive, you can use a simpler overflow check. You could check if the sum is less
than 0 or less than one of the two operands. I&rsquo;m not sure if this catches all overflows, however.</p>
<p>Floating point arithmetic uses the IEEE error propagating scheme similar to that used in a spreadsheet to
propagate invalid value flags to cells that depend on invalid values. In Java, though there is no overflow
interrupt or notification, there is a good chance you will eventually find out about an overflow error when you
see a <span class="constant">java.lang.Double.POSITIVE_INFINITY</span>, <span class="constant">java.lang.Double.NEGATIVE_INFINITY</span> or <span class="constant">java.lang.Double.NaN</span>
showing up in one of your double variables. You can&rsquo;t use == to test for NaN, you must use <span class="constant">java.lang.Double.isNan()</span>.</p>
<h2 class="gotcha"><a name="OVERRIDE"></a><a name="SHADOW"></a>Override vs Shadow</h2>
What happens when you reuse a method or variable name in a subclass? It depends. There are four cases to
consider:
<ol><li>static method</li>
<li>instance method</li>
<li>static variable</li>
<li>instance variable</li></ol>
Do you inherit the superclass version or get subclass version? This is all so confusing, I suggest you perform
some experiments. Here a little program I wrote to discover the various shadowing and overriding behaviours:
<!-- macro JDisplay gotchas.example127.javafrag --><!-- generated --><div class="jdisplay"><iframe src="snippet/iframe/gotchas.example127.javafrag.html" width="782" height="580" scrolling="yes" frameborder="1"></iframe></div><!-- /generated by JDisplay -->
For more discussion, see <b>shadowing</b> variables and <b>overriding</b> methods in the Java &amp; Internet
Glossary. My general advice is never to shadow variables. There is no need for it. It just causes confusion. In
summary:
<ul><li>Static methods are never selected dynamically; they are always selected based on the type information known
at compile time.</li>
<li>Instance methods always are selected dynamically based on the type of the object. The type of the reference
or any casts are irrelevant. In <span class="writtenincpp">C++</span> terms, all (non-final) methods are
virtual. The main place this gets you in trouble is if you use a method in a constructor that is later
overridden in some subclass. That method may use the subclass&rsquo;s fields that have not yet been initialised
by code in the subclass&rsquo;s constructor. That method will just see subclass variables initialised to 0 or
null.</li>
<li>Static variables are always selected based on the type information known at compile time, taking any casts
into consideration.</li>
<li>Instance variables are always selected based on the type information known at compile time, taking any
casts into consideration.</li>
<li>There is no way to get at grandma&rsquo;s method if mom has overridden it. Either grandma or mom would have
had to given you a backdoor to that method with a wrapper around it by another name that was not overridden.
Mom can of course use <span class="keyword">super</span> to get at Grandma&rsquo;s methods.</li></ul>
<h2 class="gotcha"><a name="SETLOCATION"></a>&quot;broken&quot; setLocation, setSize,
setBackground, setForeground</h2>
People often complain they can&rsquo;t get <span class="method">setLocation</span>, <span class="method">setSize</span>, <span class="method">setBounds</span>, <span class="method">setBackground</span> or
<span class="method">setForeground</span> to work. The problem is usually that something <b>else</b> is setting
them and overriding your settings: Culprits include:
<ol><li>Layout Managers. They do resize() and move() (the deprecated method names) on the contents of each
container. Only the null layout manager will leave your sizes intact.</li>
<li>Generated code in Visual Cafe will do a move() and show() (the deprecated names) in an overridden show()
method.</li>
<li>Your own code using deprecated names like move() or resize().</li></ol>
<h2 class="gotcha"><a name="UNSIGNEDBYTES"></a>Unsigned Bytes</h2>
Back when the earth was still molten, when characters still had only <span class="statistic">7</span> bits,
somebody thought it would be a good idea if characters were signed. This caused a schism in the C world when
8-bit characters later appeared. Java added unsigned 16-bit Unicode characters, but decided to support only
signed 8-bit characters, known as bytes. Perhaps Java&rsquo;s designers wanted to encourage migration to Unicode
by making handling unsigned bytes awkward. In any case, you most often want unsigned 8-bit characters, not
signed. How do you fake them? <!-- macro JDisplay gotchas.example128.javafrag --><!-- generated --><pre class="java"><span class="keyword">int </span><span class="vardef">i1 </span><span class="operator">= </span><span class="var">b2 </span><span class="operator">&amp; </span><span class="numericindicator">0x</span><span class="hexlow">ff</span><span class="semicolon">;</span>
<span class="keyword">byte </span><span class="vardef">b2 </span><span class="operator">= </span><span class="fence1">(</span><span class="keyword">byte</span><span class="fence1">)</span><span class="fence1">(</span> <span class="var">b2 </span><span class="operator">+ </span><span class="decimallow">1 </span><span class="fence1">)</span><span class="semicolon">;</span>
<span class="keyword">byte </span><span class="vardef">b3 </span><span class="operator">= </span><span class="var">b2</span><span class="semicolon">;</span></pre><!-- /generated by JDisplay -->
<ul><li>On every reference, you must mask off the generated sign-extending high order bits with &amp; 0xff. Keep in
mind that almost any operation on a byte will promote the result to an int.</li>
<li>On every store, you must cast from int back to byte.</li>
<li>The only time you don&rsquo;t need the (byte) cast is when the right hand side is already a byte.
<br></li></ul>
<h2 class="gotcha"><a name="MODULUS"></a>Modulus</h2>
In Java you take the remainder with the <span class="keyword">%</span> operator. In Java, the sign of the
remainder follows the dividend, not the divisor. Java division has the Euclidean property. When you multiply the
quotient by the divisor and add the remainder you get back to the dividend. Java division is
<b>truncated</b>division.
<p><b>Floored</b> division is what you normally want when trying to figure out which bin an item belongs in. You
can compute floored division as: <!-- macro JDisplay gotchas.example129.javafrag --><!-- generated --><div class="jdisplay"><iframe src="snippet/iframe/gotchas.example129.javafrag.html" width="800" height="60" scrolling="yes" frameborder="1"></iframe></div><!-- /generated by JDisplay -->
<p>For computing how many fixed-size bins you need to contain N items, you want <b>ceiled</b> division, also
known as the <b>covered quotient</b>. You can compute the covered quotient as:
<!-- macro JDisplay gotchas.example130.javafrag --><!-- generated --><div class="jdisplay"><iframe src="snippet/iframe/gotchas.example130.javafrag.html" width="800" height="60" scrolling="yes" frameborder="1"></iframe></div><!-- /generated by JDisplay -->
<table class="standard"><thead><tr><th>Signs</th>
<th>Division</th>
<th>Modulus</th></tr></thead>
<tbody><tr><td>+ +</td>
<td>+7/+4=+1</td>
<td>+7%+4=+3</td></tr>
<tr><td>- +</td>
<td>-7/+4=-1</td>
<td>-7%+4=-3</td></tr>
<tr><td>+ -</td>
<td>+7/-4=-1</td>
<td>+7%-4=+3</td></tr>
<tr><td>- -</td>
<td>-7/-4=+1</td>
<td>-7%-4=-3</td></tr></tbody></table>
I have a general rule to avoid writing code that depends on the expected sign of the modulus. It is often a
source of bugs since people testing have their own ideas of how the answers should be. For example the Microsoft
JIT gives wrong signs even for division, but the interpreter gives correct ones.
<h2 class="gotcha"><a name="STATICINIT"></a>Static Initialisers</h2>
You have to enclose any initialisation code for static (class) variables inside a sandwich like this:
<!-- macro JDisplay gotchas.example142.javafrag --><!-- generated --><pre class="java"><span class="keyword">static </span><span class="fence1">{</span> <span class="method">calcPriceTab</span><span class="fence1">(</span><span class="fence1">)</span><span class="semicolon">;</span><span class="fence1">}</span></pre><!-- /generated by JDisplay -->
Newbies just stick such code anywhere inside the class { } sandwich and are baffled by the misleading error
messages.
<p>The order of your variables that are statically initialised matters. Consider this little program:
<!-- macro JDisplay gotchas.example143.javafrag --><!-- generated --><div class="jdisplay"><iframe src="snippet/iframe/gotchas.example143.javafrag.html" width="621" height="382" scrolling="no" frameborder="1"></iframe></div><!-- /generated by JDisplay -->
The output with Java 1.4.1 was no compile error and <span class="output">61 0 61</span>, <a href="yymv.html">YMMV</a>.
<p>The order of those three static finals is crucial to the results! You must put them in the order you want the
calculations done. Java is not smart like a spreadsheet to do natural order recalcs for you. It will notice and
either handle or reject such forward references when only literals and simple variables are involved, but as soon
as you do things inside methods, it throws up its hands and says <i>on your own head be it</i>.</p>
<h2 class="gotcha"><a name="INSTANCEINIT"></a>Instance Initialisers</h2>
You have the option of initialising an instance variable in:
<ol><li>the declaration</li>
<li>the constructor</li>
<li>an instance initializer block</li></ol>
<!-- macro JDisplay gotchas.example27.javafrag --><!-- generated --><div class="jdisplay"><iframe src="snippet/iframe/gotchas.example27.javafrag.html" width="410" height="338" scrolling="no" frameborder="1"></iframe></div><!-- /generated by JDisplay -->
<p>The advantage of putting it on the declaration is that you need to specify it only once, not once for each
constructor. This means there is less likelihood of error if its value is ever changed. The other safe approach
is to put all your initialisation code in one method or one constructor and have all the constructors call
it.</p>
<h2 class="gotcha"><a name="CONSTRUCTORINIT"></a>Constructor Initialisation</h2>
The order that fields are initialised is subtle.
<div class="see"><a href="constructor.html">constructor</a> for details</div>
<p>However, there is one particularly tricky problem with initialisation order. In general you must avoid calling
any non-final methods in a constructor. The problem is that instance initialisers / variable initialisation in
the derived class is performed <b>after</b> the constructor of the base class. This can cause a problem if the
base class constructor calls a method polymorphically, since that method will be presuming its derived class
fields have all been initialised when they have not.</p>
<p>So base class constructors can safely call private or final methods of the base class provided those methods
directly or indirectly call only private or final methods of the base class. If you call methods in your
constructor polymorphically, the compiler will not stop or warn you of the initialisation pitfalls awaiting.</p>
<h2 class="gotcha"><a name="CASTS"></a>Casts</h2>
Java is a strongly typed language. You not only need to be aware of what type each of your variables were
declared, you must also keep track of the type of object each is currently pointing to, which may be a subclass
of the declared class.
<p>There are four sorts of cast:</p>
<ol><li>to expand a value: <!-- macro JDisplay gotchas.example144.javafrag --><!-- generated --><pre class="java"><span class="keyword">byte </span><span class="vardef">b </span><span class="operator">= -</span><span class="decimallow">42</span><span class="semicolon">;</span>
<span class="keyword">int </span><span class="vardef">i </span><span class="operator">= </span><span class="fence1">(</span><span class="keyword">int</span><span class="fence1">)</span><span class="var">b</span><span class="semicolon">;</span></pre><!-- /generated by JDisplay -->
This cast is nugatory, though you might want to use the cast as a documentation aid. It does some conversion
work &mdash; sign extension.</li>
<li>to trim a value: <!-- macro JDisplay gotchas.example145.javafrag --><!-- generated --><pre class="java"><span class="keyword">int </span><span class="vardef">i </span><span class="operator">= -</span><span class="decimalhigh">16</span><span class="decimallow">411</span><span class="semicolon">;</span>
<span class="keyword">byte </span><span class="vardef">b </span><span class="operator">= </span><span class="fence1">(</span><span class="keyword">byte</span><span class="fence1">)</span><span class="var">i</span><span class="semicolon">;</span></pre><!-- /generated by JDisplay -->
This style of cast actually may do some real conversion work &mdash; zeroing out high order bits.</li>
<li>to treat a reference as its superclass: <!-- macro JDisplay gotchas.example146.javafrag --><!-- generated --><pre class="java"><span class="class">Dog </span><span class="vardef">myDog </span><span class="operator">= </span><span class="fence1">(</span><span class="class">Dog</span><span class="fence1">)</span><span class="var">aDalmatian</span><span class="semicolon">;</span></pre><!-- /generated by JDisplay -->
This cast is nugatory, though you might want to use the case as a documentation aid. All Dalmatians
automatically have all the Dog fields, so this cast has no run-time overhead.</li>
<li>to treat a reference as one of its descendants: <!-- macro JDisplay gotchas.example147.javafrag --><!-- generated --><pre class="java"><span class="class">Dalmatian </span><span class="vardef">myDalmatian </span><span class="operator">= </span><span class="fence1">(</span><span class="class">Dalmatian</span><span class="fence1">)</span><span class="var">aDog</span><span class="semicolon">;</span></pre><!-- /generated by JDisplay -->
At run time, this cast actually checks that aDog truly is already a Dalmatian, and raises a
ClassCastException if it does not. It does not make any attempt to convert a Dog to a Dalmatian.</li>
<li>Casts with abstract classes and interfaces work the same way as classes.</li></ol>
So where are the gotchas?
<ul><li>Casts sometimes mean convert something to something else. Other times they mean, don&rsquo;t convert, just
treat something as if it already were something else. Casting objects is a misleading terminology. Any actual
object has a definite class, set when it was instantiated. Nothing can change that during the lifetime of the
object.</li>
<li>You can&rsquo;t use casts the way you can in <span class="writtenincpp">C++</span> to look at the same
physical storage in two different ways, e.g. to overlay a short on top of a pair of bytes, and sometimes
address the storage as if it were a short and other times as if it were two bytes. Java is cleverly designed so
that you can&rsquo;t write a Pure Java program that depends on the big-endian or little-endian format of
internal storage. (All external representations are <a href="endian.html">big-endian</a>). To break a short up
into bytes you have to shift and mask.</li>
<li>You might logically presume that casts are for converting one type into another. You might attempt code
like this: <!-- macro JDisplay gotchas.example148.javafrag --><!-- generated --><pre class="java"><span class="class">String </span><span class="vardef">s1 </span><span class="operator">= </span><span class="fence1">(</span><span class="class">String</span><span class="fence1">)</span> <span class="var">i</span><span class="semicolon">;</span>
<span class="keyword">int </span><span class="vardef">i </span><span class="operator">= </span><span class="fence1">(</span><span class="keyword">int</span><span class="fence1">)</span> <span class="var">s2</span><span class="semicolon">;</span>
<span class="class">String </span><span class="vardef">s3 </span><span class="operator">= </span><span class="fence1">(</span><span class="class">String</span><span class="fence1">)</span> <span class="var">myDalmatian</span><span class="semicolon">;</span></pre><!-- /generated by JDisplay -->
Yet casting only works for two primitives. When there is a primitive and an object involved, there is a
<a href="conversion.html">system of conversion functions</a> with about as much regularity as French verbs.</li>
<li>Whenever you store into an array of references, there is a type check done to make sure the object you are
inserting is of the correct type. These checks can be quite slow.</li>
<li><span class="java">(String)</span>is not smart enough to invoke the <span class="method">toString()</span>
method of an object.</li>
<li>You can cast <span class="keyword">null</span> into anything without raising a ClassCastException.
Generally, this is a Good Thing&trade;. Otherwise every cast would need an <span class="keyword">if</span> to
specially handle the null case. You might be tempted to count on ClassCastExceptions to filter out nulls for
you. The following code will <b>not</b> raise a java.lang.ClassCastException:
<!-- macro JDisplay gotchas.example149.javafrag --><!-- generated --><pre class="java"><span class="class">Cat </span><span class="vardef">c </span><span class="operator">= </span><span class="keyword">null</span><span class="semicolon">;</span>
<span class="class">Object </span><span class="vardef">o </span><span class="operator">= </span><span class="var">c</span><span class="semicolon">;</span>
<span class="class">Dalmatian </span><span class="vardef">d </span><span class="operator">= </span><span class="fence1">(</span><span class="class">Dalmatian</span><span class="fence1">)</span><span class="var">o</span><span class="semicolon">;</span></pre><!-- /generated by JDisplay -->
In other words, there is one universal representation for null, not a special one for each class.
<p>In contrast <span class="java">if ( <span class="keyword">null</span> <span class="keyword">instanceof</span> Dog )</span> is always false. <span class="keyword">instanceof</span> does filter
out nulls.</p></li>
<li>What&rsquo;s wrong with this code? <!-- macro JDisplay gotchas.example150.javafrag --><!-- generated --><pre class="java"><span class="class">Dog </span><span class="vardef">fido </span><span class="operator">= </span><span class="keyword">new </span><span class="class">Dalmatian</span><span class="fence1">(</span><span class="fence1">)</span><span class="semicolon">;</span>
<span class="keyword">int </span><span class="vardef">spots </span><span class="operator">= </span><span class="fence1">(</span><span class="class">Dalmatian</span><span class="fence1">)</span><span class="var">fido</span><span class="operator">.</span><span class="method">spotCount</span><span class="fence1">(</span><span class="fence1">)</span><span class="semicolon">;</span></pre><!-- /generated by JDisplay -->
Hint: What are you trying to cast to Dalmatian, the Dog fido or the int result of the spotCount method? When
you are casting, you often need a forest of parentheses. This is what you should have written:
<!-- macro JDisplay gotchas.example151.javafrag --><!-- generated --><pre class="java"><span class="class">Dog </span><span class="vardef">fido </span><span class="operator">= </span><span class="keyword">new </span><span class="class">Dalmatian</span><span class="fence1">(</span><span class="fence1">)</span><span class="semicolon">;</span>
<span class="keyword">int </span><span class="vardef">spots </span><span class="operator">= </span><span class="fence1">(</span><span class="fence2">(</span><span class="class">Dalmatian</span><span class="fence2">)</span><span class="var">fido</span><span class="fence1">)</span><span class="operator">.</span><span class="method">spotCount</span><span class="fence1">(</span><span class="fence1">)</span><span class="semicolon">;</span></pre><!-- /generated by JDisplay --></li>
<li><a name="PARENTHESISFOREST"></a> <span class="minihead">Parenthesis Forests</span>:
You think you have the hang of it? Look at this: <!-- macro JDisplay gotchas.example152.javafrag --><!-- generated --><pre class="java"><span class="fence1">(</span><span class="constant">B</span><span class="fence1">)</span><span class="fence1">(</span> <span class="fence2">(</span> <span class="fence3">(</span><span class="constant">A</span><span class="fence3">)</span><span class="var">va</span><span class="operator">.</span><span class="method">get</span><span class="fence3">(</span> <span class="decimallow">0 </span><span class="fence3">)</span><span class="fence2">)</span><span class="operator">.</span><span class="var">b </span><span class="fence1">)</span><span class="operator">.</span><span class="var">c </span><span class="operator">= </span><span class="var">x</span><span class="semicolon">;</span></pre><!-- /generated by JDisplay -->
What does that mean? Get the first element of vector va (an Object), cast it to an A object which then, using
field b, points to a another object. Cast that object to class B. In that object is a string reference c that
you want set to x.
<p>That would be so much easier to read as:</p>
<div class="bali"><span class="comment">/* This <b>won&rsquo;t</b> work in <span class="writteninjava">Java</span> !
*/</span>
<br>
va.get(0):A.b.c:B = x;</div>
<p>In getting those ()((()()))) right, count +1 for each <b>(</b> and -1 for each <b>)</b>. You should get
back to 0 at the end and any place you think you should be outside all (). You should never go negative. In
that case above you count:</p>
<div class="group">1 0 1 2 3 2 3 2 1 0</div>
This is better than merely counting the number of <b>(</b> and <b>)</b> and seeing if they match, though it
may take more mental effort.
<p>The problem is the infernal mix of prefix, postfix and infix operators that Java inherited from C. (At
least the goofiness of String x [] is sort of gone).</p>
<p>In a language with postfix casts and flatter precedence that might read:</p>
<div class="bali"><span class="comment">/* This <b>won&rsquo;t</b> work in <span class="writteninjava">Java</span> !
*/</span>
<br>
va.get(0) (A) .b (B) .c = &quot;hello&quot;;</div>
You can similarly balance {} and [], though {} is harder since they can be widely separated. Best to use a
smart editor. See <a href="parentheses.html">parentheses</a> (), <a href="brackets.html">brackets</a> [],
<a href="braces.html">braces</a> {}.</li></ul>
<h2 class="gotcha"><a name="IMPLICITCASTS"></a>Implicit Casts</h2>
Conversions and promotions occur both when you explicitly request them, and sometimes automatically.
<ol><li>Automatic Assignment Conversion converts an expression&rsquo;s type to a variable&rsquo;s type (ex. short
value = 26). This type of conversion is allowed when converting from a type to that same type (identity
conversion), when performing a widening conversion, or when performing a narrowing conversion which assigns an
int to a byte, short, or char variable where the int is representable by the (byte, short, or char) variable.
Note that this form of conversion occurs only in assignments that preclude exceptions by definition.</li>
<li>Automatic Numeric Promotion homogenates operands to allow an operation (ex. 1.0f + 2.0 will cause 1.0f to
be promoted to a double).</li>
<li>Automatic Method Invocation Conversion occurs when passing arguments during a method invocation (ex.
calling methodA(45) on a method defined as methodeA(long value)). Except for disallowing implicit narrowing of
integer constants, this form of conversion&rsquo;s behavior is identical to that of automatic assignment
conversion. Note that this form of conversion occurs only when the argument types passed to the method can be
automatically converted to those specified in the method signature in a manner which precludes exceptions by
definition.</li>
<li>Automatic String Conversion allows any type to be converted to type String. This occurs when the
&quot;+&quot; String concatenating operator is used (ex. String resultString = &quot;the answer is:&quot; +
result, where result can be of any type)</li></ol>
<h2 class="gotcha"><a name="CONCATENATION"></a>Concatenation</h2>
Java uses the + operator to mean both addition and concatenation. Parsers can unambiguously figure out which your
intent is from the context, but humans can be easily fooled. For example:
<!-- macro JDisplay gotchas.example153.javafrag --><!-- generated --><pre class="java"><span class="class">System</span><span class="operator">.</span><span class="var">out</span><span class="operator">.</span><span class="method">println</span><span class="fence1">(</span><span class="string">&quot; x+y &quot;</span> <span class="operator">+ </span><span class="var">x</span><span class="operator">+</span><span class="var">y </span><span class="fence1">)</span><span class="semicolon">;</span>
<span class="class">System</span><span class="operator">.</span><span class="var">out</span><span class="operator">.</span><span class="method">println</span><span class="fence1">(</span> <span class="var">x</span><span class="operator">+</span><span class="var">y </span><span class="operator">+ </span><span class="string">&quot; x+y &quot;</span> <span class="fence1">)</span><span class="semicolon">;</span></pre><!-- /generated by JDisplay -->
Which + are addition? Which are concatenation?
<p>The way you most commonly get caught is code like this where the last + is treated as concatenation.</p>
<p><!-- macro JDisplay gotchas.example28.javafrag --><!-- generated --><pre class="java"><span class="class">System</span><span class="operator">.</span><span class="var">out</span><span class="operator">.</span><span class="method">println</span><span class="fence1">(</span> <span class="string">&quot;value: &quot;</span> <span class="operator">+ </span><span class="var">v </span><span class="operator">+ </span><span class="decimallow">1 </span><span class="fence1">)</span><span class="semicolon">;</span></pre><!-- /generated by JDisplay -->
<p>The concatenation operator has the magic power of being able to <b>implicitly</b> coerce an <span class="keyword">int</span> into a <span class="class">String</span> by automatically invoking the
<br>
<span class="java"><span class="keyword">static</span> <span class="class">String</span> <span class="class">Integer</span>. <span class="method">toString</span>(<span class="var">int</span>)</span>
<br>
method, however, oddly, you <b>can&rsquo;t</b> do the same thing <b>explicitly</b> with a (<span class="class">String</span>) cast.</p>
<p>What do you think this little code snippet produces? <!-- macro JDisplay gotchas.example154.javafrag --><!-- generated --><pre class="java"><span class="class">System</span><span class="operator">.</span><span class="var">out</span><span class="operator">.</span><span class="method">println</span><span class="fence1">(</span> <span class="charliteral">'A'</span> <span class="fence1">)</span><span class="semicolon">;</span>
<span class="class">System</span><span class="operator">.</span><span class="var">out</span><span class="operator">.</span><span class="method">println</span><span class="fence1">(</span> <span class="charliteral">'A'</span> <span class="operator">+ </span><span class="charliteral">'B'</span> <span class="fence1">)</span><span class="semicolon">;</span></pre><!-- /generated by JDisplay -->
You might naively expect: <span class="output">A AB</span>, or perhaps <span class="output">65 131</span>,
however, the answer is: <span class="output">A 131</span>.
<p>The problem is Java&rsquo;s design blunder of using <span class="operator">+</span> to mean both addition and
concatenation. Addition also promotes to <span class="keyword">int</span>, which <span class="method">println</span> displays differently from <span class="keyword">char</span>.</p>
<p>I really want this fixed. Concatenation should get a new operator symbol and using <span class="operator">+</span> for concatenation should be deprecated. The current scheme leads to code too easy to misread.
<span class="operator">+</span> with <span class="keyword">int</span> can mean either addition or concatenation.
Deciding which depends too much on subtle context clues.</p>
<h2 class="gotcha"><a name="STUTTERING"></a>M y O u t p u t L o o k s L i k e T h i s</h2>
There are 9 common character handling types in <span class="writteninjava">Java</span>
<table class="standard"><thead><tr><th>Type</th>
<th>mutable?</th>
<th>size in bits</th>
<th>signed?</th>
<th>Description</th></tr></thead>
<tbody><tr><td><span class="class">String</span></td>
<td>immutable</td>
<td>16</td>
<td>unsigned</td>
<td>Unicode</td></tr>
<tr><td><span class="class">StringBuffer</span></td>
<td>mutable both in value and size</td>
<td>16</td>
<td>unsigned</td>
<td>Unicode</td></tr>
<tr><td><span class="keyword">char</span></td>
<td>mutable value</td>
<td>16</td>
<td>unsigned</td>
<td>individual Unicode character.</td></tr>
<tr><td><span class="class">Character</span></td>
<td>immutable</td>
<td>16</td>
<td>unsigned</td>
<td>Unicode character object.</td></tr>
<tr><td><span class="keyword">char</span>[]</td>
<td>mutable value</td>
<td>16</td>
<td>unsigned</td>
<td>array of Unicode characters.</td></tr>
<tr><td><span class="keyword">byte</span></td>
<td>mutable value</td>
<td>8</td>
<td>signed</td>
<td>individual ASCII char.</td></tr>
<tr><td><span class="class">Byte</span></td>
<td>immutable</td>
<td>8</td>
<td>signed</td>
<td>ASCII char object.</td></tr>
<tr><td><span class="keyword">byte</span>[]</td>
<td>mutable value</td>
<td>8</td>
<td>signed</td>
<td>array of ASCII chars.</td></tr>
<tr><td>UTF</td>
<td>immutable</td>
<td>8/16</td>
<td>unsigned</td>
<td>16-bit length, <span class="statistic">7</span>-bit chars, multibyte codes for 16-bit chars with high
bit on.</td></tr></tbody></table>
Especially when you are doing I/O. you need to be very clear whether you have 8 or <span class="statistic">16</span>-bit characters internally and 8 or <span class="statistic">16</span>-bit characters
externally. Some I/O methods convert, some do not. A hex file viewer will help you track down such problems. An
ASCII character when converted to Unicode has a high order 0 byte prepended, since all Java I/O is <a href="endian.html">big-endian</a>.
<h2 class="gotcha"><a name="FINALIZE"></a>Finalizers Are Not Destructors</h2>
<span class="writtenincpp">C++</span> programmers tend to think that the finalize() method is equivalent to a
destructor. This is not true, for two reasons:
<ol><li>There is no guarantee that a finalizer will ever be called.</li>
<li>Finalizers do not automatically propagate up the inheritance chain like destructors. In particular, you
should manually call super.finalize() from all your finalize methods. There is no guarantee about the order of
invocation of finalizers.</li></ol>
There are two System methods you should be aware of:
<ol><li><span class="method">System.runFinalization()</span> Runs the finalization methods of any objects pending
finalization.</li>
<li><span class="method">System.runFinalizersOnExit(boolean value)</span> Deprecated. It causes all finalizer
methods to be invoked before exiting. This method is inherently unsafe. It may result in finalizers being
called on live objects while other threads are concurrently manipulating those objects, resulting in erratic
behavior or deadlock.</li></ol>
<h2 class="gotcha"><a name="FINALLY"></a>Finally</h2>
Finally can be confusing. The <span class="keyword">finally</span> keyword is Java&rsquo;s answer to <span class="writtenincpp">C++</span> destructors. In <span class="writtenincpp">C++</span>, when automatic objects go out of
scope (even as a result of a thrown exception), the objects&rsquo; destructors are called in a well-defined
order. Java has garbage collection and no destructors, so there needs to be some way to ensure that certain
things happen before exiting the scope. <span class="keyword">finally</span> lets you achieve this, but if you
put certain kinds of statements in <span class="keyword">finally</span> blocks, you can confuse yourself. The
following example always returns 0: <!-- macro JDisplay gotchas.example158.javafrag --><!-- generated --><pre class="java"><span class="keyword">public int </span><span class="method">square</span><span class="fence1">(</span> <span class="keyword">int </span><span class="vardef">n </span><span class="fence1">)</span>
   <span class="fence1">{</span>
   <span class="keyword">try</span>
      <span class="fence2">{</span>
      <span class="importantkeyword">return </span><span class="var">n</span><span class="operator">*</span><span class="var">n</span><span class="semicolon">;</span>
      <span class="fence2">}</span>
   <span class="keyword">finally</span>
      <span class="fence2">{</span>
      <span class="importantkeyword">return </span><span class="decimallow">0</span><span class="semicolon">;</span>
      <span class="fence2">}</span>
   <span class="fence1">}</span></pre><!-- /generated by JDisplay -->
Also, the behavior of exceptions thrown from within finally blocks is not obvious.
<h2 class="gotcha"><a name="THREADS"></a>Thread Safety</h2>
Thread safety is underspecified, in particular:
<ol><li>Implications of finalization on concurrent programs. In the Sun VM, there is a garbage collection thread
that is responsible for freeing unreferenced objects and calling their finalizers. If your finalizer calls
synchronized methods, you can wind up with very hard to debug deadlocks.</li>
<li>Should the implementation of method clone() from interface Cloneable be thread safe or not?</li>
<li>A rule of thumb is: never assume that JDK objects are thread safe. Do not think, <i>&quot;Oh, I bet I can
guess the implementation, and it must be thread safe.&quot;</i> For example, <span class="java">java.util.SimpleDateFormat</span> is not thread safe, so things like this will cause strange formatting
errors in multithreaded programs: <!-- macro JDisplay gotchas.example159.javafrag --><!-- generated --><div class="jdisplay"><iframe src="snippet/iframe/gotchas.example159.javafrag.html" width="800" height="354" scrolling="yes" frameborder="1"></iframe></div><!-- /generated by JDisplay --></li>
<li>Swing components are <b>not</b> thread-safe. You must use <span class="method">javax.swing.SwingUtilities.invokeLater()/invokeAndWait() or <span class="class">EventQueue</span>.
<span class="method">invokeLater</span>.</span> in any code which might possibly be called by a thread other
than the main event-dispatching thread. This crops up frequently in writing custom ListModels and TreeModels
which respond to non-local or non-GUI events.</li>
<li><span class="class">java.util.Hashtable</span> and <span class="class">java.util.Vector</span> are two
examples of JDK objects whose every method is synchronized. This imposes a large runtime cost on applications
that iterate over these structures. When you are not using threads, prefer <span class="class">java.util.HashMap</span> and <span class="class">java.util.ArrayList</span> respectively. If you are
using JDK <span class="version">1.6+</span>, it may pay to cannibalise the Hashtable code and remove the
synchronisation.</li>
<li><span class="method">Thread.sleep(5000)</span> is supposed to sleep for 5 seconds. However, if somebody
changes the system time, you may sleep for a very long time or no time at all. The OS records the wake up time
in absolute form, not relative.</li>
<li>Thread scheduling is not guaranteed to be round-robin. A task may totally hog the cpu at the expense of
threads of the same priority. You can use <span class="method">Thread.yield()</span> to have a conscience. You
can use <span class="method">Thread.setPriority(Thread.NORM_PRIORITY-1)</span> to lower a thread&rsquo;s
priority. In Applets you need security clearance to even <i>lower</i> thread priority.</li></ol>
<h2 class="gotcha"><a name="BIGDECIMAL"></a><!-- macro Image "icon64/lemon.png" "lemon" --><!-- generated --><img src="../image/icon64/lemon.png" alt="lemon" width="63" height="60" border="0"><!-- /generated by Image -->
java.math.BigDecimal</h2>
BigDecimal provides for immutable arbitrary-precision signed decimal numbers. A BigDecimal consists of an
arbitrary precision integer unscaled value (a BigInteger 2-two&rsquo;s complement variable length array of bytes)
and a non-negative 32-bit integer scale, which represents the number of digits to the right of the decimal point.
<p>For greater efficiency, you can often use a long or int, and keep track of the scaling yourself, and inserting
a decorative decimal point on output.</p>
<p><span class="class">BigDecimal</span> is a travesty and deserves raspberries just like <span class="class">Date</span>. Briefly, it is slow, it is difficult to use, it uses native methods, and it quietly drops
off significant digits during conversion.</p>
<p>Also, <span class="package">java.text</span>.<span class="class">DecimalFormat</span>. <span class="method">parse</span> returns either a <span class="class">Long</span> or a Double. There is no built-in way to
define custom number formatting for <span class="class">BigDecimal</span>or <span class="class">BigInteger</span>
objects.</p>
<p>Fortunately, IBM has made available its proposed replacement for Sun&rsquo;s class, which is <span class="statistic">23</span> times faster, smaller, uses no native methods, and implements standard ANSI X3.274 floating
arithmetic. For the spec see: <a class="offsite" href="http://speleotrove.com/decimal/decimalj/decimalj.html">IBM&rsquo;s Decimal Arithmetic For Java</a> and <a class="offsite" href="http://www.alphaworks.ibm.com/tech">AlphaWorks</a>. Dirk Bosmans has implemented the IBM spec as
<a class="offsite" href="http://users.belgacombusiness.net/arci/math/">ArciMath</a>. Another implementation is
<a class="offsite" href="http://www.prosperosoftware.co.uk">PSPDec</a>.</p>
<h2 class="gotcha"><a name="DRAWRECT"></a>java.awt.Graphics.drawRect</h2>
<!-- macro JDisplay gotchas.example165.javafrag --><!-- generated --><pre class="java"><span class="var">java</span><span class="operator">.</span><span class="var">awt</span><span class="operator">.</span><span class="class">Graphics</span><span class="operator">.</span><span class="method">drawRect</span><span class="fence1">(</span> <span class="keyword">int </span><span class="vardef">x</span><span class="operator">, </span><span class="keyword">int </span><span class="vardef">y </span><span class="operator">, </span><span class="keyword">int </span><span class="vardef">width </span><span class="operator">, </span><span class="keyword">int </span><span class="vardef">height </span><span class="fence1">)</span></pre><!-- /generated by JDisplay -->
<p>draws a rectangle one pixel bigger than the specified width and height. I am told if you understand the
abstract drawing model the AWT uses, it turns out this extra pixel is deliberate and unavoidable. The rationale
is that you specify the path of an idealised box drawn with infinitely thin lines, and the pen hangs down and to
the right, at least one pixel thick.</p>
<h2 class="gotcha"><a name="DRAWSTRING"></a>java.awt.Graphics.drawString</h2>
All graphics routines expect x,y to represent the upper left corner of a bounding box. However for <span class="class">Graphics</span>.<span class="method">drawString()</span> x,y refers to the to the baseline (which is
distinct yet again from the lower left corner). This inconsistency is traditional in drawing packages. You need
to take into account the font metrics: <!-- macro JDisplay gotchas.example166.javafrag --><!-- generated --><pre class="java"><span class="var">g</span><span class="operator">.</span><span class="method">drawString</span><span class="fence1">(</span> <span class="string">&quot;Hello World&quot;</span> <span class="operator">, </span><span class="decimallow">0</span><span class="operator">, </span><span class="method">getFontMetrics</span><span class="fence2">(</span><span class="method">getFont</span><span class="fence3">(</span><span class="fence3">)</span><span class="fence2">)</span><span class="operator">.</span><span class="method">getAscent</span><span class="fence2">(</span><span class="fence2">)</span> <span class="fence1">)</span><span class="semicolon">;</span></pre><!-- /generated by JDisplay -->
<h2 class="gotcha"><a name="GRIDBAGLAYOUT"></a>GridBagLayout</h2>
Whenever you use any layout manager, other than null, it is going to decide the sizes and placement of the
components. Your <span class="method">setLocation()</span>, <span class="method">setBounds()</span> and
<span class="method">setSize()</span> calls will all be overridden. Some ways you can get finer control are:
<ul><li>Write your own layout manager. It is not as hard as you might think.</li>
<li>Override the <span class="method">getPreferredSize</span> and <span class="method">getMinimumSize</span>
methods of your components. See the <a href="#DEPRECATION">Deprecation Blues</a> section. These methods used to
be called <span class="method">preferredSize</span> and <span class="method">minimumSize</span>, and there are
problems overriding deprecated methods.</li>
<li>For Swing components, you don&rsquo;t need any overriding. Have the object send itself a <span class="method">setPreferredSize()</span> in its constructor or the client can send it before it is laid out, and the
right thing will happen.</li></ul>
<span class="class">GridBagLayout</span> sometimes behaves strangely, generating oddly asymmetric layouts. The
problem can usually be traced to trying to put two components into the same grid cell. You won&rsquo;t get any
error message when you do this.
<p>GridBagLayout will generate goofy layouts when components provide incorrect numbers for minimum and preferred
size. For example <span class="class">TextField</span>s don&rsquo;t take into consideration setColumns or the
size of the current font. All you can do is fudge using the <span class="var">ipadx</span> and <span class="var">ipady</span> parameters to inflate the minimum size.</p>
<p><span class="class">GridBayLayout</span> does not mind if you have a row or column with nothing in it. It will
take no space. You might consider leaving some empty rows and columns in your layouts for future expansion.</p>
<p><span class="var">weightx</span> and <span class="var">weighty</span> control where the extra space goes if
the container is expanded. Think of them as percentages that don&rsquo;t have to add up to 100%. They are
automatically normalised. To figure out which column should get the most space, GridBagLayout examines each
component in the column, and looks at its weightx. It saves the biggest weightx of all the components in that
column as the weight for the entire column. It does not average them, or add them. Then it proportionately
assigns the extra space based on the column weights. The component with a lot of weight does not necessarily
grow, just the column that component is in. Giving equal but non-zero weight to columns tends to equalize their
size.</p>
<p>GridBagLayout does the same thing allocating extra space to rows by using weighty.</p>
<p>The <span class="java">Insets(top, left, bottom, right)</span> can be used to build a border around a
component. The four numbers are measured in pixels.</p>
<p>If you want to fix the size of some element, you must use all three methods: <span class="method">setMinimumSize</span>, <span class="method">setMaxiumSize</span> and <span class="method">setPreferredSize</span>.</p>
<p>Make sure you supply some non-zero x and y weights in your <span class="class">GridBag</span>. Otherwise when
you squeeze the frame down too small the components will act as if they had infinite space and will scoot madly
offscreen to the right.</p>
<p>If you use <span class="var">GridBagConstraints.BOTH</span>, forcing fill, that will override any <span class="method">setMaximumSize</span> you may have specified on your panel.</p>
<h2 class="gotcha"><a name="NULLLAYOUT"></a>Null Layout</h2>
It is possible to handle layout manually with a <a href="layout.html#NULLLAYOUTS">null layout manager</a>. To do
absolute positioning, in theory all you need to do is <span class="method">Container.setLayout( null )</span>,
and the position your components with <span class="method">Component.setLocation( x, y )</span>. However when you
do this, you often find yourself looking at a blank screen. Here are some things to check.
<ul><li>Has your enclosing container shrunk down to a point size 0,0? If so you can buttress it with span
<span class="class">Container</span>.<span class="method">setMinimumSize</span>( x, y ), Container.setSize(x,
y);, <span class="class">Container</span>.<span class="method">setPreferredSize</span>( x, y ), <span class="class">Container</span>.<span class="method">setMaximumSize( x, y )</span>.</li>
<li>Have your <span class="class">Component</span>s all got locations and sizes? I found, for example, that
creating a <span class="class">JButton</span> with an <span class="class">Icon</span> was not sufficient to set
the size of the button to the image size. you must do a <span class="java">Dimension d =
jbutton.getPreferredSize(); jbutton.setSize( d );</span></li>
<li>Have you positioned Components offscreen?</li>
<li>Have you arranged for repaints?</li></ul>
Oddly, it may be simpler to write your own custom <span class="interface">LayoutManager</span> to do your
positioning. The advantages of writing a custom layout are:
<ul class="advantage"><li>The code that uses the <span class="interface">LayoutManager</span> is perfectly normal.</li>
<li>You can reuse the layout in other situations.</li>
<li>Instead of doing absolute positioning, you might create something slightly more general purpose. You can
still force the size of the container to a fixed value, avoiding all the comlicated parts of writing a
<span class="interface">LayoutManager</span>.</li>
<li>It segregates the positioning and sizing logic, thus making your code simpler to read.</li>
<li>You can create more maintainable code. The <span class="interface">LayoutManager</span> does the
calculations the programmer would otherwise have to do manually.</li></ul>
For a simple <span class="interface">LayoutManager</span> or <span class="interface">LayoutManager2</span>, many
of the methods can be dummies.
<h2 class="gotcha"><a name="DEPRECATION"></a>Deprecation Blues</h2>
With JDK <span class="version">1.6+</span>, Sun brought more order to the naming of various methods, particularly
in the AWT. The old names are still supported but deprecated (discouraged from use pending complete removal).
Deprecated names are not aliases the compiler translates to the new names. They are full fledged methods in their
own right. I wondered why vendors like Sun and Symantec were so reluctant to abandon the old names entirely and
convert completely to the new scheme. I have discovered why.
<p><span class="method">setVisible()</span> calls the deprecated <span class="method">show()</span>, the reverse
of that you might expect. You would think the deprecated method should bear the speed penalty of another layer of
indirection. Yet consider what happens if you write a new <span class="method">setVisible()</span> method to
override one of the built-in ones. Users of the original <span class="method">show()</span> method will be
unaffected. They will continue to use the old code. Only those who directly call <span class="method">setVisible()</span> will use your new routine. Now, consider what happens if you write a new deprecated
<span class="method">show()</span> method to override one of the built-in ones. All works properly; everyone will
use your new method. You are thus stuck writing <b>new</b> <b>deprecated</b> methods if you want your code to
work properly.</p>
<p>Let us say the AWT were redesigned so that instead <span class="method">show()</span> called <span class="method">setVisible()</span>. Then old code that used the deprecated methods would suddenly stop working.</p>
<p>This problem is general and applies to all deprecated methods. Let us hope Sun will soon get rid of the
deprecated methods entirely, then this problem will go away. Most of the deprecated names are just name changes
to fit the JavaBeans get/set conventions. Such deprecations could be handled as pure aliases by translation to
the new names inside the compiler, and do away with the old classes entirely. However, that would cause a
political problem of JDK <span class="version">1.0.2</span> code no longer running under JDK <span class="version">1.6+</span> without recompilation or some translation process. You could not then have code that would
run both under JDK <span class="version">1.02</span> and 1.1. We would need to support the translation process in
the JVM to have old code automatically use the new names. Sun is very reluctant to make any changes to the
JVM.</p>
<p>The JDK <span class="version">1.0.2</span> event handling routines are also deprecated. It is quite a bit
bigger job to convert those. They could not be handled by a simple alias.</p>
<h2 class="gotcha"><a name="BUFFEREDREADER"></a>java.io.BufferedReader &amp;
BufferedInputStream</h2>
<!-- macro JDisplay gotchas.example167.javafrag --><!-- generated --><pre class="java"><span class="keyword">int </span><span class="class">BufferedInputStream</span><span class="operator">.</span><span class="method">read</span><span class="fence1">(</span> <span class="keyword">byte</span><span class="fence1">[</span><span class="fence1">]</span> <span class="vardef">m</span><span class="operator">, </span><span class="keyword">int </span><span class="vardef">offset</span><span class="operator">, </span><span class="keyword">int </span><span class="vardef">len </span><span class="fence1">)</span></pre><!-- /generated by JDisplay -->
is advertised to block until some input is available. It returns the number of bytes read, or -1 for EOF. You
might <b>erroneously</b>presume that it blocks either:
<ul><li>until at least <b>len</b> bytes are available.</li>
<li>until a <b>buffer full</b> of bytes are available.</li></ul>
Not so. You might get as little as one-byte back, even when you are nowhere near the EOF. <span class="method">len</span> just controls the maximum amount you are prepared to accept.
<!-- macro JDisplay gotchas.example168.javafrag --><!-- generated --><pre class="java"><span class="keyword">int </span><span class="class">BufferedReader</span><span class="operator">.</span><span class="method">read </span><span class="fence1">(</span> <span class="keyword">char</span><span class="fence1">[</span><span class="fence1">]</span> <span class="vardef">m</span><span class="operator">, </span><span class="keyword">int </span><span class="vardef">offset</span><span class="operator">, </span><span class="keyword">int </span><span class="vardef">len </span><span class="fence1">)</span></pre><!-- /generated by JDisplay -->
has a similar gotcha. You must use <span class="method">java.io.DataInputStream.readFully</span> if you want to
get all the bytes you asked for.
<p>The read routine has another problem. It traps and ignores IOExceptions rather than passing them on to you. To
get around both the above problems, you can use your own read routine like this:
<!-- macro JDisplay gotchas.example169.javafrag --><!-- generated --><div class="jdisplay"><iframe src="snippet/iframe/gotchas.example169.javafrag.html" width="715" height="580" scrolling="yes" frameborder="1"></iframe></div><!-- /generated by JDisplay -->
For more elaborate code to deal with the problem <a href="../products1.html#HTTP">download</a> the <span class="package">com.mindprod.http</span> package and <a href="../products1.html#FILETRANSFER">download</a> the
<span class="package">com.mindprod.filetransfer</span> package. You can also view some of the code at the
<a href="http.html">http</a> entry.
<h2 class="gotcha"><a name="APPLETRESTRICTIONS"></a>Applets Can&rsquo;t Use The Local
Hard Disk</h2>
The whole idea of an <span class="class">Applet</span> is to protect the user from you putting any files or
meddling with any files on his hard disk, so you are going to have to cheat if you want your <span class="class">Applet</span> to be able to write or read his local hard disk. Here are seven possibilities:
<ol><li>Give the user a new security manager that has to be installed specially that gives permission to
<b>just</b> your Applet to write to disk. Unfortunately, this won&rsquo;t work if anybody else does the same
thing. Security managers are still a black art. I have not yet seen any documentation on just how you would do
this.</li>
<li>Convert your Applet to an application. The user has to download and install it, find and install some sort
of standalone Java system for his platform, then run it. Whew!</li>
<li>Write a native class to cheat and do the I/O behind the security manager&rsquo;s back. You will need to
write such a native class for each different platform, then arrange to have it installed separately ahead of
time. Ouch! Even then you still need security clearance to run the native class.</li>
<li>Use JavaScript or Active-X or some other gonzo scheme that cares not a fig for security.</li>
<li>Join the ranks of other programmers with their torches and pitchforks demanding some sort of chimera
&mdash; half Applet/half application. It would be allowed access to a limited amount of disk space, and would
not have access to any files it did not create. It could run inside a browser. This would have general
applicability. You could do off-line data entry for example then upload, or retain application preference
information, cache server data,&hellip;</li>
<li>Using the preferences of Internet Explorer, if you list an application&rsquo;s site as a &quot;Trusted
Site&quot;, then if you set the security zone for &quot;Trusted Sites&quot; to &quot;Custom&quot; and change
the settings such that Java permissions are &quot;Unrestricted&quot; and &quot;Launch applications and
files&quot; is enabled, whew!, you will be able to write/read files from the local hard drive from within an
Applet. Unfortunately Netscape has no equivalent feature.</li>
<li>Lobby for a generic user-configurable security manager, that lets users OK various naughty behaviours from
specific Applets. The Applet would have an interface to request permission for special dispensation with
minimum and ideal requirements.</li></ol>
<h2 class="gotcha"><a name="SERIALIZATION"></a>Reconstituted Serialized Objects</h2>
The process of serialization and reconstituting objects is fraught with problems.
<ul><li>You may not append to the end of a serialized stream once it has been closed and reopened in append mode.
The writes will appear to work, but when you go to read the file later you will get a <span class="package">java.io.</span><span class="class">StreamCorruptedException</span>.</li>
<li>In the creation of the serial stream, Java uses recursion. This limits you to a chain of about 1000
elements long.</li>
<li>If you output an object twice to the stream because it has changed, only the first copy will actually go to
the stream, unless you use the atomic bomb technique of resetting to make it forget <i>all</i> past
history.</li>
<li>When an object is reconstituted, the <b>default</b> constructor of any non-serializable superclass is run,
not the constructor that was actually used to originally create the object. However, <b>no</b> constructor of
the serialized class itself is run, not even the default constructor. Further, the initialisation in the field
instance declarations is ignored. The logic behind this would be, why bother to initialise when you are about
to overlay with reconstituted fields? That is fine for ordinary fields, but it leaves <b>transient</b> fields
uninitialised.</li>
<li>Code to initialise variables as part of the declaration e.g. <span class="java">int q = 8;</span> is
ignored, (except in non-serialiable superclasses).</li>
<li>Transient variables will just be set to 0 or null. Any initialisation code in a constructor or instance
declarations will be ignored.</li>
<li>Fields are serialized and reconstituted in alphabetical order, not necessarily the same order they appear
in the object. This can lead to bizarre effects in reconstituting when you make a forward reference to a field
alphabetically later than the current one since it has not yet been reconstituted.</li>
<li>Static fields are neither serialied nor reconstructed.</li>
<li>If you have a static singleton object that is also referred to by instance fields, an unwanted extra copy
of the singleton object will be created on reconstitution. Each time you serialize and reconstitute you get
more and more copies of the singleton object.</li></ul>
What could you do to ensure transient fields in reconstituted objects are properly initialised?
<ul><li>Don&rsquo;t use any transient variables. Serialize everything. Yet, when you have a peek at just how bulky
serialized objects are, you won&rsquo;t think much of this technique. You want to avoid serializing anything
you don&rsquo;t have to.</li>
<li>Code so that the transient variables work even when they have default null or zero values. This is the
simplest.</li>
<li>Use the <span class="class">Externalizable</span> interface, which is an extension of <span class="class">Serializable</span> that add the <span class="method">readExternal</span> and <span class="method">writeExternal</span> methods. When Externalizable objects are reconstituted, their default constructor
<b>is</b> used. The constructor also gives you a place to insert code to reconstitute static fields.</li>
<li>Classes that implement Serialization should <b>not</b> use initializers. They should do all the equivalent
work in an <span class="method">initTransient</span> method and call it from both the constructor and
<span class="method">readObject</span>. This is ugly but safe.</li>
<li>Check on <b>every</b> method entry, not just <span class="method">readObject</span> and initialize the
transient (yeach!).</li>
<li>Call an <span class="method">initTransient</span> method after reading your object (but it then has to be
forwarded to the sub-objects, etc. Make it an interface.</li>
<li>Derive the <span class="method">ObjectInputStream</span> and make it call the <span class="method">initTransient</span> (or check for the interface) in either the <span class="method">resolveObject</span> or the <span class="method">validateObjects</span> method.</li></ul>
<h2 class="gotcha"><a name="REPAINT"></a>&quot;Broken&quot; Repaint</h2>
A very common beginner&rsquo;s problem is failure of <span class="method">repaint()</span> to redraw the screen.
<span class="method">repaint()</span> works by putting an object in a queue to remind the system to schedule the
<span class="method">paint()</span> later. It will never get around to servicing the queue if you don&rsquo;t
quickly return from your init method, or handling the keystroke or button press event. Calling <span class="method">Thread.sleep()</span> just makes matters worse, since the current thread is the one that will have to
later do the <span class="method">paint()</span>.
<h2 class="gotcha"><a name="HIDDEN"></a>Hidden Components Won&rsquo;t Stay Hidden</h2>
<span class="method">setEnabled( <span class="keyword">false</span> )</span> disables a component by graying it
out. <span class="method">setVisible( <span class="keyword">false</span> )</span> (a.k.a <span class="method">hide()</span>) makes the component totally disappear, with an <span class="method">invalidate()</span>,
which marks all containing components as needing a <span class="method">repack()</span>, so that surrounding
components will be shuffled to grow into the space it vacates. <span class="method">setVisible( <span class="keyword">true</span> )</span> (a.k.a. <span class="method">show()</span>) also marks visible all contained
subcomponents. This means a component you have hidden will infuriatingly unhide itself the next time you
<span class="method">setVisible( <span class="keyword">true</span> )</span> the enclosing window. This is fixed
in JDK1.1+.
<p>I know of no method that will let you <span class="method">hide</span> a component, that does not <span class="method">invalidate</span>, thus leaving its space reserved, with no shuffling of sibling components.</p>
<h2 class="gotcha"><a name="DIALOG"></a>Dialog.setBackground Does Not Work</h2>
The Dialog background gets reset when the dialog is being prepared for display, so your call to <span class="method">setBackground</span> (or <span class="method">setForeground</span>) in the constructor won&rsquo;t have
an effect. You can fix it with a hook into the <span class="method">addNotify</span> method of your <span class="class">Dialog</span> class: <!-- macro JDisplay gotchas.example170.javafrag --><!-- generated --><pre class="java"><span class="keyword">public void </span><span class="method">addNotify</span><span class="fence1">(</span><span class="fence1">)</span>
   <span class="fence1">{</span>
   <span class="keyword">super</span><span class="operator">.</span><span class="method">addNotify</span><span class="fence1">(</span><span class="fence1">)</span><span class="semicolon">;</span>
   <span class="method">setBackground</span><span class="fence1">(</span> <span class="class">Color</span><span class="operator">.</span><span class="var">red </span><span class="fence1">)</span><span class="semicolon">;</span>
   <span class="fence1">}</span></pre><!-- /generated by JDisplay -->
Add notify creates the peer object. You are hooking your code in right after the peer gets created.
<p>You also need to explicitly control the background of each component. Inheriting it from the <span class="class">Dialog</span> will just give gray.</p>
<p>One further warning. In JDK <span class="version">1.0</span>, the modal feature of dialogs does not work.</p>
<h2 class="gotcha"><a name="SOCKET"></a>Socket To Me</h2>
The <span class="java">Socket()</span> constructor doesn&rsquo;t allow you to specify a timeout. The default of
1.5 minutes is usually quite excessive.
<p>Until <span class="package">nio</span>, there was no <span class="method">select()</span> like functionality
in sockets (or to be more flexible, in InputStreams) and there was no timeout in the <span class="method">InputStream.read()</span> method. This makes it impossible to program a <span class="class">Socket</span> server having a number of threads less than the number of users. However, I am told that if
you use the <span class="method">available()</span> method cleverly you can fudge it.</p>
<p>You have some control over timeouts with the networking system properties.
<!-- macro Sun "Networking properties" guides/net/properties.html --><!-- generated --><div class="sun">Sun&rsquo;s JDK Technote Guide on <b>Networking properties</b> : available:<ul><li>on the web at <a class="sun" href="http://java.sun.com/javase/6/docs/technotes/guides/net/properties.html">java.sun.com</a></li>
<li>in the current <a href="file:///J:/Program%20Files/java/jdk1.6.0_18/docs/technotes/guides/net/properties.html">JDK <span class="version">1.6.0_18</span></a> on your local Windows <a class="plain" href="jdrive.html"><span class="drive">J:</span> drive</a>.</li></ul></div>
<!-- /generated by Sun -->
<div class="see"><a href="properties.html">properties</a></div>
<h2 class="gotcha"><a name="JSP"></a>JSP Import Blues</h2>
The problem is in the include mechanism used by Tomcat 4.0.3 and possibly other JSP server products. The language
uses a <span class="html">&lt;%@page import=&quot;package.package.class&quot; %&gt;</span> notation to import
classes.
<p>If you use an include for boilerplate headers and footers then you may get a <span class="class">ClassNotFoundException</span> if the included JSPs uses a custom class.</p>
<p>ASP developers are used to source code being dropped in by the ASP preprocessor and interpretted as one big
file. According to this logic an import statement would be expected to appear at the top of the &quot;page&quot;,
where most ppl declare variables and define functions are in ASP. However in JSP, things tend to be split up and
stay split up into many small files. You must thus make sure the import goes in each file that uses it, not just
at the beginning.</p>
<h2 class="gotcha"><a name="ERRORMESSAGES"></a>Misleading Error Messages</h2>
A compiler looks at source code from quite a different perspective that humans do. You gradually get to know what
your compiler <b>really</b> means when it says baffling things like &quot;{ expected.&quot;
<p>See the <a href="errormessages.html">table of error messages</a>, now a separate document.</p>
<h2 class="gotcha"><a name="CREDITS"></a>Credits</h2>
As you might guess, a great many people helped compile this list. I have only recently started giving credit. If
you would like to be added to this list, please tell me.
<p><!-- macro Include jgloss/include/whymasked.html --><!-- generated -->Unfortunately, the email addresses below are not clickable.
<!-- W A R N I N G _ I N C L U D E D -->Further you cannot copy/paste them into
your email program. You must manually re-type them. The email addresses are
graphic <span class="ext">*.png</span> images created by&nbsp;<a class="applet" href="../applet/masker.html">Masker</a>
.<!-- W A R N I N G _ I N C L U D E D --> I inconvenience you this way to
discourage spammers from harvesting email addresses from the website with
automated website spidering.
<!-- end Include from jgloss/include/whymasked.html --><!-- /generated by Include --></p>
<table class="standard"><tbody><tr><td>Tov Are</td>
<td><!-- macro MailTo tovare "Tov Are" --><!-- generated --><img class="mailto" src="../image/mailto/tovare.png" alt="email Tov Are" width="152" height="22" border="0"><!-- /generated by MailTo --></td></tr>
<tr><td>Paul van Keep</td>
<td><!-- macro MailTo paulvankeep "Paul van Keep" --><!-- generated --><img class="mailto" src="../image/mailto/paulvankeep.png" alt="email Paul van Keep" width="142" height="22" border="0"><!-- /generated by MailTo --></td></tr>
<tr><td>Mike Cowlishaw</td>
<td><!-- macro MailTo mikecowlishaw "Mike Cowlishaw" --><!-- generated --><img class="mailto" src="../image/mailto/mikecowlishaw.png" alt="email Mike Cowlishaw" width="159" height="22" border="0"><!-- /generated by MailTo --></td></tr>
<tr><td>Pierre Baillargeon</td>
<td><!-- macro MailTo pierrebaillargeon "Pierre Baillargeon" --><!-- generated --><img class="mailto" src="../image/mailto/pierrebaillargeon.png" alt="email Pierre Baillargeon" width="173" height="22" border="0"><!-- /generated by MailTo --></td></tr>
<tr><td>Bill Wilkinson</td>
<td><!-- macro MailTo billwilkinson "Bill Wilkinson" --><!-- generated --><img class="mailto" src="../image/mailto/billwilkinson.png" alt="email Bill Wilkinson" width="170" height="22" border="0"><!-- /generated by MailTo --></td></tr>
<tr><td>Patricia Shanahan</td>
<td><!-- macro MailTo patriciashanahan "Patricia Shanahan" --><!-- generated --><img class="mailto" src="../image/mailto/patriciashanahan.png" alt="email Patricia Shanahan" width="130" height="22" border="0"><!-- /generated by MailTo --></td></tr>
<tr><td>Joseph Bowbeer</td>
<td><!-- macro MailTo josephbowbeer "Joseph Bowbeer" --><!-- generated --><img class="mailto" src="../image/mailto/josephbowbeer.png" alt="email Joseph Bowbeer" width="126" height="22" border="0"><!-- /generated by MailTo --></td></tr>
<tr><td>Charles Thomas</td>
<td><!-- macro MailTo charlesthomas "Charles Thomas" --><!-- generated --><img class="mailto" src="../image/mailto/charlesthomas.png" alt="email Charles Thomas" width="224" height="22" border="0"><!-- /generated by MailTo --></td></tr>
<tr><td>Joel Crisp</td>
<td><!-- macro MailTo joelcrisp "Joel Crisp" --><!-- generated --><img class="mailto" src="../image/mailto/joelcrisp.png" alt="email Joel Crisp" width="244" height="22" border="0"><!-- /generated by MailTo --></td></tr>
<tr><td>Eric Nagler</td>
<td><!-- macro MailTo ericnagler "Eric Nagler" --><!-- generated --><img class="mailto" src="../image/mailto/ericnagler.png" alt="email Eric Nagler" width="176" height="22" border="0"><!-- /generated by MailTo --></td></tr>
<tr><td>Daniel Leuck</td>
<td><!-- macro MailTo danielleuck "Daniel Leuck" --><!-- generated --><img class="mailto" src="../image/mailto/danielleuck.png" alt="email Daniel Leuck" width="152" height="22" border="0"><!-- /generated by MailTo --></td></tr>
<tr><td>William Brogden</td>
<td><!-- macro MailTo williambrogden "William Brogden" --><!-- generated --><img class="mailto" src="../image/mailto/williambrogden.png" alt="email William Brogden" width="167" height="22" border="0"><!-- /generated by MailTo --></td></tr>
<tr><td>Yves Bossu</td>
<td><!-- macro MailTo yvesbossu "Yves Bossu" --><!-- generated --><img class="mailto" src="../image/mailto/yvesbossu.png" alt="email Yves Bossu" width="164" height="22" border="0"><!-- /generated by MailTo --></td></tr>
<tr><td>Chad Loder</td>
<td><!-- macro MailTo chadloder "Chad Loder" --><!-- generated --><img class="mailto" src="../image/mailto/chadloder.png" alt="email Chad Loder" width="134" height="22" border="0"><!-- /generated by MailTo --></td></tr>
<tr><td>Savas Alparslan</td>
<td><!-- macro MailTo savasalparslan "Savas Alparslan" --><!-- generated --><img class="mailto" src="../image/mailto/savasalparslan.png" alt="email Savas Alparslan" width="186" height="22" border="0"><!-- /generated by MailTo --></td></tr>
<tr><td>Simon Gibbs</td>
<td><!-- macro MailTo simongibbs "Simon Gibbs" --><!-- generated --><img class="mailto" src="../image/mailto/simongibbs.png" alt="email Simon Gibbs" width="196" height="22" border="0"><!-- /generated by MailTo --></td></tr>
<tr><td>Laurence Vanhelsuw&eacute;</td>
<td><!-- macro MailTo laurencevanhelsuwe "Laurence Vanhelsuw&eacute;" --><!-- generated --><img class="mailto" src="../image/mailto/laurencevanhelsuwe.png" alt="email Laurence Vanhelsuw&eacute;" width="250" height="22" border="0"><!-- /generated by MailTo --></td></tr>
<tr><td>Norman Paterson</td>
<td><!-- macro MailTo normanpaterson "Norman Paterson" --><!-- generated --><img class="mailto" src="../image/mailto/normanpaterson.png" alt="email Norman Paterson" width="214" height="22" border="0"><!-- /generated by MailTo --></td></tr>
<tr><td>Jonathan Finn</td>
<td><!-- macro MailTo jonathanfinn "Jonathan Finn" --><!-- generated --><img class="mailto" src="../image/mailto/jonathanfinn.png" alt="email Jonathan Finn" width="156" height="22" border="0"><!-- /generated by MailTo --></td></tr></tbody></table>
<h2 class="books"><a name="BOOKS"></a>Books</h2>
<!-- macro Book isbn=032133678X
paperback=032133678X
title="Java &trade; Puzzlers : Traps, Pitfalls, and Corner Cases"
publisher="Addison-Wesley"
published=2005-07-04
author="Joshua Bloch, Neal Gafter"
notes={A set of 95 short programs that give astonishing results. When you understand them, you understand
the quirkier features of Java.
Bloch wrote much of the JDK class library.
He also wrote the <cite>Effective Java Programming Language Guide</cite>} --><!-- generated --><table class="sellbook" summary="Book referral for Java &trade; Puzzlers : Traps, Pitfalls, and Corner Cases"><tbody><tr><td rowspan="6"><img class="booktitle" src="../image/bookcover/9780321336781.jpg" alt="book cover" width="127" height="160" border="0"></td>
<td colspan="2" class="booktitle"><span class="indexing">recommend book&rArr;</span>Java &trade; Puzzlers : Traps, Pitfalls, and Corner Cases</td></tr>
<tr><td>&nbsp;</td><th><b>paperback</b></th></tr><tr><th align="right">ISBN13:</th><td><a class="isbn" href="http://www.amazon.com/gp/product/032133678X?ie=UTF8&amp;tag=canadianmindprod&amp;linkCode=as2&amp;camp=1789&amp;creative=9325&amp;creativeASIN=032133678X">978-0-321-33678-1</a><img class="impressioncounter" src="http://www.assoc-amazon.com/e/ir?t=canadianmindprod&amp;l=as2&amp;o=1&amp;a=032133678X" width="1" height="1" border="0" alt="impressioncounter"></td></tr><tr><th align="right">publisher:</th><td colspan="1">Addison-Wesley</td></tr>
<tr><th align="right">published:</th><td colspan="1"><span class="date">2005-07-04</span></td></tr>
<tr><th align="right">by:</th><td colspan="1"><span class="by">Joshua Bloch, Neal Gafter</span></td></tr>
<tr><td colspan="3" class="notes">A set of 95 short programs that give astonishing results. When you understand them, you understand the quirkier features of Java. Bloch wrote much of the JDK class library. He also wrote the <cite>Effective Java Programming Language Guide</cite></td></tr>
<tr><td colspan="3" class="buy"><table class="sellbookgrid" width="100%" summary="Online bookstores carrying Java &trade; Puzzlers : Traps, Pitfalls, and Corner Cases"><colgroup><col align="right"><col align="left"><col align="right"><col align="left"></colgroup><tbody><tr><td class="flag"><img src="../image/flag/uk.png" alt="UK flag" width="50" height="25" border="0"></td>
<td><a class="plain" rel="nofollow" href="http://clickserve.cc-dt.com/link/tplclick?lid=41000000024289215&amp;pubid=21000000000049036&amp;redirect=http%3A%2F%2Fwww.abebooks.co.uk%2Fservlet%2FSearchResults%3Fbt.x%3D0%26bt.y%3D0%26isbn%3D9780321336781%26sortby%3D3%26sts%3Dt">abe&thinsp;books.co.uk</a></td>
<td><a class="plain" rel="nofollow" href="http://clickserve.cc-dt.com/link/tplclick?lid=41000000024289215&amp;pubid=21000000000049036&amp;redirect=http%3A%2F%2Fwww.abebooks.com%2Fservlet%2FSearchResults%3Ffromanz%3Dfromanz%26isbn%3D9780321336781%26sortby%3D96%26sts%3Dt%26x%3D68%26y%3D8">abe&thinsp;books.ca</a></td>
<td class="flag"><img src="../image/flag/canada.png" alt="Canadian flag" width="50" height="25" border="0"></td></tr>
<tr><td class="flag"><img src="../image/flag/uk.png" alt="UK flag" width="50" height="25" border="0"></td>
<td><a class="plain" rel="nofollow" href="http://www.amazon.co.uk/gp/product/032133678X?ie=UTF8&amp;tag=canadianmindp-21&amp;linkCode=as2&amp;camp=1634&amp;creative=6738&amp;creativeASIN=032133678X">amazon.co.uk</a><img class="impressioncounter" src="http://www.assoc-amazon.co.uk/e/ir?t=canadianmindp-21&amp;l=as&amp;o=2&amp;a=032133678X" width="1" height="1" alt="." border="0"></td>
<td><a class="plain" rel="nofollow" href="http://www.amazon.ca/gp/product/032133678X?ie=UTF8&amp;tag=canadianmin07-20&amp;linkCode=as2&amp;camp=15121&amp;creative=330641&amp;creativeASIN=032133678X">amazon.ca</a><img class="impressioncounter" src="http://www.assoc-amazon.ca/e/ir?t=canadianmin07-20&amp;l=as&amp;o=15&amp;a=032133678X" width="1" height="1" alt="." border="0"></td>
<td class="flag"><img src="../image/flag/canada.png" alt="Canadian flag" width="50" height="25" border="0"></td></tr>
<tr><td class="flag"><img src="../image/flag/germany.png" alt="German flag" width="50" height="30" border="0"></td>
<td><a class="plain" rel="nofollow" href="http://clickserve.cc-dt.com/link/tplclick?lid=41000000024289215&amp;pubid=21000000000049036&amp;redirect=http%3A%2F%2Fwww.abebooks.de%2Fservlet%2FSearchResults%3Fkn%3D9780321336781%26sortby%3D3%26sts%3Dt%26x%3D74%26y%3D19">abe&thinsp;books.de</a></td>
<td><a class="plain" rel="nofollow" href="http://www.jdoqocy.com/click-2358048-10437934?url=http%3A%2F%2Fwww.chapters.indigo.ca%2Fbooks%2Fitem%2Fbooks-9780321336781%2F">chapters.indigo.ca</a><img class="impressioncounter" src="http://www.lduhtrp.net/image-2358048-10437934" width="1" height="1" alt="." border="0"></td>
<td class="flag"><img src="../image/flag/canada.png" alt="Canadian flag" width="50" height="25" border="0"></td></tr>
<tr><td class="flag"><img src="../image/flag/germany.png" alt="German flag" width="50" height="30" border="0"></td>
<td><a class="plain" rel="nofollow" href="http://www.amazon.de/gp/product/032133678X?ie=UTF8&amp;tag=canadianmin0b-21&amp;linkCode=as2&amp;camp=1638&amp;creative=6742&amp;creativeASIN=032133678X">amazon.de</a><img class="impressioncounter" src="http://www.assoc-amazon.de/e/ir?t=canadianmin0b-21&amp;l=as&amp;o=3&amp;a=032133678X" width="1" height="1" alt="." border="0"></td>
<td><a class="plain" rel="nofollow" href="http://clickserve.cc-dt.com/link/tplclick?lid=41000000024289215&amp;pubid=21000000000049036&amp;redirect=http%3A%2F%2Fwww.abebooks.com%2Fservlet%2FSearchResults%3Fbi%3D0%26bx%3Doff%26ds%3D30%26isbn%3D9780321336781%26sortby%3D2%26x%3D47%26y%3D11">abe&thinsp;books.com</a></td>
<td class="flag"><img src="../image/flag/usa.png" alt="American flag" width="50" height="26" border="0"></td></tr>
<tr><td class="flag"><img src="../image/flag/france.png" alt="French flag" width="50" height="33" border="0"></td>
<td><a class="plain" rel="nofollow" href="http://clickserve.cc-dt.com/link/tplclick?lid=41000000024289215&amp;pubid=21000000000049036&amp;redirect=http%3A%2F%2Fwww.abebooks.fr%2Fservlet%2FSearchResults%3Fkn%3D9780321336781%26sortby%3D3%26sts%3Dt%26x%3D0%26y%3D0">abe&thinsp;books.fr</a></td>
<td><a class="plain" rel="nofollow" href="http://www.amazon.com/gp/product/032133678X?ie=UTF8&amp;tag=canadianmindprod&amp;linkCode=as2&amp;camp=1789&amp;creative=9325&amp;creativeASIN=032133678X">amazon.com</a><img class="impressioncounter" src="http://www.assoc-amazon.com/e/ir?t=canadianmindprod&amp;l=as&amp;o=1&amp;a=032133678X" width="1" height="1" alt="." border="0"></td>
<td class="flag"><img src="../image/flag/usa.png" alt="American flag" width="50" height="26" border="0"></td></tr>
<tr><td class="flag"><img src="../image/flag/france.png" alt="French flag" width="50" height="33" border="0"></td>
<td><a class="plain" rel="nofollow" href="http://www.amazon.fr/gp/product/032133678X?ie=UTF8&amp;tag=canamindprod-21&amp;linkCode=as2&amp;camp=1624&amp;creative=6746&amp;creativeASIN=032133678X">amazon.fr</a><img class="impressioncounter" src="http://www.assoc-amazon.fr/e/ir?t=canamindprod-21&amp;l=as&amp;o=8&amp;a=032133678X" width="1" height="1" alt="." border="0"></td>
<td><a class="plain" rel="nofollow" href="http://search.barnesandnoble.com/booksearch/isbninquiry.asp?isbn=9780321336781&amp;lkid=J12871747&amp;pubid=K49036">barnes&thinsp;and&thinsp;noble.com</a></td>
<td class="flag"><img src="../image/flag/usa.png" alt="American flag" width="50" height="26" border="0"></td></tr>
<tr><td class="flag"><img src="../image/flag/italy.png" alt="Italian flag" width="50" height="33" border="0"></td>
<td><a class="plain" rel="nofollow" href="http://clickserve.cc-dt.com/link/tplclick?lid=41000000024289215&amp;pubid=21000000000049036&amp;redirect=http%3A%2F%2Fwww.abebooks.it%2Fservlet%2FSearchResults%3Fkn%3D9780321336781%26sortby%3D3%26sts%3Dt%26x%3D79%26y%3D11">abe&thinsp;books.it</a></td>
<td><a class="plain" rel="nofollow" href="http://www.powells.com/partner/28995/biblio/9780321336781" target="_top">powells.com</a></td>
<td class="flag"><img src="../image/flag/usa.png" alt="American flag" width="50" height="26" border="0"></td></tr>
<tr><td class="flag"><img src="../image/flag/spain.png" alt="Spanish flag" width="50" height="33" border="0"></td>
<td><a class="plain" rel="nofollow" href="http://clickserve.cc-dt.com/link/tplclick?lid=41000000024289215&amp;pubid=21000000000049036&amp;redirect=http%3A%2F%2Fwww.iberlibro.com%2Fservlet%2FSearchResults%3Fkn%3D9780321336781%26sortby%3D3%26sts%3Dt%26x%3D0%26y%3D0">iberlibro.com</a></td>
<td><a class="plain" rel="nofollow" href="http://ebookstore.sony.com/search?keyword=032133678X&amp;x=0&amp;y=0">sony e-books</a></td>
<td class="flag"><img src="../image/flag/usa.png" alt="American flag" width="50" height="26" border="0"></td></tr>
<tr><td class="flag"><img src="../image/flag/australia.png" alt="Australian flag" width="50" height="25" border="0"></td>
<td><a class="plain" href="http://clickserve.cc-dt.com/link/tplclick?lid=41000000024289215&amp;pubid=21000000000049036&amp;redirect=http%3A%2F%2Fwww.abebooks.com%2Fservlet%2FSearchResults%3Ffromanz%3Dfromanz%26isbn%3D9780321336781%26sortby%3D93%26sts%3Dt%26x%3D48%26y%3D17">abe&thinsp;books anz</a></td>
<td></td><td></td></tr></tbody></table></td></tr></tbody></table>
<!-- end Book referral for Java &trade; Puzzlers : Traps, Pitfalls, and Corner Cases --><!-- /generated by Book -->
<div class="see"><a href="array.html#ARRAYCOMPAREGOTCHAS">Array Comparison</a><br>
<a href="array.html#ARRAYINITGOTCHAS">Array Initialisation</a><br>
<a href="array.html#ARRAYSTOREEXCEPTION">ArrayStoreException</a> arrays of Dogs and Dalmatians<br>
<a href="computergripes.html">computer gripes</a><br>
<a href="date.html#DATEGOTCHAS">Date gotchas</a><br>
<a href="floatingpoint.html">floating point gotchas</a><br>
<a href="gregoriancalendar.html#GREGORIANCALENDARGOTCHAS">Gregorian Calendar gotchas</a><br>
<a href="inconsistencies.html">inconsistencies</a><br>
<a href="keystroke.html#KEYSTROKENAMEGOTCHAS">Keystroke Name gotchas</a><br>
<a href="array.html#MATRIXGOTCHAS">Matrix Initialisation</a><br>
<a href="pseudorandom.html#PSEDORANDOM">pseudo-random numbers</a><br>
<a href="shift.html#SHIFTLESSHIFT">shiftless shift</a><br>
<a href="string.html#COMPARISON">String Comparison</a></div>
</dd>
</dl>
<!-- macro Foot nonmil --><!-- generated --><a name="BOTTOM"></a>
<hr class="foot">
<table class="borderless" summary="standard footer"><tbody><tr><td align="center" valign="top" rowspan="2"><a class="plain" href="../index.html#TITLE" target="_top"><img src="../image/navigate/home.png" alt="CMP home" width="24" height="24" align="middle" border="0"></a><a class="plain" href="#TOP"><img src="../image/navigate/totop.png" alt="jump to top" width="24" height="24" align="middle" border="0"></a></td>
<td valign="top"><span class="unobtrusive">You can get the freshest copy of this page from:</span></td>
<td valign="top"><span class="unobtrusive">or possibly from your local <a class="plain" href="jdrive.html"><span class="drive">J:</span> drive</a> (Java virtual drive/mindprod.com website mirror)</span></td></tr>
<tr><td valign="top"><a class="url" href="http://mindprod.com/jgloss/gotchas.html">http://mindprod.com/jgloss/gotchas.html</a></td>
<td valign="top"><a class="url" href="file:///J:/mindprod/jgloss/gotchas.html">J:\mindprod\jgloss\gotchas.html</a></td></tr><tr><td rowspan="3"><a class="plain" href="../index.html#TITLE" target="_top"><img src="../image/logo/cmpmartylogomid.png" alt="CMP logo" width="89" height="113" align="middle" border="0"></a></td><td colspan="2"><span class="pleasefeedback"><a class="plain" href="../feedback/feedback.html"><img src="../image/navigate/feedback.png" alt="feedback" width="24" height="24" align="middle" border="0"></a>&nbsp;Please email your <a class="plain" href="../feedback/feedback.html">feedback for publication</a>, errors, omissions, typos, formatting errors, ambiguities, unclear wording, broken/redirected link reports, suggestions to improve this page or comments to
<a class="plain" href="../contact/contact.html">Roedy Green</a> :
<img class="mailto" src="../image/mailto/feedback.png" alt="feedback email" width="209" height="22" border="0"></span></td></tr>
<tr><td><span class="cmplogo"><span class="cmplogocaps">C</span>anadian <span class="cmplogocaps">M</span>ind <span class="cmplogocaps">P</span>roducts</span></td>
<td valign="top" rowspan="3"><span class="adfoot"><script type="text/javascript"><!--
google_ad_client="pub-3625079171090429";
google_ad_width=468;
google_ad_height=60;
google_ad_format="468x60_as";
google_ad_type = "text_image";
google_ad_channel="";
google_color_border = "336699";
google_color_bg = "ffffff";
google_color_link = "0000ff";
google_color_url = "008000";
google_color_text = "000000";
// --></script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></span></td></tr>
<tr><td><span class="domain">mindprod.com</span> IP:[<span class="ip">65.110.21.43</span>]</td></tr>
<tr><td valign="top" align="center">view <a class="blogger" href="http://newbiejava.blogspot.com">Blog</a></td><td valign="top">Your face IP:[<span class="ip">128.195.58.124</span>]</td></tr>
<tr><td valign="top" align="center"><a class="feedback" href="../feedback/feedback.html">Feedback</a></td><td valign="top"><span class="unobtrusive">You are visitor number</span>
<span class="hitcount">476,940</span>.</td><td valign="top"><iframe src="foot/gotchas.html" height="300" width="600" scrolling="auto" frameborder="0"></iframe></td></tr></tbody></table></body></html>
<!-- /generated by Foot -->

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-US">

<head profile="http://gmpg.org/xfn/11">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<title>Import a Private Key Into A Java Keystore &laquo;  neal groothuis</title>

<link rel="stylesheet" href="http://www.nealgroothuis.name/wp-content/themes/default/style.css" type="text/css" media="screen" />
<link rel="alternate" type="application/rss+xml" title="neal groothuis RSS Feed" href="http://www.nealgroothuis.name/?feed=rss2" />
<link rel="alternate" type="application/atom+xml" title="neal groothuis Atom Feed" href="http://www.nealgroothuis.name/?feed=atom" />
<link rel="pingback" href="http://www.nealgroothuis.name/xmlrpc.php" />

<style type="text/css" media="screen">

	#page { background: url("http://www.nealgroothuis.name/wp-content/themes/default/images/kubrickbgwide.jpg") repeat-y top; border: none; }

</style>


<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://www.nealgroothuis.name/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://www.nealgroothuis.name/wp-includes/wlwmanifest.xml" /> 
<script type='text/javascript' src='http://www.nealgroothuis.name/wp-includes/js/comment-reply.js?ver=20081210'></script>
<meta name="generator" content="WordPress 2.7" />

</head>
<body>
<div id="page">


<div id="header">
	<div id="headerimg">
		<h1><a href="http://www.nealgroothuis.name/">neal groothuis</a></h1>
		<div class="description">overcaffeinated and ready to dance</div>
	</div>
</div>
<hr />

	<div id="content" class="narrowcolumn">

				<div class="post" id="post-28">
		<h2>Import a Private Key Into A Java Keystore</h2>
			<div class="entry">
				<p>This program will import a private key and associated certficate chain into a Java keystore.  Usage is as follows:</p>
<p>java KeyStoreImport <var>keystoreFile</var> <var>certificateFile</var> <var>keyFile</var>        <var>alias</var></p>
<dl>
<dt><var>keyStoreFile</var></dt>
<dd>The file containing the Java keystore</dd>
<dt><var>certificateFile</var></dt>
<dd>A file containing a chain of concatenated DER-encoded X.509 certificates</dd>
<dt><var>keyFile</var></dt>
<dd>A file containing a DER-encoded PKCS#8 RSA private key</dd>
<dt><var>alias</var></dt>
<dd>Alias for the private key and certificate chain in the keystore</dd>
</dl>
<p>Note that the OpenSSL tools may be of help in getting certificates from whatever form you presently have them in into the encodings required by the program.</p>
<pre>//
// KeyStoreImport.java
//
// Adds a specified certificate chain and associated RSA private key
// to a Java keystore.
//
// Usage: java KeyStoreImport KEYSTORE CERTS KEY ALIAS
//
//              KEYSTORE is the name of the file containing the Java keystore
//              CERTS is the name of a file containing a chain of concatenated
//                      DER-encoded X.509 certificates
//              KEY is the name of a file containing a DER-encoded PKCS#8 RSA
//                      private key
//              ALIAS is the alias for the private key entry in the keystore
//
// Ã?Â©Neal Groothuis
// 2006-08-08
//
// This program is free software; you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation; either version 2 of the License, or
// (at your option) any later version.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License
// along with this program; if not, write to the Free Software
// Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
//
import java.security.*;
import java.security.spec.*;
import java.security.cert.*;
import java.io.*;
import java.util.*;

public class KeyStoreImport {

public static void main(String args[]) {
try {
// Meaningful variable names for the arguments
String keyStoreFileName = args[0];
String certificateChainFileName = args[1];
String privateKeyFileName = args[2];
String entryAlias = args[3];

// Get the password for the keystore.
System.out.println("Keystore password:  ");

String keyStorePassword = (new BufferedReader(
new InputStreamReader(System.in))).readLine();

// Load the keystore
KeyStore keyStore = KeyStore.getInstance("jks");
FileInputStream keyStoreInputStream =
new FileInputStream(keyStoreFileName);
keyStore.load(keyStoreInputStream, keyStorePassword.toCharArray());
keyStoreInputStream.close();

// Load the certificate chain (in X.509 DER encoding).
FileInputStream certificateStream =
new FileInputStream(certificateChainFileName);
CertificateFactory certificateFactory =
CertificateFactory.getInstance("X.509");
// Required because Java is STUPID.  You can't just cast the result
// of toArray to Certificate[].
java.security.cert.Certificate[] chain = {};
chain = certificateFactory.generateCertificates(certificateStream).toArray(chain);
certificateStream.close();

// Load the private key (in PKCS#8 DER encoding).
File keyFile = new File(privateKeyFileName);
byte[] encodedKey = new byte[(int)keyFile.length()];
FileInputStream keyInputStream = new FileInputStream(keyFile);
keyInputStream.read(encodedKey);
keyInputStream.close();
KeyFactory rSAKeyFactory = KeyFactory.getInstance("RSA");
PrivateKey privateKey = rSAKeyFactory.generatePrivate(
new PKCS8EncodedKeySpec(encodedKey));

// Add the new entry
System.out.println("Private key entry password:  ");

String privateKeyEntryPassword = (new BufferedReader(
new InputStreamReader(System.in))).readLine();
keyStore.setEntry(entryAlias,
new KeyStore.PrivateKeyEntry(privateKey, chain),
new KeyStore.PasswordProtection(privateKeyEntryPassword.toCharArray())
);

// Write out the keystore
FileOutputStream keyStoreOutputStream =
new FileOutputStream(keyStoreFileName);
keyStore.store(keyStoreOutputStream, keyStorePassword.toCharArray());
keyStoreOutputStream.close();
}

catch (Exception e) {
e.printStackTrace();
System.exit(1);
}
}
}</pre>

				
			</div>
		</div>
				</div>

	<div id="sidebar">
		<ul>
						<li>
				<form method="get" id="searchform" action="http://www.nealgroothuis.name/" >
	<label class="hidden" for="s">Search for:</label>
	<div><input type="text" value="" name="s" id="s" />
	<input type="submit" id="searchsubmit" value="Search" />
	</div>
	</form>			</li>

			<!-- Author information is disabled per default. Uncomment and fill in your details if you want to use it.
			<li><h2>Author</h2>
			<p>A little something about you, the author. Nothing lengthy, just an overview.</p>
			</li>
			-->

			
			<li class="pagenav"><h2>Pages</h2><ul><li class="page_item page-item-9"><a href="http://www.nealgroothuis.name/?page_id=9" title="Dean Collins Shim Sham">Dean Collins Shim Sham</a></li>
<li class="page_item page-item-13"><a href="http://www.nealgroothuis.name/?page_id=13" title="Fedora Kickstart">Fedora Kickstart</a>
<ul>
	<li class="page_item page-item-27"><a href="http://www.nealgroothuis.name/?page_id=27" title="KickStart Config File Commands">KickStart Config File Commands</a></li>
	<li class="page_item page-item-14"><a href="http://www.nealgroothuis.name/?page_id=14" title="Specifying a Kickstart File">Specifying a Kickstart File</a></li>
</ul>
</li>
<li class="page_item page-item-28 current_page_item"><a href="http://www.nealgroothuis.name/?page_id=28" title="Import a Private Key Into A Java Keystore">Import a Private Key Into A Java Keystore</a></li>
<li class="page_item page-item-67"><a href="http://www.nealgroothuis.name/?page_id=67" title="Introduction to Data Types and Objects in R">Introduction to Data Types and Objects in R</a></li>
<li class="page_item page-item-23"><a href="http://www.nealgroothuis.name/?page_id=23" title="RÃ©sumÃ©">RÃ©sumÃ©</a></li>
</ul></li>
			<li><h2>Archives</h2>
				<ul>
					<li><a href='http://www.nealgroothuis.name/?m=200910' title='October 2009'>October 2009</a></li>
	<li><a href='http://www.nealgroothuis.name/?m=200904' title='April 2009'>April 2009</a></li>
	<li><a href='http://www.nealgroothuis.name/?m=200903' title='March 2009'>March 2009</a></li>
	<li><a href='http://www.nealgroothuis.name/?m=200902' title='February 2009'>February 2009</a></li>
	<li><a href='http://www.nealgroothuis.name/?m=200901' title='January 2009'>January 2009</a></li>
	<li><a href='http://www.nealgroothuis.name/?m=200810' title='October 2008'>October 2008</a></li>
	<li><a href='http://www.nealgroothuis.name/?m=200809' title='September 2008'>September 2008</a></li>
	<li><a href='http://www.nealgroothuis.name/?m=200808' title='August 2008'>August 2008</a></li>
	<li><a href='http://www.nealgroothuis.name/?m=200807' title='July 2008'>July 2008</a></li>
	<li><a href='http://www.nealgroothuis.name/?m=200806' title='June 2008'>June 2008</a></li>
	<li><a href='http://www.nealgroothuis.name/?m=200804' title='April 2008'>April 2008</a></li>
	<li><a href='http://www.nealgroothuis.name/?m=200802' title='February 2008'>February 2008</a></li>
	<li><a href='http://www.nealgroothuis.name/?m=200712' title='December 2007'>December 2007</a></li>
	<li><a href='http://www.nealgroothuis.name/?m=200708' title='August 2007'>August 2007</a></li>
	<li><a href='http://www.nealgroothuis.name/?m=200707' title='July 2007'>July 2007</a></li>
	<li><a href='http://www.nealgroothuis.name/?m=200705' title='May 2007'>May 2007</a></li>
	<li><a href='http://www.nealgroothuis.name/?m=200704' title='April 2007'>April 2007</a></li>
	<li><a href='http://www.nealgroothuis.name/?m=200701' title='January 2007'>January 2007</a></li>
	<li><a href='http://www.nealgroothuis.name/?m=200612' title='December 2006'>December 2006</a></li>
	<li><a href='http://www.nealgroothuis.name/?m=200610' title='October 2006'>October 2006</a></li>
	<li><a href='http://www.nealgroothuis.name/?m=200608' title='August 2006'>August 2006</a></li>
	<li><a href='http://www.nealgroothuis.name/?m=200606' title='June 2006'>June 2006</a></li>
	<li><a href='http://www.nealgroothuis.name/?m=200605' title='May 2006'>May 2006</a></li>
	<li><a href='http://www.nealgroothuis.name/?m=200604' title='April 2006'>April 2006</a></li>
	<li><a href='http://www.nealgroothuis.name/?m=200603' title='March 2006'>March 2006</a></li>
				</ul>
			</li>

			<li class="categories"><h2>Categories</h2><ul>	<li class="cat-item cat-item-3"><a href="http://www.nealgroothuis.name/?cat=3" title="View all posts filed under Coffee">Coffee</a> (2)
</li>
	<li class="cat-item cat-item-4"><a href="http://www.nealgroothuis.name/?cat=4" title="View all posts filed under Computers">Computers</a> (21)
</li>
	<li class="cat-item cat-item-5"><a href="http://www.nealgroothuis.name/?cat=5" title="View all posts filed under Music">Music</a> (2)
</li>
	<li class="cat-item cat-item-2"><a href="http://www.nealgroothuis.name/?cat=2" title="View all posts filed under Swing Dancing">Swing Dancing</a> (1)
</li>
	<li class="cat-item cat-item-1"><a href="http://www.nealgroothuis.name/?cat=1" title="View all posts filed under Uncategorized">Uncategorized</a> (31)
</li>
</ul></li>
							<li id="linkcat-7" class="linkcat"><h2>Friends</h2>
	<ul class='xoxo blogroll'>
<li><a href="http://emilydewan.blogspot.com" rel="friend met neighbor date">Emily DeWan</a></li>
<li><a href="http://luvs-chicago.livejournal.com/" rel="friend met">Karen Tompkins</a></li>
<li><a href="http://misterblob.blogspot.com/">Mr. Blob</a></li>
<li><a href="http://www.thegio.net/London/blogger.html" rel="friend met">Ryan Giordano</a></li>
<li><a href="http://blog.truegeek.org/" rel="friend met co-worker">Scott Swanson</a></li>

	</ul>
</li>
<li id="linkcat-6" class="linkcat"><h2>Me</h2>
	<ul class='xoxo blogroll'>
<li><a href="http://www.nealgroothuis.com/gallery2" rel="me">Photo Gallery</a></li>

	</ul>
</li>
<li id="linkcat-2" class="linkcat"><h2>Swing Dancing</h2>
	<ul class='xoxo blogroll'>
<li><a href="http://www.lindysynergy.com/" rel="acquaintance met">Lindy Synergy</a></li>
<li><a href="http://www.windyhop.org/">Windyhop</a></li>
<li><a href="http://www.yehoodi.com/" title="New York City and national swing dancing calendars and discussion">Yehoodi</a></li>

	</ul>
</li>

				<li><h2>Meta</h2>
				<ul>
										<li><a href="http://www.nealgroothuis.name/wp-login.php">Log in</a></li>
					<li><a href="http://validator.w3.org/check/referer" title="This page validates as XHTML 1.0 Transitional">Valid <abbr title="eXtensible HyperText Markup Language">XHTML</abbr></a></li>
					<li><a href="http://gmpg.org/xfn/"><abbr title="XHTML Friends Network">XFN</abbr></a></li>
					<li><a href="http://wordpress.org/" title="Powered by WordPress, state-of-the-art semantic personal publishing platform.">WordPress</a></li>
									</ul>
				</li>
			
					</ul>
	</div>



<hr />
<div id="footer">
<!-- If you'd like to support WordPress, having the "powered by" link somewhere on your blog is the best way; it's our only promotion or advertising. -->
	<p>
		neal groothuis is proudly powered by
		<a href="http://wordpress.org/">WordPress</a>
		<br /><a href="http://www.nealgroothuis.name/?feed=rss2">Entries (RSS)</a>
		and <a href="http://www.nealgroothuis.name/?feed=comments-rss2">Comments (RSS)</a>.
		<!-- 21 queries. 0.352 seconds. -->
	</p>
</div>
</div>

<!-- Gorgeous design by Michael Heilemann - http://binarybonsai.com/kubrick/ -->

		</body>
</html>

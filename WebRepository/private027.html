
 

 







<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" class="regenabled gecko jsenabled gecko jsenabled"><head>

<meta http-equiv="Content-type" content="text/html; charset=UTF-8">
<title>Cryptography - How to load an RSA private key from a file? [Locked]</title>
<link rel="stylesheet" type="text/css" href="/style/style.css"/>
<link rel="stylesheet" type="text/css" href="/css/default.css">
<link rel="stylesheet" href="/css/default_developer.css" />
<link href="css/sr.css" rel="stylesheet" type="text/css">
<script language="javascript1.2" type="text/javascript" src="/js/sniff.js"></script>


</head><body>

<table width="100%">
<tr>
<td>
<!-- BEGIN A2 COMPONENT V.8 -->
<div id="a2v8" class="a2v8forums">
<div class="a2v8w1"><div class="a2v8w2"><div class="a2v8w3">

<ul class="a2v8links">
<li class="a2v8sunlogo"><a href="http://www.sun.com/" title="www.sun.com"><span>Sun.com</span></a></li>
<li><a href="http://forums.sun.com/" title="forums.sun.com"><span>forums.sun.com</span></a></li>
</ul>

<h3 class="listTitle">participate</h3>
<form action=""><select class="goto"><option value="" class="gotoHeading">participate</option>

<option value="http://wikis.sun.com/">wikis</option><option value="http://blogs.sun.com/">blogs</option><option value="http://planets.sun.com/">planets</option><option value="http://forums.sun.com/">forums</option><option value="http://mediacast.sun.com/">mediacast</option></select></form>

<div class="a2v8x1"></div>
</div></div></div>
</div>
<!-- END A2 COMPONENT V.8 -->

</td>
</tr>
</table>

<!-- BEGIN breadcrumbs -->
           <div class="breadcrumb">
            
                    <nobr><a href="http://forums.sun.com">Oracle Forums</a> &gt;</nobr>

            
                                    <nobr><a href="category.jspa?categoryID=15">Security</a> &gt;</nobr>
            
                                    <nobr><a href="forum.jspa?forumID=9&start=0">Cryptography</a> &gt;</nobr>
            
            </div>

<!-- END breadcrumbs -->
    
<br>
 <div class="pagetitle">Cryptography - How to load an RSA private key from a file? [Locked]</div>






<table width="100%" cellpadding="0" cellspacing="0"> <!-- CONTENT & NAV TABLE --> 
<tbody><tr>

<td valign="top"> <!-- MAIN CONTENT -->
<!--startindex-->
<!-- BEGIN WRAPPER TABLE, 1 COLUMN, MAIN -->
<table border="0" cellpadding="0" cellspacing="10" width="100%">
<tr><td width="100%" valign="top">

<link rel="alternate" type="application/rss+xml" title="RSS Summary Feed"
        href="http://forums.sun.com/rss/rssmessages.jspa?threadID=5175986">

    <link rel="alternate" type="application/rss+xml" title="RSS Full Feed"
        href="http://forums.sun.com/rss/rssmessages.jspa?threadID=5175986&full=true">






<!-- BEGIN MAIN CONTENT -->

<table border="0" cellpadding="4" cellspacing="0" width="100%" class="vtop">
<tr>
<td>





    <div id="jive-question-box" class="jive-infobox">
    <table cellpadding="2" cellspacing="0" border="0">
    <tbody>
        
        <tr valign="top">

            <td><img src="images/lock-16x16.gif" alt="" border="0"></td>
            <td> This topic is locked </td>
        </tr>
       </tr>
    </tbody>
    </table>
    </div>

 
</td>
</tr>

<tr>
<td>

</td>
</tr>

<tr>
<td>
<a href="forum.jspa?forumID=9"><< &nbsp; Back to Forum</a>
&nbsp;| &nbsp; <a href="http://developers.sun.com/contact/feedback.jsp?referer=http://forums.sun.com?forumID=9&category=sdn&mailsubject=Forums%20or%20Community">Give us Feedback </a>
</td>

<td align="right">
 <!--  BEGIN VTI2 PAGINATION COMPONENT, variation 2 without number links -->

            

    <!--  END VTI2 PAGINATION COMPONENT, variation 2 without number links -->

</td>

</tr>
</table>

<!-- BEGIN G15 GENERIC CONTENT TABLE -->
<table border="0" cellpadding="4" cellspacing="0" width="100%" class="vtop" bgcolor="#666666"><tr><td>
<table border="0" cellpadding="2" cellspacing="0" width="100%" class="vtop">

<tr bgcolor="#666666">

<!-- BEGIN DUKE DOLLARS -->
<td colspan="2">
<table width="100%" border="0">
<tr>
<td><div class="pad5x10"><span style="color:#fff;">
        



</span></div>
</td>

<td align="right"><div class="pad5x10"><span style="color:#fff;">
 
                This topic has
                7
                replies
                on
                1
                page.

            

            
</span></div></td>

</tr>
</table>
</td>
</tr>


<tr bgcolor="#666666">
<td colspan="2" align="right"><div class="pad5x10"><span style="color:#fff;">

	<!-- BEGIN  Move Ability for moderators -->

           
	<!-- END move ability for moderators -->

   	<img src="im/ic_email.gif" width="14" height="12" border="0" hspace="4" vspace="1" alt=" "><a href="emailfriend!default.jspa?threadID=5175986"><font color="#ffffff">E-mail this Topic</font></a> &nbsp;
        
	<img src="im/ic_eye.gif" hspace="4" border="0" alt=" " />

      <a href="watches!add.jspa?forumID=9&threadID=5175986"><font color="#ffffff">Watch this topic</font></a>
      &nbsp;

</span></div></td>

</tr>




    <div class="jive-message-list">

    













<tr bgcolor="#eeeeee">
	<td width="20%" nowrap="nowrap">
	<div class="pad5x10">
	   <img src="im/bronze-star.gif"
		title="Dukes Earned 0" />  
	  
	 
	

	<a href="profile.jspa?userID=922998"">jgalzic</a>

	   <br />
	 Posts:3
	<br />
	Registered: 5/23/07
	
	</div>
	</td>

	<!-- END Author Name or Guest -->

	<td width="60%">
	<div class="pad5x10"><b><a name="9680174"></a>  How to load an RSA private key from a file?
	  &nbsp;&nbsp;  <br />

	  <a
		href="thread.jspa?messageID=9680174#9680174">
	May 23, 2007 9:53 PM </a> 


	 </b> 

		

	 <br />


	<!-- start tags stuff -->  
	</div>
	</td>
	<!-- END Subject -->


	<td align="right" nowrap="nowrap" width="20%">
	<div class="pad5x10">
	 <a
		href="emailmessage!default.jspa?messageID=9680174"
		title="Click to email this message" /> <img src="im/ic_email.gif"
		width="14" height="12" border="0" hspace="4" vspace="1"
		alt="Click to email this message" /></a> 
	   <br>
	<br>
	   <br>
	<br>
	<!--
    <a href="javascript:void(0)" onclick="window.open('unfiltered.jspa?messageID=9680174', 'Welcome', 'width=500, height=500, menubar=yes, scrollbars=yes')">View Unfiltered</a>
--></div>
	</td>
	<!-- END REPLY Button -->

</tr>
<!-- END Heading Row -->

<!-- Begin message row -->
<tr class="white">

	<td>
	<div class="pad5x10">&nbsp;</div>
	</td>
	<td>
	<div class="pad5x10">
	 Hi,<br />
I'm a newbie in regards to the Security APIs and I have need to have an instance of 'PrivateKey' passed off to an library I'm working with (GData to be specific). <br />
<br />
My public key was generated with OpenSSL and is a 1024-bit RSA key encoded in an X.509 certificate in PEM format. I also have my private key in a separate file and I would like to load the private key from that file and have it converted into correct instance of 'PrivateKey'. Can some one point in a general direction on how I would accomplish this? <br />
<br />
Any help would be appreciated.<br />
<br />
Thanks,<br />
Justin 
	</div>
	</td>
	<td>
	<div class="pad5x10">&nbsp;</div>
	</td>
</tr>



    </div>


    <div class="jive-message-list">

    













<tr bgcolor="#eeeeee">
	<td width="20%" nowrap="nowrap">
	<div class="pad5x10">
	   <img src="im/platinum-star.gif"
		title="Dukes Earned 2199" />  
	    
	 
	

	<a href="profile.jspa?userID=106725"">sabre150</a>

	   <br />
	 Posts:21,999
	<br />
	Registered: 24/10/97
	
	</div>
	</td>

	<!-- END Author Name or Guest -->

	<td width="60%">
	<div class="pad5x10"><b><a name="9680445"></a>  Re: How to load an RSA private key from a file?
	  &nbsp;&nbsp;  <br />

	  <a
		href="thread.jspa?messageID=9680445#9680445">
	May 24, 2007 8:57 AM </a> 


	 (reply 1
	of 7) &nbsp;(In reply to <a
		href="thread.jspa?messageID=9680174#9680174">
	
	original post</a> )   </b> 

		

	 <br />


	<!-- start tags stuff -->  
	</div>
	</td>
	<!-- END Subject -->


	<td align="right" nowrap="nowrap" width="20%">
	<div class="pad5x10">
	 <a
		href="emailmessage!default.jspa?messageID=9680445"
		title="Click to email this message" /> <img src="im/ic_email.gif"
		width="14" height="12" border="0" hspace="4" vspace="1"
		alt="Click to email this message" /></a> 
	   <br>
	<br>
	   <br>
	<br>
	<!--
    <a href="javascript:void(0)" onclick="window.open('unfiltered.jspa?messageID=9680445', 'Welcome', 'width=500, height=500, menubar=yes, scrollbars=yes')">View Unfiltered</a>
--></div>
	</td>
	<!-- END REPLY Button -->

</tr>
<!-- END Heading Row -->

<!-- Begin message row -->
<tr class="white">

	<td>
	<div class="pad5x10">&nbsp;</div>
	</td>
	<td>
	<div class="pad5x10">
	 <pre class="jive-pre"><code class="jive-code jive-java">           File pubKeyFile = ...
           File privKeyFile = ...
&nbsp;
           <font color="darkgreen">// read public key DER file</font>
            DataInputStream dis = <font color="navy"><b>new</b></font> DataInputStream(<font color="navy"><b>new</b></font> FileInputStream(pubKeyFile));
            <font color="navy"><b>byte</b></font>[] pubKeyBytes = <font color="navy"><b>new</b></font> <font color="navy"><b>byte</b></font>[(<font color="navy"><b>int</b></font>)pubKeyFile.length()];
            dis.readFully(pubKeyBytes);
            dis.close();
            
            <font color="darkgreen">// read private key DER file</font>
            dis = <font color="navy"><b>new</b></font> DataInputStream(<font color="navy"><b>new</b></font> FileInputStream(privKeyFile));
            <font color="navy"><b>byte</b></font>[] privKeyBytes = <font color="navy"><b>new</b></font> <font color="navy"><b>byte</b></font>[(<font color="navy"><b>int</b></font>)privKeyFile.length()];
            dis.read(privKeyBytes);
            dis.close();
            
            KeyFactory keyFactory = KeyFactory.getInstance(<font color="red">&quot;RSA&quot;</font>);
            
            <font color="darkgreen">// decode public key</font>
            X509EncodedKeySpec pubSpec = <font color="navy"><b>new</b></font> X509EncodedKeySpec(pubKeyBytes);
            RSAPublicKey pubKey = (RSAPublicKey) keyFactory.generatePublic(pubSpec);
            
            <font color="darkgreen">// decode private key</font>
            PKCS8EncodedKeySpec privSpec = <font color="navy"><b>new</b></font> PKCS8EncodedKeySpec(privKeyBytes);
            RSAPrivateKey privKey = (RSAPrivateKey) keyFactory.generatePrivate(privSpec);
        
</code></pre><br />
<br />
Message was edited by: <br />
        sabre150 
	</div>
	</td>
	<td>
	<div class="pad5x10">&nbsp;</div>
	</td>
</tr>



    </div>


    <div class="jive-message-list">

    













<tr bgcolor="#eeeeee">
	<td width="20%" nowrap="nowrap">
	<div class="pad5x10">
	   <img src="im/bronze-star.gif"
		title="Dukes Earned 0" />  
	  
	 
	

	<a href="profile.jspa?userID=922998"">jgalzic</a>

	   <br />
	 Posts:3
	<br />
	Registered: 5/23/07
	
	</div>
	</td>

	<!-- END Author Name or Guest -->

	<td width="60%">
	<div class="pad5x10"><b><a name="9682061"></a>  Re: How to load an RSA private key from a file?
	  &nbsp;&nbsp;  <br />

	  <a
		href="thread.jspa?messageID=9682061#9682061">
	May 24, 2007 2:13 PM </a> 


	 (reply 2
	of 7) &nbsp;(In reply to <a
		href="thread.jspa?messageID=9680445#9680445">
	 #1 </a> )   </b> 

		

	 <br />


	<!-- start tags stuff -->  
	</div>
	</td>
	<!-- END Subject -->


	<td align="right" nowrap="nowrap" width="20%">
	<div class="pad5x10">
	 <a
		href="emailmessage!default.jspa?messageID=9682061"
		title="Click to email this message" /> <img src="im/ic_email.gif"
		width="14" height="12" border="0" hspace="4" vspace="1"
		alt="Click to email this message" /></a> 
	   <br>
	<br>
	   <br>
	<br>
	<!--
    <a href="javascript:void(0)" onclick="window.open('unfiltered.jspa?messageID=9682061', 'Welcome', 'width=500, height=500, menubar=yes, scrollbars=yes')">View Unfiltered</a>
--></div>
	</td>
	<!-- END REPLY Button -->

</tr>
<!-- END Heading Row -->

<!-- Begin message row -->
<tr class="white">

	<td>
	<div class="pad5x10">&nbsp;</div>
	</td>
	<td>
	<div class="pad5x10">
	 Thank-you for such a quick response. I tried out the code sample you suggested, however, when invoking keyFactory.generatePublic or keyFactory.generatePrivate, I get the exception:<br />
<br />
java.security.spec.InvalidKeySpecException: java.security.InvalidKeyException: invalid key format<br />
	at sun.security.rsa.RSAKeyFactory.engineGeneratePublic(RSAKeyFactory.java:163)<br />
	at java.security.KeyFactory.generatePublic(KeyFactory.java:284)<br />
<br />
What's specific about opening up a 'DER' key file versus a PEM key file? Mine is saved 'PEM' so the private key file resembles:<br />
<br />
-----BEGIN RSA PRIVATE KEY-----<br />
Proc-Type: 4,ENCRYPTED<br />
DEK-Info: DES-EDE3-CBC,3E0A8BCC9B863ECA<br />
<br />
[PRIVATE_KEY_GOES_HERE]<br />
<br />
-----END RSA PRIVATE KEY-----<br />
-----BEGIN CERTIFICATE REQUEST-----<br />
<br />
[CERTIFICATE_REQUEST_INFORMATION_GOES_HERE]<br />
<br />
-----END CERTIFICATE REQUEST-----<br />
<br />
Thanks,<br />
Justin 
	</div>
	</td>
	<td>
	<div class="pad5x10">&nbsp;</div>
	</td>
</tr>



    </div>


    <div class="jive-message-list">

    













<tr bgcolor="#eeeeee">
	<td width="20%" nowrap="nowrap">
	<div class="pad5x10">
	   <img src="im/platinum-star.gif"
		title="Dukes Earned 2199" />  
	    
	 
	

	<a href="profile.jspa?userID=106725"">sabre150</a>

	   <br />
	 Posts:21,999
	<br />
	Registered: 24/10/97
	
	</div>
	</td>

	<!-- END Author Name or Guest -->

	<td width="60%">
	<div class="pad5x10"><b><a name="9682728"></a>  Re: How to load an RSA private key from a file?
	  &nbsp;&nbsp;  <br />

	  <a
		href="thread.jspa?messageID=9682728#9682728">
	May 25, 2007 3:57 AM </a> 


	 (reply 3
	of 7) &nbsp;(In reply to <a
		href="thread.jspa?messageID=9682061#9682061">
	 #2 </a> )   </b> 

		

	 <br />


	<!-- start tags stuff -->  
	</div>
	</td>
	<!-- END Subject -->


	<td align="right" nowrap="nowrap" width="20%">
	<div class="pad5x10">
	 <a
		href="emailmessage!default.jspa?messageID=9682728"
		title="Click to email this message" /> <img src="im/ic_email.gif"
		width="14" height="12" border="0" hspace="4" vspace="1"
		alt="Click to email this message" /></a> 
	   <br>
	<br>
	   <br>
	<br>
	<!--
    <a href="javascript:void(0)" onclick="window.open('unfiltered.jspa?messageID=9682728', 'Welcome', 'width=500, height=500, menubar=yes, scrollbars=yes')">View Unfiltered</a>
--></div>
	</td>
	<!-- END REPLY Button -->

</tr>
<!-- END Heading Row -->

<!-- Begin message row -->
<tr class="white">

	<td>
	<div class="pad5x10">&nbsp;</div>
	</td>
	<td>
	<div class="pad5x10">
	 PEM files consist of a header, body and footer as ASCII characters with the body being the Base64 encoded content of the DER file. You can convert PEM to DER in two obvious ways -<br />
<br />
1) Use openssl to convert the PEM to DER using something like<pre class="jive-pre"><code class="jive-code jive-java">           openssl rsa -inform PEM -in rsapriv.pem -outform DER -pubout -out rsapub.der
           openssl pkcs8 -topk8 -inform PEM -in rsapriv.pem -outform DER -nocrypt -out rsapriv.der
</code></pre> Check the openssl 'man page' for further details. <br />
or <br />
2) Within your Java, strip the header and footer and then Base64 decode the body before using the body to create the keys.<br />
<br />
Message was edited by: <br />
        sabre150 
	</div>
	</td>
	<td>
	<div class="pad5x10">&nbsp;</div>
	</td>
</tr>



    </div>


    <div class="jive-message-list">

    













<tr bgcolor="#eeeeee">
	<td width="20%" nowrap="nowrap">
	<div class="pad5x10">
	   <img src="im/bronze-star.gif"
		title="Dukes Earned 0" />  
	  
	 
	

	<a href="profile.jspa?userID=922998"">jgalzic</a>

	   <br />
	 Posts:3
	<br />
	Registered: 5/23/07
	
	</div>
	</td>

	<!-- END Author Name or Guest -->

	<td width="60%">
	<div class="pad5x10"><b><a name="9685240"></a>  Re: How to load an RSA private key from a file?
	  &nbsp;&nbsp;  <br />

	  <a
		href="thread.jspa?messageID=9685240#9685240">
	May 27, 2007 2:52 PM </a> 


	 (reply 4
	of 7) &nbsp;(In reply to <a
		href="thread.jspa?messageID=9682728#9682728">
	 #3 </a> )   </b> 

		

	 <br />


	<!-- start tags stuff -->  
	</div>
	</td>
	<!-- END Subject -->


	<td align="right" nowrap="nowrap" width="20%">
	<div class="pad5x10">
	 <a
		href="emailmessage!default.jspa?messageID=9685240"
		title="Click to email this message" /> <img src="im/ic_email.gif"
		width="14" height="12" border="0" hspace="4" vspace="1"
		alt="Click to email this message" /></a> 
	   <br>
	<br>
	   <br>
	<br>
	<!--
    <a href="javascript:void(0)" onclick="window.open('unfiltered.jspa?messageID=9685240', 'Welcome', 'width=500, height=500, menubar=yes, scrollbars=yes')">View Unfiltered</a>
--></div>
	</td>
	<!-- END REPLY Button -->

</tr>
<!-- END Heading Row -->

<!-- Begin message row -->
<tr class="white">

	<td>
	<div class="pad5x10">&nbsp;</div>
	</td>
	<td>
	<div class="pad5x10">
	 Thank you very much -- that worked. My previous attempt of converting with openssl wasn't correct.<br />
<br />
Justin 
	</div>
	</td>
	<td>
	<div class="pad5x10">&nbsp;</div>
	</td>
</tr>



    </div>


    <div class="jive-message-list">

    













<tr bgcolor="#eeeeee">
	<td width="20%" nowrap="nowrap">
	<div class="pad5x10">
	   <img src="im/bronze-star.gif"
		title="Dukes Earned 0" />  
	  
	 
	

	<a href="profile.jspa?userID=1001110"">Digital-Signature</a>

	   <br />
	 Posts:1
	<br />
	Registered: 2/11/08
	
	</div>
	</td>

	<!-- END Author Name or Guest -->

	<td width="60%">
	<div class="pad5x10"><b><a name="10096717"></a>  Re: How to load an RSA private key from a file?
	  &nbsp;&nbsp;  <br />

	  <a
		href="thread.jspa?messageID=10096717#10096717">
	Feb 11, 2008 11:52 PM </a> 


	 (reply 5
	of 7) &nbsp;(In reply to <a
		href="thread.jspa?messageID=9685240#9685240">
	 #4 </a> )   </b> 

		

	 <br />


	<!-- start tags stuff -->  
	</div>
	</td>
	<!-- END Subject -->


	<td align="right" nowrap="nowrap" width="20%">
	<div class="pad5x10">
	 <a
		href="emailmessage!default.jspa?messageID=10096717"
		title="Click to email this message" /> <img src="im/ic_email.gif"
		width="14" height="12" border="0" hspace="4" vspace="1"
		alt="Click to email this message" /></a> 
	   <br>
	<br>
	   <br>
	<br>
	<!--
    <a href="javascript:void(0)" onclick="window.open('unfiltered.jspa?messageID=10096717', 'Welcome', 'width=500, height=500, menubar=yes, scrollbars=yes')">View Unfiltered</a>
--></div>
	</td>
	<!-- END REPLY Button -->

</tr>
<!-- END Heading Row -->

<!-- Begin message row -->
<tr class="white">

	<td>
	<div class="pad5x10">&nbsp;</div>
	</td>
	<td>
	<div class="pad5x10">
	 Dear Guys,<br />
<br />
Using Export option in IE, I have exported .PFX file with Private key and certificate. <br />
<br />
<br />
<br />
Using OpenSSL command, converted .PFX to .PEM file<br />
<br />
openssl pkcs12 -in like.pfx -out like.pem -nocerts -nodes<br />
<br />
I got the message <br />
MAC verified OK<br />
<br />
The content of like.PEM file is<br />
<br />
Bag Attributes<br />
    localKeyID: 01 00 00 00 <br />
    Microsoft CSP Name: Microsoft Enhanced Cryptographic Provider v1.0<br />
    friendlyName: 21e25e47d94303b0f4efd0be57f606a7_77d1e77a-0baf-4fae-a5f8-c9fd61669a13<br />
Key Attributes<br />
    X509v3 Key Usage: 10 <br />
-----BEGIN RSA PRIVATE KEY-----<br />
MIICXAIBAAKBgQDJutiaRQS8wDLoB1pcMfsACFSZKpYuHYBIoVRTo+yKLp9O42XT<br />
kDIVkO2B05NzgdLZPhFWCHxWau4NJbPwTqaKvQ7AmIlmWjXsEaanbG2RnJNLdWgi<br />
xLlDewH69Rt51MHiscLb8MEsa6k7TyF5fEGkV71ox3wRtLqHTWE98YPmAwIDAQAB<br />
AoGAOMEOi2h7irbwG4NmEqYlHb86PdVTZyn5m3V4CggGVmIDg+hKD5lz3clmaK4j<br />
v814ipIBwpikkpOG4cAHvcYC6GmDXT7ky691HgJjAVL0RTn7D95yWHcD6xZYD4KX<br />
vFNBp2+FOZRomwe8vJbX7l77n/uLSrvOnSnD6HZ+dCj1/sECQQDt201MkO4KR7AV<br />
N3AN7aPy+L5OJusLFkMGgyvn0NZTy+bJiPhdTHHeE3c8HM04qqBhM3NFypdFrcra<br />
WYfvBGzTAkEA2R4V70colayuAusRocn8Lpyp9NLhPAFxG/PiQkHLpMFMDyYTF+kI<br />
MJAf0/naoAg3GMmvNWvujrD1EHA5MokkEQJAf7PIUp1VUCug/CMhhDjcVyz5b5gx<br />
hWhUYAC45+MVzzOgGv/w6JaMZADreVi1TgE9zjIDZ6sXgI+IY6bB9q/XhQJBAI7o<br />
l6V8oAEMvSjckyl76sq/gbrNB0XY6RtuBvJ3nlQeizK5a/3j++kDJIABSF7nqWRe<br />
dD3kggxX+6ZLR8q0rBECQBDwHdF8DW0xECPQlLczSk1z+sUOQiONIDZ9SFz7P8q6<br />
IMUKSslXzYEMWvglhMUf0D7SCXyWwf/EEMgo+Qt9VUk=<br />
-----END RSA PRIVATE KEY-----<br />
<br />
I used the following command to convert this .PEM file .DER file<br />
<br />
openssl pkcs8 -topk8 -nocrypt -in like.pem -outform DER -out like.der<br />
<br />
I tried to generate Private Key object in Java by using the following code<br />
<br />
package com.my.pkcs7;<br />
<br />
import java.io.DataInputStream;<br />
import java.io.File;<br />
import java.io.FileInputStream;<br />
import java.io.FileNotFoundException;<br />
import java.io.IOException;<br />
import java.security.KeyFactory;<br />
import java.security.NoSuchAlgorithmException;<br />
import java.security.PrivateKey;<br />
import java.security.spec.InvalidKeySpecException;<br />
import java.security.spec.PKCS8EncodedKeySpec;<br />
<br />
public class ExtractPrivateKey {<br />
	<br />
	public static void main(String[] args) {<br />
        // read private key DER file<br />
		String privKeyFile = System.getProperty("user.home") <i> File.separator </i> "pkcs7" <i> File.separator </i> "like.der";<br />
		File file = new File(privKeyFile);<br />
		<br />
        DataInputStream dis;<br />
		try {<br />
			dis = new DataInputStream(new FileInputStream(file));<br />
		<br />
        byte[] privKeyBytes = new byte[(int)privKeyFile.length()];<br />
        dis.read(privKeyBytes);<br />
        dis.close();<br />
        <br />
        // decode private key<br />
        KeyFactory keyFactory = KeyFactory.getInstance("RSA");<br />
        PKCS8EncodedKeySpec privSpec = new PKCS8EncodedKeySpec(privKeyBytes);<br />
        System.out.println("Private Key Spec " <i> privSpec);<br />
        <br />
        PrivateKey privKey = keyFactory.generatePrivate(privSpec);<br />
        System.out.println("Private Key CONTENT:::::: " </i> privKey);<br />
                <br />
		} catch (FileNotFoundException e) {<br />
			// TODO Auto-generated catch block<br />
			e.printStackTrace();<br />
		} catch (IOException e) {<br />
			// TODO Auto-generated catch block<br />
			e.printStackTrace();<br />
		} catch (NoSuchAlgorithmException e) {<br />
			// TODO Auto-generated catch block<br />
			e.printStackTrace();<br />
		} catch (InvalidKeySpecException e) {<br />
			// TODO Auto-generated catch block<br />
			e.printStackTrace();<br />
		}<br />
	}<br />
}<br />
<br />
<br />
When I run this program I am getting the following exception<br />
<br />
Private Key Spec java.security.spec.PKCS8EncodedKeySpec@18d107f<br />
java.security.spec.InvalidKeySpecException: Unknown key spec.<br />
	at com.sun.net.ssl.internal.ssl.JS_KeyFactory.engineGeneratePrivate(Unknown Source)<br />
	at com.sun.net.ssl.internal.ssl.JSA_RSAKeyFactory.engineGeneratePrivate(Unknown Source)<br />
	at java.security.KeyFactory.generatePrivate(Unknown Source)<br />
	at com.my.pkcs7.ExtractPrivateKey.main(ExtractPrivateKey.java:37)<br />
<br />
<br />
Kindly I request you guys to give some inputs to move further on this. 
	</div>
	</td>
	<td>
	<div class="pad5x10">&nbsp;</div>
	</td>
</tr>



    </div>


    <div class="jive-message-list">

    













<tr bgcolor="#eeeeee">
	<td width="20%" nowrap="nowrap">
	<div class="pad5x10">
	   <img src="im/bronze-star.gif"
		title="Dukes Earned 0" />  
	  
	 
	

	<a href="profile.jspa?userID=1175222"">BlackV</a>

	   <br />
	 Posts:6
	<br />
	Registered: 10/28/09
	
	</div>
	</td>

	<!-- END Author Name or Guest -->

	<td width="60%">
	<div class="pad5x10"><b><a name="10850795"></a>  Re: How to load an RSA private key from a file?
	  &nbsp;&nbsp;  <br />

	  <a
		href="thread.jspa?messageID=10850795#10850795">
	Oct 28, 2009 6:33 PM </a> 


	 (reply 6
	of 7) &nbsp;(In reply to <a
		href="thread.jspa?messageID=9680445#9680445">
	 #1 </a> )   </b> 

		

	 <br />


	<!-- start tags stuff -->  
	</div>
	</td>
	<!-- END Subject -->


	<td align="right" nowrap="nowrap" width="20%">
	<div class="pad5x10">
	 <a
		href="emailmessage!default.jspa?messageID=10850795"
		title="Click to email this message" /> <img src="im/ic_email.gif"
		width="14" height="12" border="0" hspace="4" vspace="1"
		alt="Click to email this message" /></a> 
	   <br>
	<br>
	   <br>
	<br>
	<!--
    <a href="javascript:void(0)" onclick="window.open('unfiltered.jspa?messageID=10850795', 'Welcome', 'width=500, height=500, menubar=yes, scrollbars=yes')">View Unfiltered</a>
--></div>
	</td>
	<!-- END REPLY Button -->

</tr>
<!-- END Heading Row -->

<!-- Begin message row -->
<tr class="white">

	<td>
	<div class="pad5x10">&nbsp;</div>
	</td>
	<td>
	<div class="pad5x10">
	 Hi, I have a similar problem.<br />
<br />
I need to load an RSA private key in DER format from a file but, the private key is encrypted using PBE so I need to use the password to decrypt it.<br />
<br />
My first question: if I'm using PBE can I change from PEM to DER format decoding the body and deleting the footer and header from Java???<br />
My second question: how could I use the Class EncryptedPrivateKeyInfo to recover the private key using PBE?<br />
<br />
I've searched for information about this but I can't find anything useful.<br />
<br />
Thanks in advance. 
	</div>
	</td>
	<td>
	<div class="pad5x10">&nbsp;</div>
	</td>
</tr>



    </div>


    <div class="jive-message-list">

    













<tr bgcolor="#eeeeee">
	<td width="20%" nowrap="nowrap">
	<div class="pad5x10">
	   <img src="im/platinum-star.gif"
		title="Dukes Earned 1368" />  
	  
	<img src="im/moderator-16x16.gif" title="Moderator" />   
	 
	

	<a href="profile.jspa?userID=120202"">PhHein</a>

	   <br />
	 Posts:11,209
	<br />
	Registered: 16.08.01
	
	</div>
	</td>

	<!-- END Author Name or Guest -->

	<td width="60%">
	<div class="pad5x10"><b><a name="10850954"></a>  Re: How to load an RSA private key from a file?
	  &nbsp;&nbsp;  <br />

	  <a
		href="thread.jspa?messageID=10850954#10850954">
	Oct 29, 2009 1:03 AM </a> 


	 (reply 7
	of 7) &nbsp;(In reply to <a
		href="thread.jspa?messageID=10850795#10850795">
	 #6 </a> )   </b> 

		

	 <br />


	<!-- start tags stuff -->  
	</div>
	</td>
	<!-- END Subject -->


	<td align="right" nowrap="nowrap" width="20%">
	<div class="pad5x10">
	 <a
		href="emailmessage!default.jspa?messageID=10850954"
		title="Click to email this message" /> <img src="im/ic_email.gif"
		width="14" height="12" border="0" hspace="4" vspace="1"
		alt="Click to email this message" /></a> 
	   <br>
	<br>
	   <br>
	<br>
	<!--
    <a href="javascript:void(0)" onclick="window.open('unfiltered.jspa?messageID=10850954', 'Welcome', 'width=500, height=500, menubar=yes, scrollbars=yes')">View Unfiltered</a>
--></div>
	</td>
	<!-- END REPLY Button -->

</tr>
<!-- END Heading Row -->

<!-- Begin message row -->
<tr class="white">

	<td>
	<div class="pad5x10">&nbsp;</div>
	</td>
	<td>
	<div class="pad5x10">
	 Welcome to the forum. Please don't post in threads that are long dead. When you have a question, start your own topic. Feel free to provide a link to an old post that may be relevant to your problem.<br />
<br />
I'm locking this thread now. 
	</div>
	</td>
	<td>
	<div class="pad5x10">&nbsp;</div>
	</td>
</tr>



    </div>



</table>
</td></tr></table>

<table border="0" cellpadding="4" cellspacing="0" width="100%" class="vtop" bgcolor="#666666"><tr><td>
<table border="0" cellpadding="2" cellspacing="0" width="100%" class="vtop">

<tr bgcolor="#666666">

<td align="right"><div class="pad5x10"><span style="color:#fff;">
 
                This topic has
                7
                replies
                on
                1
                page.

            

            
</span></div></td>

</tr>
</table>

</td></tr></table>

<a href="forum.jspa?forumID=9">Back to Forum</a>
<br>
<span class="sp10">&#160;</span><br />
<a href="http://wikis.sun.com/display/SunForums/Sun+Forums+Code+of+Conduct">Read the Developer Forums Code of Conduct </a><br><br>
<img src="im/ic_email.gif" width="14" height="12" border="0" hspace="4" vspace="1" alt="Click to email this message"/> Email this Topic
<br>
<br>
<img src="im/edit-16x16.gif" width="16" height="16" border="0" /> Edit this Topic
<!-- END G15 GENERIC CONTENT TABLE -->

</td></tr></table>

<!--stopindex-->

</td>  <!-- END MAIN CONTENT --> 
</div> <!-- END MAIN CONTENT -->
 
<td width="170" valign="top" align="right"> <!-- RIGHT NAV -->







<!-- BEGIN AD PORTION -->

<!-- END AD PORTION -->

<table border="0" cellspacing="0" cellpadding="6">
	<tr>
		<td width="170" valign="top"><!-- BEGIN USER ALERT -->  <!-- END USER ALERT --> <!-- BEGIN E15 COMPONENT V.0 -->
		<div class="e15 e15v2">
		<div class="e15w1">
		<div class="e15w2">
		
		<h3>
		 Sun
		Forums 
		</h3>

		
		<h5>Welcome</h5>
		<ul>
			
			<li><a
				href="http://forums.sun.com/login!withRedirect.jspa?referrer=http%3A%2F%2Fforums.sun.com%2Fthread.jspa%3FthreadID%3D5175986">Login</a></li>
			
			<li><a
				href="http://forums.sun.com/editwatches!default.jspa">Watch
			List</a></li>
			
				<li><a
					href="http://wikis.sun.com/display/SunForums/Duke+Stars+Program+Overview">Duke
				Stars Program</a></li>
				<li><a href="http://wikis.sun.com/display/SunForums/Tips">Beginners
				Quick Start</a></li>
				<li><a
					href="http://forums.sun.com/myforums.jspa">My
				Forums</a></li>
				<li><a
					href="http://developers.sun.com/contact/feedback.jsp?referer=http://forums.sun.com&category=sdn&mailsubject=Forums%20or%20Community">
				Feedback </a></li>
				<li><a
					href="http://wikis.sun.com/display/SunForums/Forums.sun.com+FAQ">FAQ</a></li>
				<li width="100%"><a
					href="http://wikis.sun.com/display/SunForums/Sun+Forums+Code+of+Conduct">Code
				of Conduct</a></li>
				
			</ul>

			<!-- END E15 COMPONENT -->
		</div>
		</div>
		</div>

		<!-- BEGIN SEARCH BOX --> <!-- DISPLAYS NOT FOR MAIN PAGE --> 
		<div class="e5">
		<table border="0" cellpadding="0" cellspacing="0" class="blue1"
			width="100%">
			<tr>
				<td>

				<table border="0" cellpadding="0" cellspacing="0" width="100%"
					class="white1">
					<form action="/sunsearch.jspa" method="post">
					<tr>
						<td>
						<div class="pad6"><label for="f7text1"><b>Search
						Forums</b></label></div>
						</td>
					</tr>
					<tr>
						<td>
						<div class="cellpadbottom">

						<table border="0" cellpadding="0" cellspacing="0">
							<tr>
								<td valign="top"><input id="f7text1" name="qt" align="top"
									type="text" class="medium" size="6"
									onFocus="if( this.value==this.defaultValue ) this.value='';"
									value="Search" /></td>
								<td>&#160;&#160;</td>
								
								<input type="hidden" name="inmeta" value="inmeta:forum=9" />

								<td valign="top"><input type="submit" border="0"
									class="hotbutton" value="&#160;&raquo;&#160;"
									onmouseover="this.style.color='#fbe249';"
									onmouseout="this.style.color='#FFF';" /></td>
							</tr>
						</table>

						</div>
						</td>
					</tr>
					</form>
					<tr>
						<td>
						<div class="cellpadbottom"><span class="rightarrowblue">&raquo;</span>&#160;&#160;<a
							href="http://search.sun.com/main/index.jsp">Advanced Search</a></div>
						</td>
					</tr>
				</table>

				</td>
			</tr>
		</table>
		<span class="sp10">&#160;</span><br />
		</div>
		 <!-- END SEARCH BOX --> <!-- Ad Box -->  <script type='text/javascript'><!--//<![CDATA[
   var m3_u = (location.protocol=='https:'?'https://ads.sun.com/ads/www/delivery/ajs.php':'http://ads.sun.com/ads/www/delivery/ajs.php');
   var m3_r = Math.floor(Math.random()*99999999999);
   if (!document.MAX_used) document.MAX_used = ',';
   document.write ("<scr"+"ipt type='text/javascript' src='"+m3_u);
   document.write ("?zoneid=585");
   document.write ('&amp;cb=' + m3_r);
   if (document.MAX_used != ',') document.write ("&amp;exclude=" + document.MAX_used);
   document.write (document.charset ? '&amp;charset='+document.charset : (document.characterSet ? '&amp;charset='+document.characterSet : ''));
   document.write ("&amp;loc=" + escape(window.location));
   if (document.referrer) document.write ("&amp;referer=" + escape(document.referrer));
   if (document.context) document.write ("&context=" + escape(document.context));
   if (document.mmm_fo) document.write ("&amp;mmm_fo=1");
   document.write ("'><\/scr"+"ipt>");
//]]>--></script><noscript><a href='http://ads.sun.com/ads/www/delivery/ck.php?n=a4223322&amp;cb=555' target='_blank'><img src='http://ads.sun.com/ads/www/delivery/avw.php?zoneid=585&amp;cb=555&amp;n=a4223322' border='0' alt='' /></a></noscript>  <!-- End Ad Box --> <!-- BEGIN SPOTLIGHT ALERT --> 
		<div class="e2">
		<table border="0" cellpadding="8" cellspacing="0" width="100%"
			class="navblue">
			<tr>
				<td>

				<table border="0" cellpadding="0" cellspacing="0" width="100%"
					class="vatop">
					<tr>
						<td colspan="2"><b>Site Upgrade</b><br>
<a href="http://forums.sun.com/thread.jspa?threadID=5413241">Forums 7.1.8</a> was deployed Oct 26th. The release consists of minor fixes & a few enhancements.
						</td>
					</tr>
				</table>

				</td>
			</tr>
		</table>
		<span class="sp10">&#160;</span><br />
		</div>
		 <!-- END SPOTLIGHT ALERT --> <!-- BEGIN E15 COMPONENT V.0 -->
		<div class="e15 e15v2">
		<div class="e15w1">
		<div class="e15w2"><!-- BEGIN STATISTICS LINKS -->
		<h5>Forums Statistics</h5>
		<ul
			
			</ul>
		<!-- END STATISTICS --> <!-- END E15 COMPONENT --></div>
		</div>
		</div>

		<br>

		<!-- BEGIN E15 COMPONENT V.0 -->
		<div class="e15 e15v2">
		<div class="e15w1">
		<div class="e15w2"><!-- BEGIN ABOUT SUN FORUMS -->
		<h5>About Sun forums</h5>
		<ul>
			<li>

			<p>Oracle Forums is a large collection of user generated
			discussions. It is here to help you ask questions, find answers, and
			participate in discussions.</p>
			<p>Check out our guide on <a
				href="http://wikis.sun.com/display/SunForums/Tips">Getting
			started with Oracle Forums</a> for a full walkthrough of how to best
			leverage the benefits of this community.</p>
			</li>
		</ul>
		<!-- END ABOUT SUN FORUMS --></div>
		</div>
		</div>
		<!-- END e15 components --></td>
	</tr>
</table>
</END side nav table>


</td> <!-- END RIGHT NAV-->

</tr>
</tbody>
</table> <!-- END CONTENT & NAV TABLE -->


<script language="JavaScript" src="/s_code_remote.js"></script>

<table> 
<tr> <td> 
    

    </td>
</tr>
<tr>
    <td valign="bottom">
        <a href="http://www.jivesoftware.com/poweredby/" target="_new">
            <img src="/im/ic_jive_forums.gif" alt="Powered by Jive Forums" width="74" height="24" border="0">
        </a>
    </td>
</tr>
</table>


    
    <!-- END RIGHT COLUMN COMPONENTS -->
<br /><img src="/im/a.gif" width="170" height="1" border="0" alt=" " /></td></tr>
<tr><td rowspan="2" valign="bottom"><img src="/im/a.gif" width="170" height="1" border="0" alt=" " /><br />
<!--  BEGIN CELL FOR OPTIONAL MASTHEAD CAPTION -->
<!--  END CELL FOR OPTIONAL MASTHEAD CAPTION --></td></tr>
<!-- END SPACER ROW -->
</table>
<!-- END WRAPPER TABLE, 3 COLUMN, LEFT/MAIN/RIGHT -->
    <html><head><!-- BEGIN VNV5 FOOTER  --></head><body><table border="0" cellpadding="0" cellspacing="10" width="100%">
<tbody><tr>
<td>
<table class="vatop" border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="4" class="grey3" valign="top"><img src="/im/a.gif" alt="" border="0" height="2" width="1"></td></tr>
<tr>
<td><img src="/im/a.gif" alt="" border="0" height="1" width="190"><br>
<a href="http://www.oracle.com"><img src="http://stest-wip.sfbay.sun.com/im/logo_oracle_footer.gif" width="93" height="29" /> </a> </td>
<td valign="top" width="100%"><img src="/im/a.gif" alt="" border="0" height="1" width="350"><br>
<div class="footer">
<a href="http://www.sun.com/communities/guidelines.jsp">Sun Guidelines for Public Discourse</a> &nbsp;|&nbsp;
<a href="http://developers.sun.com/global/aboutsun.html">About Sun</a> &nbsp;|&nbsp;
<a href="http://developers.sun.com/global/aboutsdn.html">About This Site</a> &nbsp;|&nbsp;
<a href="http://developers.sun.com/global/newsletters.html">Newsletters</a> &nbsp;|&nbsp;
<a href="http://developers.sun.com/global/contact.html">Contact Us</a> &nbsp;|&nbsp;
<a href="http://developers.sun.com/global/employment.html">Employment</a><br>
<a href="http://developers.sun.com/global/howtobuy.html">How to Buy</a> &nbsp;|&nbsp;
<a href="http://developers.sun.com/global/licensing.html">Licensing</a> &nbsp;|&nbsp;
<a href="http://developers.sun.com/global/termsofuse.html">Terms of Use</a> &nbsp;|&nbsp;
<a href="http://developers.sun.com/global/privacy.html">Privacy</a> &nbsp;|&nbsp;
<a href="http://developers.sun.com/global/trademarks.html">Trademarks</a>
<br><span class="sp10">&nbsp;</span><br>
<br><span class="sp10">&nbsp;</span><br>
<span style="display:block;float:right;text-align:right" class="footercopy">
            &copy; 2009, Oracle Corporation and/or its affiliates<br>
</spav>
</div></td>
<td><img src="/im/a.gif" alt="" border="0" height="1" width="40"></td>
<td valign="top"><div class="footer"><b><a href="http://developers.sun.com/global/aboutsdn.html">A Sun Developer Network Site</a></b></div>
<div class="footer">
<img src="/im/a.gif" alt="" border="0" height="1" width="170"><br>
Unless otherwise licensed, code in all technical manuals herein (including articles, FAQs, samples) is provided under this <a href="http://developers.sun.com/global/berkeley_license.html">License</a>.
<br><span class="sp5">&nbsp;</span><br>
<a href="http://developers.sun.com/global/rss_sdn.html"><img src="/im/button_xml.gif" alt="XML" align="top" border="0" height="14" width="36"></a>&nbsp;<a href="http://developers.sun.com/global/content_feeds.html">Content Feeds</a>
</div></td></tr>
<tr><td colspan="4" class="grey3" valign="top"><img src="/im/a.gif" alt="" border="0" height="2" width="1"></td></tr>
</tbody></table>
</td></tr>
</tbody></table>
<!-- END VNV5 FOOTER -->
</body></html>

    </div>  <!-- end of "a0 a0v1" div -->
</body></html>
</td></tr></table>
</table>


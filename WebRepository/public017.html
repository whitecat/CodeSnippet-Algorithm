
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" />
<TITLE>Public Key Cryptography 101 Using Java &mdash; Developer.com</TITLE>
<META NAME="description" CONTENT="Delve into the general philosophy of public key cryptography.&nbsp; 
Work through sample programs that illustrate various aspects of public key cryptography through the use of the RSA algorithm as implemented using Java.">
<META NAME="keywords" CONTENT=" Java C# Processing">
<META NAME="authors" CONTENT=" Richard G. Baldwin">
<META NAME="date" CONTENT="20041214">
<META NAME="channel" CONTENT="">

<SCRIPT LANGUAGE=JavaScript>
<!--
OAS_url = 'http://mjxads.internet.com/RealMedia/ads/';
OAS_sitepage = 'intm/webdev/www.developer.com/security';
OAS_listpos = 'house_ribbon,468x60-1,468x60-2,336x280,flex,336x280-2,120x60-1,120x60-2,120x60-3,125x125-1,125x125-2,125x800,accessunit,accessunit_one,accessunit_two,accessunit_three,ciu,cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10,cp11,cp12,cp13,cp14,fl1,fl2,fl3,fl4,fl5,send,morph';
OAS_query = '';
OAS_target = '_top';
OAS_version = 10;
OAS_rn = '001234567890'; OAS_rns = '1234567890';
OAS_rn = new String (Math.random()); OAS_rns = OAS_rn.substring (2, 11);
function OAS_NORMAL(pos) {
var_a=('<A HREF="' + OAS_url + 'click_nx.cgi/' + OAS_sitepage );
var_b=(var_a + '/1' + OAS_rns + '@' + OAS_listpos + '!' + pos + '?' );
var_c=(var_b+ OAS_query + '" TARGET=' + OAS_target + '>');
document.write(var_c);
var_aa=('<IMG SRC="' + OAS_url + 'adstream_nx.cgi/' + OAS_sitepage ); 
var_bb=( var_aa + '/1' + OAS_rns + '@' + OAS_listpos + '!' + pos + '?');
var_cc=( var_bb + OAS_query + '" BORDER=0></A>');
document.write(var_cc);
}
//-->
</SCRIPT>

<SCRIPT LANGUAGE=JavaScript1.1>
<!--
OAS_version = 11;
if (navigator.userAgent.indexOf('Mozilla/3') != -1 )
OAS_version = 10;
if (navigator.userAgent.indexOf('Mozilla/4.0 WebTV') != -1)
OAS_version = 10;
if (OAS_version >= 11) {
var_aaa=('<SCRIPT LANGUAGE=JavaScript1.1 SRC="' + OAS_url); 
var_bbb=(var_aaa + 'adstream_mjx.ads/' + OAS_sitepage + '/1'); 
var_ccc=(var_bbb + OAS_rns + '@' + OAS_listpos + '?' + OAS_query );
var_ddd=(var_ccc + '"><\/SCRIPT>');
document.write(var_ddd);
}
//-->

</SCRIPT>

<SCRIPT LANGUAGE=JavaScript>
<!--
document.write('');
function OAS_AD(pos) {
if (OAS_version >= 11)
OAS_RICH(pos);
else
OAS_NORMAL(pos);
}
//-->
</SCRIPT>
<link href="/stylesheets/styles.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="/javascripts/common.js" ></script>
<script type="text/javascript" src="/javascripts/tabs.js" ></script>
<script type="text/javascript" src="/javascripts/article_menu.js" ></script>
<script type="text/javascript" src="/javascripts/hot_topics.js" ></script>
<script type="text/javascript" src="/javascripts/iepngfix_tilebg.js"></script>

<style rel="stylesheet" type="text/css">
h2, h3, h4 { font-size: 1.2em; }
</style>

</head>
<body>
<!-- "send" begin" -->

<!------ OAS AD 'send' begin ------>
<SCRIPT LANGUAGE=JavaScript>
<!--
OAS_AD('send');
//-->
</SCRIPT>
<NOSCRIPT>
<A HREF="http://63.236.18.118/RealMedia/ads/click_nx.ads/intm/webdev/www.developer.com/security@house_ribbon,468x60-1,468x60-2,336x280,flex,336x280-2,120x60-1,120x60-2,120x60-3,125x125-1,125x125-2,125x800,accessunit,accessunit_one,accessunit_two,accessunit_three,ciu,cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10,cp11,cp12,cp13,cp14,fl1,fl2,fl3,fl4,fl5,send,morph!send" >
<IMG SRC="http://63.236.18.118/RealMedia/ads/adstream_nx.ads/intm/webdev/www.developer.com/security@house_ribbon,468x60-1,468x60-2,336x280,flex,336x280-2,120x60-1,120x60-2,120x60-3,125x125-1,125x125-2,125x800,accessunit,accessunit_one,accessunit_two,accessunit_three,ciu,cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10,cp11,cp12,cp13,cp14,fl1,fl2,fl3,fl4,fl5,send,morph!send" border=0>
</A>
</NOSCRIPT>
<!------ OAS AD 'send' end ------><!-- "send" end" -->

<div id="EntNetPlanet" class="wrapBody">

<!-- "house_ribbon" begin -->

<!------ OAS AD 'house_ribbon' begin ------>
<SCRIPT LANGUAGE=JavaScript>
<!--
OAS_AD('house_ribbon');
//-->
</SCRIPT>
<NOSCRIPT>
<A HREF="http://63.236.18.118/RealMedia/ads/click_nx.ads/intm/webdev/www.developer.com/security@house_ribbon,468x60-1,468x60-2,336x280,flex,336x280-2,120x60-1,120x60-2,120x60-3,125x125-1,125x125-2,125x800,accessunit,accessunit_one,accessunit_two,accessunit_three,ciu,cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10,cp11,cp12,cp13,cp14,fl1,fl2,fl3,fl4,fl5,send,morph!house_ribbon" >
<IMG SRC="http://63.236.18.118/RealMedia/ads/adstream_nx.ads/intm/webdev/www.developer.com/security@house_ribbon,468x60-1,468x60-2,336x280,flex,336x280-2,120x60-1,120x60-2,120x60-3,125x125-1,125x125-2,125x800,accessunit,accessunit_one,accessunit_two,accessunit_three,ciu,cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10,cp11,cp12,cp13,cp14,fl1,fl2,fl3,fl4,fl5,send,morph!house_ribbon" border=0>
</A>
</NOSCRIPT>
<!------ OAS AD 'house_ribbon' end ------><!-- "house_ribbon" end -->
	
	<div id="header" class="dimMain">
		<div class="logo"><a href="/"><img src="/images0/developer_oldcolor.gif" alt="Developer.com" border="0" /></a></div>

		<div class="searchForm">
			<form action="http://search.internet.com/www.developer.com" method="post">
				<input name="IC_QueryText" onclick="this.select();if(this.value=='Search...')this.value='';" id="search_keyword" type="text" class="inputBox" value="Search..." />
				<select name="IC_QueryDatabase" id="search_category" class="inputBox">
					<option value="www.developer.com">Developer.com</option>
					<option value="www.internet.com">Internet.com</option>
				</select>
				<input type="submit" name="btnSearch" id="btnSearch" value="" />
			</form>
		</div>
		
		<div class="adsBox">
<!-- "120x60-1" begin -->

<!-- "120x60-1" end -->
		</div>
	</div>
	
	<div id="headerBottomNav" class="dimMain">
		<div class="deep_blue">
			<ul>
				<li><a href="/java/" class="first">Java</a> </li>
				<li><a href="/net/" class="first">Microsoft &amp; .NET</a> </li>
				<li><a href="/design/" class="first">Architecture &amp Design</a> </li>
				<li><a href="/db/" class="first">Database</a> </li>
				<li><a href="/open/" class="first">Open Source</a></li>
				<li><a href="/lang/" class="first">Other</a></li>
			</ul>
		</div>
		<div class="light_blue">
			<ul>
				<li><a href="/services/" class="sec">Web Services</a></li>
				<li><a href="/security/" class="sec">Security</a></li>
				<li><a href="/ws/" class="sec">Mobile</a></li>
				<li><a href="/mgmt/" class="sec">Project Management</a></li>
			</ul>
		</div>
		<div style="float:right">
			<a style="margin-right:1em" title="rss feed" class="rss" href="http://www.developer.com/icom_includes/feeds/developer/dev-25.xml">RSS <img style="vertical-align:middle" alt="RSS feed" src="/images0/feed-icon-14x14.png"/></a>
		</div>
	</div>	
	<div class="vspace"></div>
	
	<div class="adsBox ads5">
<!-- "468x60-1" begin -->

<!------ OAS AD '468x60-1' begin ------>
<SCRIPT LANGUAGE=JavaScript>
<!--
OAS_AD('468x60-1');
//-->
</SCRIPT>
<NOSCRIPT>
<A HREF="http://63.236.18.118/RealMedia/ads/click_nx.ads/intm/webdev/www.developer.com/security@house_ribbon,468x60-1,468x60-2,336x280,flex,336x280-2,120x60-1,120x60-2,120x60-3,125x125-1,125x125-2,125x800,accessunit,accessunit_one,accessunit_two,accessunit_three,ciu,cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10,cp11,cp12,cp13,cp14,fl1,fl2,fl3,fl4,fl5,send,morph!468x60-1" >
<IMG SRC="http://63.236.18.118/RealMedia/ads/adstream_nx.ads/intm/webdev/www.developer.com/security@house_ribbon,468x60-1,468x60-2,336x280,flex,336x280-2,120x60-1,120x60-2,120x60-3,125x125-1,125x125-2,125x800,accessunit,accessunit_one,accessunit_two,accessunit_three,ciu,cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10,cp11,cp12,cp13,cp14,fl1,fl2,fl3,fl4,fl5,send,morph!468x60-1" border=0>
</A>
</NOSCRIPT>
<!------ OAS AD '468x60-1' end ------><!-- "468x60-1" end -->
	</div>
    
<div id="content">
	<div class="col clearfix">
		<div class="colLeft dimMainLeft">
			
			<div id="date_holder" class="clearfix">
				<div class="date">February 04, 2010</div>
				
				<div class="topic">
					<span class="title">Hot Topics:</span>
					<div id="hot_topics">
						<a href="#" class="prev">prev</a>
						<div class="topics_list">
							<div class="gr_l"></div>
							<div class="list">
								<ul>
<li><a href="http://www.developer.com/tags/index.php/131842/C.html" class="blue_topic">C#</a></li>
<li><a href="http://www.developer.com/tags/index.php/93702/NET.html" class="blue_topic">.NET</a></li>
<li><a href="http://www.developer.com/tags/index.php/91242/open-source.html" class="blue_topic"> open source</a></li>
<li><a href="http://www.developer.com/tags/index.php/135382/C.html" class="blue_topic">C++</a></li>
<li><a href="http://www.developer.com/tags/index.php/91062/Java.html" class="blue_topic">Java</a></li>

								</ul>
							</div>
							<div class="gr_r"></div>
						</div>
						<a href="#" class="next">next</a>
					</div>
					<script type="text/javascript">
						initHotTopics(document.getElementById("hot_topics"));
					</script>
				</div>
			</div>			
			<div id="breadcumb"  class="clearfix">
				<div class="colLeft">
					<div class="bread_left"><a href="/">Developer.com</a></div>
					<div class="bread_mid"><a href="/security">Security</a></div>
					<div class="bread_right"></div>
				</div>
				<div class="colRight">
					<a href="/security/archives.php" class="more">Read More in Security &raquo;</a>
				</div>
			</div>			
			<div class="vspace"></div>
			
			<div class="clearfix">
				<div class="colLeft">
				
					<div class="adsBox ads1">
<!-- "ciu" begin" -->

<!------ OAS AD 'ciu' begin ------>
<SCRIPT LANGUAGE=JavaScript>
<!--
OAS_AD('ciu');
//-->
</SCRIPT>
<NOSCRIPT>
<A HREF="http://63.236.18.118/RealMedia/ads/click_nx.ads/intm/webdev/www.developer.com/security@house_ribbon,468x60-1,468x60-2,336x280,flex,336x280-2,120x60-1,120x60-2,120x60-3,125x125-1,125x125-2,125x800,accessunit,accessunit_one,accessunit_two,accessunit_three,ciu,cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10,cp11,cp12,cp13,cp14,fl1,fl2,fl3,fl4,fl5,send,morph!ciu" >
<IMG SRC="http://63.236.18.118/RealMedia/ads/adstream_nx.ads/intm/webdev/www.developer.com/security@house_ribbon,468x60-1,468x60-2,336x280,flex,336x280-2,120x60-1,120x60-2,120x60-3,125x125-1,125x125-2,125x800,accessunit,accessunit_one,accessunit_two,accessunit_three,ciu,cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10,cp11,cp12,cp13,cp14,fl1,fl2,fl3,fl4,fl5,send,morph!ciu" border=0>
</A>
</NOSCRIPT>
<!------ OAS AD 'ciu' end ------>
<!-- "ciu" end" -->
					</div>
				</div>
				
				<div class="colRight">
					<div class="adsBox ads2">
					</div>
				</div>
			</div>
			
			<div class="vspace"></div>
			
			<div class="article">
			<h1>Public Key Cryptography 101 Using Java</h1>
			
			<div class="author colLeft">
				
				<ul class="noBullets">
					<li>December 14, 2004</li>
					<li>By 
<a href="/author.php/12903/Richard-G-Baldwin.htm">Richard G. Baldwin</a>
</li>
<script>
var newwindow;
function openPopup(url)
{
	 newwindow=window.open(url,'Author','width=480,height=250,resizable=no,scrollbars=yes,toolbar=no,status=no');
         if (window.focus) {newwindow.focus()}
}
</script>
					<li><a class="email" onclick="javascript:openPopup('/bio.php/12903/Richard-G-Baldwin.htm')" href="javascript:void(0)">Bio &raquo;</a></li>
					<li><a href="/feedback.php/http://www.developer.com/security/article.phpr/3447491/Public-Key-Cryptography-101-Using-Java.htm">Send Email &raquo;</a></li>
					<li><a href="/author.php/12903/Richard-G-Baldwin.htm">More Articles  &raquo;</a></li>
				</ul>
<div class="retweet">
<script type="text/javascript">
var tweetmeme_url = "http://www.developer.com/security/article.phpr/3447491/Public-Key-Cryptography-101-Using-Java.htm";
</script>
<script type="text/javascript" src="http://tweetmeme.com/i/scripts/button.js"></script>
</div>
			</div>
			
<!--content_start--><p>Java Programming, Notes # 727</p>
     
<ul>
  <li><a href="#Preface">Preface</a></li>
	<li><a href="#Background_Information">Background Information</a></li>
  <li><a href="#Preview">Preview</a></li>
  <li><a href="#Discussion_and_Sample_Code">Discussion and Sample Code</a><li><a href="#Run_the_Programs">Run the Programs</a></li>
  <li><a href="#Summary">Summary</a></li>
	<li><a href="#Whats Next">What's Next</a></li>
  <li><a href="#Complete_Program_Listings">Complete Program Listings</a> </li>
</ul>
        
<hr size="3" width="100%" align="center">    
<center>    
<h2> <a name="Preface">Preface</a></h2>
   </center>
<p><font color="#FF0000"><b>First in a series</b></font></p>
<p>This is the first lesson in a series designed to teach you something about 
the inner workings of cryptography using Java.&nbsp; Hopefully, when you finish 
studying the lessons in this series, you will have learned a little about what goes on
<i>&quot;under the hood&quot;</i> when you apply a cryptographic process.</p>
<p><font color="#FF0000"><b>Not a lesson on JCE</b></font></p>
<div class="toolbox noBullets colRight">
	<ul>
		<li class="comment"><a rel="nofollow" href="#comment_form"><nobr>Post a comment</nobr></a></li>
		<li class="email"><a rel="nofollow" href="/email.php/3447491">Email Article</a></li>
		<li class="print"><a rel="nofollow" href="/print.php/3447491">Print Article</a></li>
		<li id="toolBoxShareMenu" class="share">
			<img height="16" width="16" class="icon" alt="" src="/images0/icon_share.gif"/> <a rel="nofollow" href="#">Share Articles</a><img src="/images0/arrow_down_red.gif"/>
			<div class="shareSubMenu">
				<span class="top"><span></span></span>
					<ul>
						<li><a href="javascript:void(0)" onclick="javascript:window.open('http://digg.com/submit?phase=2&url='+encodeURIComponent(location.href)+'&title='+encodeURIComponent(document.title)+'&bodytext=&topic=');"><img src="/images0/icon_diggthis.gif" alt="" width="16" height="16" border="0" class="icon" /> Digg</a></li>
						<li><a href="javascript:void(0)" onclick="javascript:window.open('http://del.icio.us/post?v=4&noui&jump=close&url='+encodeURIComponent(location.href)+'&title='+encodeURIComponent(document.title));"><img src="/icom_includes/socialnetworking/img/icon_delicious.gif" alt="" width="16" height="16"  border="0" class="icon" /> del.icio.us</a></li>
						<li><a href="javascript:void(0)" onclick="javascript:window.open('http://slashdot.org/slashdot-it.pl?op=basic&url='+encodeURIComponent(location.href));"><img src="/icom_includes/socialnetworking/img/icon_slashdot.gif" alt="" width="16" height="16"  border="0" class="icon" /> Slashdot</a></li>
						<li><a href="javascript:void(0)" onclick="javascript:window.open('http://www.dzone.com/links/add.html?url='+encodeURIComponent(location.href)+'&title='+encodeURIComponent(document.title));"><img src="/icom_includes/socialnetworking/img/icon_dzone.gif" alt="" width="16" height="16" border="0" class="icon" /> DZone</a></li>
						<li><a href="javascript:void(0)" onclick="javascript:window.open('http://reddit.com/submit?url='+encodeURIComponent(location.href)+'&title='+encodeURIComponent(document.title));"><img src="/icom_includes/socialnetworking/img/icon_reddit.gif" alt="" width="16" height="16"  border="0" class="icon" /> Reddit</a></li>
						<li><a href="javascript:void(0)" onclick="javascript:window.open('http://www.stumbleupon.com/submit?url='+encodeURIComponent(location.href)+'&title='+encodeURIComponent(document.title));"><img src="/icom_includes/socialnetworking/img/icon_stumbleit.gif" alt="" width="16" height="16"  border="0" class="icon" /> StumbleUpon</a></li>
						<li><a href="javascript:void(0)" onclick="javascript:window.open('http://www.facebook.com/sharer.php?u='+encodeURIComponent(location.href));"><img src="/icom_includes/socialnetworking/img/icon_facebook.gif" alt="" width="16" height="16"  border="0" class="icon" /> Facebook</a></li>
						<li><a href="javascript:void(0)" onclick="javascript:window.open('http://friendfeed.com/?url='+encodeURIComponent(location.href)+'&title='+encodeURIComponent(document.title));"><img src="/icom_includes/socialnetworking/img/icon_friendfeed.gif" alt="" width="16" height="16" border="0" class="icon" /> FriendFeed</a></li>
						<li><a href="javascript:void(0)" onclick="javascript:window.open('http://www.furl.net/storeIt.jsp?t='+encodeURIComponent(document.title)+'&u='+encodeURIComponent(location.href));"><img src="/icom_includes/socialnetworking/img/icon_furl.gif" alt="" width="16" height="16" border="0" class="icon" /> Furl</a></li>

						<li><a href="javascript:void(0)" onclick="javascript:window.open('http://www.newsvine.com/_wine/save?popoff=1&u='+encodeURIComponent(location.href),'newsvine','toolbar=no,width=590,height=600,resizable=yes,scrollbars=yes');"><img src="/icom_includes/socialnetworking/img/icon_seednewsvine.gif" alt="" width="16" height="16" class="icon" /> Newsvine</a></li>
						<li><a href="javascript:void(0)" onclick="javascript:window.open('http://www.google.com/bookmarks/mark?op=edit&bkmk='+encodeURIComponent(location.href)+'&title='+encodeURIComponent(document.title));"><img src="/icom_includes/socialnetworking/img/icon_google.gif" alt="" width="16" height="16" class="icon" /> Google</a></li>
						<li><a href="javascript:void(0)" onclick="javascript:window.open('http://www.linkedin.com/shareArticle?mini=true&ro=true&url='+encodeURIComponent(location.href)+'&source='+encodeURIComponent(document.title));"><img src="/icom_includes/socialnetworking/img/icon_linkedin.gif" alt="" width="16" height="16" class="icon" /> LinkedIn</a></li>
						<li><a href="javascript:void(0)" onclick="javascript:window.open('http://www.myspace.com/Modules/PostTo/Pages/?u='+encodeURIComponent(location.href)+'&t='+encodeURIComponent(document.title));"><img src="/icom_includes/socialnetworking/img/icon_myspace.jpg" alt="" width="16" height="16" class="icon" /> MySpace</a></li>
						<li><a href="javascript:void(0)" onclick="javascript:window.open('http://www.technorati.com/faves?add='+encodeURIComponent(location.href));"><img src="/icom_includes/socialnetworking/img/icon_technorati.gif" alt="" width="16" height="16" class="icon" /> Technorati</a></li>
						<li><a href="javascript:void(0)" onclick="javascript:window.open('http://twitter.com/home?status='+encodeURIComponent(location.href));"><img src="/icom_includes/socialnetworking/img/icon_twitter.gif" alt="" width="16" height="16" class="icon" /> Twitter</a></li>
						<li><a href="javascript:void(0)" onclick="javascript:window.open('https://favorites.live.com/quickadd.aspx?marklet=1&mkt=en-us&top=1&url='+encodeURIComponent(location.href)+'&title='+encodeURIComponent(document.title));"><img src="/icom_includes/socialnetworking/img/icon_windowslive.gif" alt="" width="16" height="16" class="icon" /> Windows Live</a></li>
						<li><a href="javascript:void(0)" onclick="javascript:window.open('http://buzz.yahoo.com/submit?urlsubmission-input='+encodeURIComponent(location.href)+'&submitHeadline='+encodeURIComponent(document.title));"><img src="/icom_includes/socialnetworking/img/icon_yahoo.gif" alt="" width="16" height="16" class="icon" /> YahooBuzz</a></li>

					</ul>
				<span class="bottom"><span></span></span>
			</div>
		</li>
	</ul>
</div>
		<script type="text/javascript">
			initArticleMenu(document.getElementById("toolBoxShareMenu"));
		</script><p>The lessons in this series do not provide instructions on how to use the
<a href="http://java.sun.com/j2se/1.4/docs/guide/security/jce/JCERefGuide.html">
Java Cryptography Extension <i>(JCE)</i></a>.&nbsp; The purpose of 
this series is to teach you how to implement common cryptography algorithms 
for small cases directly in Java.</p>
<p><font color="#FF0000"><b>Not intended for production use</b></font></p>
<p>The programs that I will provide and explain in this series of lessons are 
not intended to be used for production cryptography.&nbsp; If you need to do 
cryptography using Java, you should use
<a href="http://java.sun.com/j2se/1.4/docs/guide/security/jce/JCERefGuide.html">
Sun's Java Cryptography Extension <i>(JCE)</i></a><i>.</i></p>
<p>The programs that I will provide in this series are intended to help you to 
experiment with and to learn about various cryptographic algorithms and to gain 
a better understanding of how they work, and why they do what they do.</p>
<p><b><font color="#ff0000">Viewing tip</font></b> </p>
 
<p>You may find it useful to open another copy of this lesson in a separate
 browser window.&nbsp; That will make it easier for you to scroll back and
 forth among the different figures and listings while you are reading about
 them.</p>
<p><font color="#FF0000"><b>Theoretical basis and practical implementation</b></font></p>
<p>I will provide some of the theoretical basis for cryptographic algorithms 
while discussing the lessons in this series.&nbsp; In addition, I will show you how to implement 
several common cryptographic algorithms in Java.</p>
<p>I will also discuss and illustrate some of the modern uses of cryptography, 
such as the use of digital signatures.</p>
<h2 align="center"><a name="Background_Information">Background Information</a></h2>
<p>Cryptography in one form or another has been around throughout history.&nbsp; 
Even in pre-biblical times, governments had a need to exchange messages in 
secret.</p>
<p><font color="#FF0000"><b>What is cryptography?</b></font></p>
<p>According to <a href="http://en.wikipedia.org/wiki/Cryptography">Wikipedia</a>,
<i>&quot;<strong style="font-weight: 400">Cryptography</strong> ... is, 
traditionally, the study of means of converting
<a title="Information" href="http://en.wikipedia.org/wiki/Information">
information</a> from its normal, comprehensible form into an incomprehensible 
format, rendering it unreadable without secret knowledge &#8212; the art of </i><em>
<a title="Encryption" href="http://en.wikipedia.org/wiki/Encryption">encryption</a></em><i>.&quot;</i></p>
<p><font color="#FF0000"><b>Spies, diplomats, etc.</b></font></p>
<p>Confirming what I alluded to earlier,
<a href="http://en.wikipedia.org/wiki/Cryptography">Wikipedia</a> tells us, <i>
&quot;In the past, cryptography helped ensure
<a title="Secrecy" href="http://en.wikipedia.org/wiki/Secrecy">secrecy</a> in 
important
<a title="Communications" href="http://en.wikipedia.org/wiki/Communications">
communications</a>, such as those of
<a title="Secret agent" href="http://en.wikipedia.org/wiki/Secret_agent">spies</a>,
<a title="Military" href="http://en.wikipedia.org/wiki/Military">military</a> 
leaders, and <a title="Diplomat" href="http://en.wikipedia.org/wiki/Diplomat">
diplomats</a>.&quot;</i></p>
<p><font color="#FF0000"><b>New uses in modern times</b></font></p>
<p>Bringing the field of cryptography up to date,
<a href="http://en.wikipedia.org/wiki/Cryptography">Wikipedia</a> tells us, <i>
&quot;In recent decades, the field of cryptography has expanded its remit in two 
ways. Firstly, it provides mechanisms for more than just
<a title="Confidentiality" href="http://en.wikipedia.org/wiki/Confidentiality">
keeping secrets</a>: schemes like
<a title="Digital signature" href="http://en.wikipedia.org/wiki/Digital_signature">
digital signatures</a> and
<a title="Digital cash" href="http://en.wikipedia.org/wiki/Digital_cash">digital 
cash</a>, for example. Secondly, cryptography has come to be in widespread use 
by many <a title="Civilian" href="http://en.wikipedia.org/wiki/Civilian">
civilians</a> who do not have extraordinary needs for secrecy, although 
typically it is transparently built into the
<a title="Infrastructure" href="http://en.wikipedia.org/wiki/Infrastructure">
infrastructure</a> for
<a title="Computing" href="http://en.wikipedia.org/wiki/Computing">computing</a> 
and
<a title="Telecommunications" href="http://en.wikipedia.org/wiki/Telecommunications">
telecommunications</a>, and users are not aware of it.&quot; </i></p>
<p><font color="#FF0000"><b>What is cryptanalysis?</b></font></p>
<p>Although this series of lessons won't involve cryptanalysis in any 
significant way, it won't hurt to learn the meaning of the term anyway.&nbsp;
<a href="http://en.wikipedia.org/wiki/Cryptography">Wikipedia</a> tells us, <i>
&quot;The study of how to circumvent the use of cryptography is called </i><em>
<a title="Cryptanalysis" href="http://en.wikipedia.org/wiki/Cryptanalysis">
cryptanalysis</a></em><i>, or </i><em>codebreaking</em><i>. Cryptography and 
cryptanalysis are sometimes grouped together under the umbrella term <strong>
cryptology</strong>, encompassing the entire subject. In practice, 
&quot;cryptography&quot; is also often used to refer to the field as a whole; <strong>
crypto</strong> is an informal abbreviation.&quot;</i></p>
<p><font color="#FF0000"><b>Secure communications</b></font></p>
<p>The lessons in this series will present and explain programs that implement 
cryptographic algorithms intended to achieve secure communications between two 
parties.&nbsp; These algorithms fall into two broad categories:</p>
<ul>
	<li>Public <i>(asymmetric)</i> key cryptography</li>
	<li>Symmetric key cryptography</li>
</ul>
<p>The first several lessons will deal with
<a href="http://en.wikipedia.org/wiki/Cryptography#Public_key_cryptography">
public key cryptography</a>.&nbsp; Subsequent lessons will deal with
<a href="http://en.wikipedia.org/wiki/Cryptography#Symmetric_key_cryptography">
symmetric key cryptography</a>. </p>
<p><font color="#FF0000"><b>What's the difference?</b></font></p>
<p>Many modern approaches to data encryption operate by passing the data along 
with an <i>(often secret)</i> key value through a mathematical transformation.&nbsp; 
Paraphrasing Wikipedia from above, the transformation converts the information 
from its normal comprehensible form into an incomprehensible form rendering it 
unreadable to persons who don't have access to a secret key.</p>
<p>Operating in the reverse direction, <i>decryption</i> passes the encrypted data
<i>(cipher data)</i> 
along with a secret key value through a mathematical transformation, converting the 
encrypted data back into a comprehensible form.</p>
<p><font color="#FF0000"><b>The difference is in the use of the keys</b></font></p>
<p>The difference between public <i>(asymmetric)</i> and symmetric key 
cryptography basically has to do with how the keys are used.</p>
<p>With symmetric key cryptography, a single secret key is used both to encrypt and to 
decrypt the data.&nbsp; Thus, both parties to the communication must have access 
to the same secret key value.&nbsp; The distribution and management of such 
secret keys can be 
problematic, and has probably been a source of work for spies throughout 
history.</p>
<p>With asymmetric key cryptography, there are two keys.&nbsp; One is used to 
encrypt the data and the other is used to decrypt the data.&nbsp; Thus, one of 
the keys <i>(the encryption key)</i> can be publicly known without compromising 
secrecy so long as the other key <i>(the decryption key)</i> is held secret.&nbsp; 
This leads to the common name of <i>public key cryptography.</i></p>
<p>Many of the key-management and distribution problems associated with 
symmetric key cryptography are alleviated through the use of public key 
cryptography.</p>
<p><font color="#FF0000"><b>The RSA algorithm</b></font></p>
<p>This and the next several lessons will deal with a particular asymmetric key 
algorithm known as the <a href="http://theory.lcs.mit.edu/~rivest/rsapaper.pdf">
RSA</a> algorithm.&nbsp; This algorithm is named after the original authors, R.L. 
Rivest, A. Shamir, and L. Adleman.</p>
<p>If this lesson sparks your interest in cryptography, you will most certainly 
want to read their <a href="http://theory.lcs.mit.edu/~rivest/rsapaper.pdf">
paper</a> describing the algorithm in full.</p>
<p><font color="#FF0000"><b>Key management</b></font></p>
<p>In their paper, the authors point out that <i>&quot;... publicly revealing an 
encryption key does not thereby reveal the corresponding decryption key.</i></p>
<p>One consequence of this is a significant easing of key management problems relative to 
symmetric key cryptography.&nbsp; For example, couriers or other secure means 
are not needed to exchange keys.&nbsp; The sender of the message can encipher 
the message using the intended recipient's public encryption key.&nbsp; However, 
only the intended recipient can decipher the message using his private and 
secret decryption key.</p>
<p><font color="#FF0000"><b>Message signing and digital signatures</b></font></p>
<p>A second important consequence is that a message can be <i>&quot;signed&quot;</i> using 
a privately held key.&nbsp; The signature can be verified using the 
corresponding publicly revealed key.</p>
<p>I will discuss the Java implications of this in the next lesson in this 
series.</p>
<p><font color="#FF0000"><b>The mathematical process</b></font></p>
<p>Here is the author's brief description of the mathematical encryption process 
embodied in the RSA algorithm:</p>
<blockquote>
	<p><i>&quot;A message is encrypted by representing it as a number M, raising M to 
	a publicly specified power e, and then taking the remainder when the result 
	is divided by the publicly specified product, n, of two large secret prime 
	numbers p and q.&nbsp; Decryption is similar; only a different, secret, 
	power d is used.&quot;</i></p>
</blockquote>
<p>As you will see, Java is particularly well suited to the implementation of 
this process through the use of methods of the <b>BigInteger</b> class.</p>
<p><font color="#FF0000"><b>What about security?</b></font></p>
<p>I will defer the question of security to the authors of the algorithm and 
others who have published material in this area.&nbsp; However, the authors do point out that <i>&quot;The security of the system rests in part on 
the difficulty of factoring the published divisor, n.&quot;</i>&nbsp; Thus, in 
practice, parameters should be used that cause the value of n to be very large 
with a large number of pairs of factors.</p>
<blockquote>
	<p><i>(The programs that I will provide in this lesson are for instructional 
	purposes only, and do not support large values of n.&nbsp; Therefore, you 
	should not use them to encrypt your confidential data and expect your 
	secrets, such as credit card numbers, to be secure from attack.)</i></p>
</blockquote>
<h2 align="center"><a name="Preview">Preview</a></h2>
<p><font color="#FF0000"><b>Creating the keys</b></font></p>
<p>The RSA encryption algorithm consists of two major parts.&nbsp; One part 
involves performing the mathematical operations required to create the two keys, 
e and d, and the divisor n.&nbsp; Although not difficult to program, this is the most 
obscure part from the viewpoint of understanding the algorithm.&nbsp; This 
operation only has to be done once to 
establish the public/private key pair and the divisor for each individual user.</p>
<p><font color="#FF0000"><b>Using the keys</b></font></p>
<p>The second part involves using the two keys and the divisor to encipher and 
decipher messages.&nbsp; This must be done for each message, and therefore is 
an area where computational efficiency may be of concern.</p>
<p>The programs 
that I will provide to perform this operation have not been optimized for 
efficiency.&nbsp; Rather, they were written for instructional purposes only.&nbsp; As 
mentioned earlier, you should not attempt to use these programs for production 
cryptography.&nbsp; If you need a Java program to do public-key 
cryptography, you should develop that program using Sun's 
<a href="http://java.sun.com/j2se/1.4.2/docs/guide/security/jce/JCERefGuide.html">Java Cryptography 
Extension</a>.</p>
<p><font color="#FF0000"><b>Which approach is most efficient?</b></font></p>
<p>I have read that symmetric algorithms tend to be more computationally efficient than 
asymmetric algorithms for cases involving large amounts of data.&nbsp; I can 
neither confirm nor deny that.&nbsp; However, I am aware that in some business 
transactions involving large amounts of data, an asymmetric approach is used first to 
distribute a secret symmetric key to both parties and the encryption/decryption process then switches to 
the use of a symmetric key algorithm.</p>
<p><font color="#FF0000"><b>The first of four programs</b></font></p>
<p>I will present and discuss four programs in this lesson.&nbsp; The first 
program named <b>Rsa07</b> will illustrate the RSA algorithm from a very intuitive viewpoint 
requiring no knowledge of advanced mathematics or advanced numerical methods.&nbsp; 
This approach should be understandable by anyone having a basic knowledge of 
Java programming.&nbsp; This program uses <b>long</b> arithmetic and is 
therefore very limited in the size of problems that it can handle due to 
arithmetic overflow issues.</p>
<p><font color="#FF0000"><b>The second program named Rsa08</b></font></p>
<p>The second program is essentially a conversion of the first program from <b>
long</b> arithmetic to <b>BigInteger</b> arithmetic.&nbsp; This eliminates the 
issue of arithmetic overflow and introduces you to the use of the <b>
BigInteger</b> class.</p>
<p>With this program, the maximum size problem that you 
can solve depends on how long you are willing to wait for a solution to develop.&nbsp; 
On my computer, a few seconds are required to reach a solution for n = 77.&nbsp; 
I have never had the patience to wait for the solution for n = 399.</p>
<p>Realistically speaking, even a value for n of 399 is a very small problem for 
real-world cryptography.&nbsp; The inefficiency of this intuitive solution points out the need for 
using the 
more sophisticated computational approach provided by the
<a href="http://theory.lcs.mit.edu/~rivest/rsapaper.pdf">authors</a> of the RSA 
algorithm.</p>
<p><font color="#FF0000"><b>The third program named Rsa01</b></font></p>
<p>The third program extends and completes a small example that is presented in 
incomplete form by the original
<a href="http://theory.lcs.mit.edu/~rivest/rsapaper.pdf">authors</a> of the RSA 
algorithm.</p>
<p>This program uses predetermined keys and a Java implementation to encrypt and 
decrypt a short message with a block size of 4 and n equal to 2773.&nbsp; This 
program introduces and explains the issue of message coding and decoding and 
uses a fairly restrictive character set consisting of the space character and 
the twenty-six upper-case alphabetic characters.</p>
<p><font color="#FF0000"><b>The fourth program named Rsa03</b></font></p>
<p>The fourth program is more general and includes the ability to compute and 
apply the encryption keys for a character set that includes ninety-five of the 
most commonly used text characters.&nbsp; The version of the program that I will 
explain is purposely limited to a block size and key length of six characters.</p>
<blockquote>
	<p><i>(Note that a six-character key length is quite small from a security 
	viewpoint.&nbsp; People who analyze the security aspects of the RSA 
	algorithm like to talk about block sizes and key lengths of 100 or more 
	characters for acceptable security.)</i></p>
</blockquote>
<p>This program uses a Java implementation of the
<a href="http://theory.lcs.mit.edu/~rivest/rsapaper.pdf">algorithm</a> provided 
by the original 
<a href="http://theory.lcs.mit.edu/~rivest/rsapaper.pdf">authors</a> of the RSA 
algorithm for the computation of the keys e and d and for the common divisor n.</p>
<p>This program is suitable for experimenting with different block sizes, 
different divisors, different values for the keys, etc.</p>
<p>The next lesson in this series will extend the fourth program to support the 
concept of digital signatures.</p>
<h2 align="center"><a name="Discussion_and_Sample_Code">Discussion and Sample 
Code</a></h2>
<p><font color="#FF0000"><b>The first program</b></font></p>
<p>The purpose of the program named <b>Rsa07</b> is to illustrate the RSA algorithm from a very 
intuitive viewpoint requiring no knowledge of advanced mathematics or advanced 
numerical methods.&nbsp; As mentioned earlier, this approach should be understandable by anyone having 
a basic knowledge of Java programming.</p>
<p><font color="#FF0000"><b>Simultaneous equations</b></font></p>
I will begin my discussion of this program by describing an analogous situation 
in a different field.&nbsp; The analogy is the determination of the unknown 
values in a set of simultaneous equations.<p>Most people who work in a technical 
field know how to solve for the unknowns in a set of three simultaneous 
equations with three unknowns.&nbsp; There are several ways to do this.&nbsp; 
Many of those people are familiar with a solution involving matrix inversion 
commonly referred to as the use of determinants.</p>
<p><font color="#FF0000"><b>Matrix inversion is a solution</b></font></p>
<p>Once a person understands that you can solve three simultaneous equations 
using matrix inversion, it's not much of a stretch for the same person to also 
understand that you can also solve much larger sets of simultaneous equations 
using matrix inversion.&nbsp; Thus, that person has an intuitive knowledge of how 
to solve for the unknowns in large sets of simultaneous equations involving many more unknowns.</p>
<p><font color="#FF0000"><b>The difference is in the doing</b></font></p>
<p>However, there is a very large difference between having an intuitive 
knowledge of how to solve a set of fifty simultaneous equations using 
matrix inversion and actually doing it.&nbsp; Inverting the 3x3 matrix required 
to solve the small problem is much different from inverting the 50x50 matrix 
required to solve the larger problem.&nbsp; The 3x3 matrix can be inverted using 
pencil, paper, and a procedure that most of us learned in high school.&nbsp; 
Inverting the 50x50 matrix requires more sophisticated tools.&nbsp; In 
all probability, that person will need to consult a textbook or other reputable 
source to learn how to invert large matrices.</p>
<p>In addition, even though the person may learn to implement the algorithm to 
invert the larger matrix, without a great deal of study, it is unlikely that the person will ever really 
understand why it work the way that it does.</p>
<p><font color="#FF0000"><b>The important point</b></font></p>
<p>The important point is, even though that person may never fully understand 
how the algorithm for inverting the large matrix works, the fact that the person 
has developed an intuitive knowledge of how to solve the small problem using 
matrix inversion causes the person to also have an intuitive knowledge of how to 
solve the larger problem.&nbsp; The large-matrix inversion algorithm is nothing 
more than a tool to help the person achieve a solution for a problem for which 
he already has an intuitive understanding.</p>
<p><font color="#FF0000"><b>Why am I telling you this?</b></font></p>
<p>Unless you have a penchant for advanced mathematics, you may never truly 
understand how the RSA algorithm, as presented by the original 
<a href="http://theory.lcs.mit.edu/~rivest/rsapaper.pdf">authors</a>, actually 
works, particularly with respect to the creation of the keys and the divisor.&nbsp; 
However, my hope is to give you an intuitive understanding of how the RSA algorithm 
works based on the first two programs.&nbsp; The first program explains the 
algorithm using an approach that should be understandable by anyone having a 
fundamental knowledge of Java program.&nbsp; This program is clearly 
limited to the solution of small problems due to arithmetic overflow issues.</p>
<p><font color="#FF0000"><b>A little more Java knowledge is required</b></font></p>
<p>The second program extends the first program by using a particular Java class 
named <b>BigInteger</b> to eliminate the problem of arithmetic overflow.&nbsp; 
Otherwise, the second program behaves just like the first.</p>
<blockquote>
	<p><i>(In theory, at 
least, you could use the second program to find the keys for an 
RSA system of any size if your computer is fast enough and if you have enough 
patience.&nbsp; However, you may be measuring solution times on the order of 
years of computer time to develop keys for problems sufficiently large to 
provide reasonable cryptographic security.&nbsp; In other words, the second 
	program is very useful for instructional purposes, but is impractical for 
	developing actual RSA systems.)</i></p>
</blockquote>
<p>Once you gain the intuitive understanding of how the RSA algorithm works, you 
can move on to the third and fourth programs, which use the original 
<a href="http://theory.lcs.mit.edu/~rivest/rsapaper.pdf">authors'</a> 
procedure for creating keys and divisors.&nbsp; You can think of this procedure much 
the same way that you think of a large-matrix inversion program; simply as a tool 
for solving a large problem in a reasonable amount of time</p>
<p><font color="#FF0000"><b>Will discuss in fragments</b></font></p>
<p>As is usually the case, I will discuss and explain these programs in 
fragments.&nbsp; Complete listings of all four programs are presented in Listing 
45 through Listing 48 near the end of the lesson.</p>
<p><font color="#FF0000"><b>The program named Rsa07</b></font></p>
<p>Before getting into the code for the program, the screen output produced by 
the program is shown in Figure 1.<br>
</p>
<table border="1" cols="1" width="400" bgcolor="#ccffff">
  <tbody>
    <tr>
      <td>
      <pre><b>n = 14
Range for m: 0 to 13
Range for e: 0 to 13
Range for d: 0 to 13
Allowable keys
d:11-e:5
d:13-e:7
d:5-e:11
d:7-e:13</b><br></pre>
      <pre><b>Figure 1</b></pre>
      </td>
    </tr>
  </tbody>
</table>
<p>I will refer back to this figure while discussing the behavior of this 
program.</p>
<p><font color="#FF0000"><b>Fundamental RSA behavior</b></font></p>
<p>The most fundamental concept in the RSA algorithm is shown in Figure 2.<br>
</p>
<table border="1" cols="1" width="400" bgcolor="#ccffff">
  <tbody>
    <tr>
      <td>
      <div align="left">
      <pre><b>Given a message (or portion of a message)
represented by an integer value m, the message 
can be encrypted into a cipher value by applying 
the following transformation:

c = (m^e)%n

where ^ is the exponentiation operator
      % is the modulus operator
      e is the encryption key
      n is an integer constant divisor

Given the cipher value which is represented by
the integer value c, the cipher can be 
transformed back into the original message value
by applying the following transformation:

m = (c^d)%n

where d is the decryption key
      n is the same integer constant divisor
      </b><br></pre>
      </div>
      <pre><b>Figure 2 The RSA algorithm</b></pre>
      </td>
    </tr>
  </tbody>
</table>
<p><font color="#FF0000"><b>Encryption and decryption are not difficult</b></font></p>
<p>As you can see, the encryption and decryption transformations are not 
computationally difficult.&nbsp; In fact, they are especially easy using the <b>
BigInteger</b> class in Java, <i>(which may have been designed with applications 
such as this in mind).</i></p>
<p><font color="#FF0000"><b>The difficult part</b></font></p>
<p>The difficult part is determining the correct values for e, d, and n for 
message values and key lengths on the order of 100 digits.&nbsp; The first program 
named <b>Rsa07</b> will 
illustrate a relatively easy iterative approach to determining those values for 
message values having a maximum of two digits.</p>
<blockquote>
	<p><i>(As indicated earlier, the 
purpose is to give you an intuitive understanding of the concepts involved in 
order to prepare you for the more abstract approach that is used to solve larger 
problems.)</i></p>
</blockquote>
<p><font color="#FF0000"><b>A simple and intuitive solution</b></font></p>
<p>This program provides a very simple and intuitive solution of the RSA 
encryption algorithm.&nbsp; The program uses iteration along with 
trial-and-error to determine all of the 
non-duplicate values for e and d that can be used in combination to encrypt and 
decrypt message values ranging from 0 through n-1 inclusive when n has a value 
of 14.&nbsp; Both e and d are constrained to have values of 13 or less. </p>
<p><font color="#FF0000"><b>Reciprocal pairs</b></font></p>
<p>Referring back to the screen output shown in Figure 1, you will note that the 
four allowable combinations for e and d occur as two reciprocal pairs.&nbsp; 
This confirms that either key can be used to encrypt with the other key being 
use to decrypt.</p>
<p>Note that this program purposely excludes from the output all combinations of 
d and e for which d equals e.</p>
<p>The program was tested using SDK 1.4.2 under WinXP.</p>
<p><font color="#FF0000"><b>The main method</b></font></p>
<p>The controlling class and the <b>main</b> method for <b>Rsa07</b> begin in Listing 1.</p>
<p>
<table border="1" cols="1" width="400" bgcolor="#ffff00">
  <tbody>
    <tr>
      <td>
      <pre>class Rsa07{
  public static void main(String&#91;&#93; args){

    long e;//encryption key
    long d;//decryption key
    long n = 14;//fixed divisor
    long c;//encrypted value
    long x;//decrypted value

    Vector base = new Vector();
    Vector temp = new Vector();<br><br><b><font face="Courier New,Courier">Listing 1</font></b></pre>
      </td>
    </tr>
  </tbody>
</table>
</p>
<p>The code in Listing 1 simply declares variables that will be used later, and 
populates some of them.&nbsp; In particular, the value for n is set to 14 and 
remains at that value throughout the execution of the program.</p>
<p><font color="#FF0000"><b>Display the setup information</b></font></p>
<p>Listing 2 displays the setup information shown at the top of Figure 1.&nbsp;</p>
<p>
<table border="1" cols="1" width="400" bgcolor="#ffff00">
  <tbody>
    <tr>
      <td>
      <pre>    System.out.println("n = " + n);
    System.out.println(
                 "Range for m: 0 to " + (n - 1));
    System.out.println(
                 "Range for e: 0 to " + (n - 1));
    System.out.println(
                 "Range for d: 0 to " + (n - 1));<br><br><b><font face="Courier New,Courier">Listing 2</font></b></pre>
      </td>
    </tr>
  </tbody>
</table>
</p>
<p><font color="#FF0000"><b>Triple nested loops</b></font></p>
<p>Listing 3 shows the beginning of a structure of three nested loops that 
try all combinations of m, d, and e <i>(for the ranges shown in Figure 1)</i> to 
determine which combinations satisfy the conditions specified in Figure 2.</p>
<p>Those combinations of d and e that satisfy the conditions for every value of m 
are retained.&nbsp; All other combinations are discarded.&nbsp; In addition, 
combinations that satisfy the conditions but for which d is equal to e are also 
discarded.</p>
<p>
<table border="1" cols="1" width="400" bgcolor="#ffff00">
  <tbody>
    <tr>
      <td>
      <pre>    for(long m = 1; m &lt; n; m++){
      for(e = 2; e &lt; n; e++){
        c = applyRSA(m,e,n);

<br><br><b><font face="Courier New,Courier">Listing 3</font></b></pre>
      </td>
    </tr>
  </tbody>
</table>
</p>
<p><font color="#FF0000"><b>Practical considerations</b></font></p>
<p>Listing 3 shows the beginnings of the loops for m and e.&nbsp; There is no 
need to begin the outer loop with m equal to 0.&nbsp; The algorithm will always 
produce an output of 0 for a message value of 0.</p>
<p>We aren't interested in values of either 0 or 1 for e.&nbsp; Raising any non-zero message 
value to a power of 0 produces 1.&nbsp; Raising a message value to a power of 1 
produces the message value, which is not very interesting from an encryption 
viewpoint.&nbsp; If a message were encrypted using a value of 1 for e, the 
encrypted message would look just like the unencrypted message.</p>
<p>Things get more interesting in the third line of Listing 3.&nbsp; This line 
invokes the method named <b>applyRSA</b> passing m, e, and n as parameters.</p>
<p><font color="#FF0000"><b>The applyRSA method</b></font></p>
<p>The<b> applyRSA</b> method is shown in its entirety in Listing 4.&nbsp; This 
method applies the RSA encryption algorithm to an input value using an input key 
and an input divisor.&nbsp; It returns the encrypted result as type <b>long</b>.</p>
<blockquote>
	<p><i>(This is the part of the program that has the potential for arithmetic 
	overflow if the program is run using large values of n.)</i></p>
</blockquote>
<p>
<table border="1" cols="1" width="400" bgcolor="#ffff00">
  <tbody>
    <tr>
      <td>
      <pre>  static long applyRSA(long val,long exp,long n){
    long temp = val;

    for(int cnt = 0; cnt < (exp - 1); cnt++){
      temp *= val;
      if(val >= (Long.MAX_VALUE/val - 1)){
        System.out.println(
                "Arithmetic overflow probable.");
        System.out.println(
                         "Terminating program.");
        System.exit(1);
      }//end if
    }//end for loop
    //Compute the modulus of the modified input
    // value using n as a modulus divisor.
    return temp % n;
  }//end applyRSA<br><br><b><font face="Courier New,Courier">Listing 4</font></b></pre>
      </td>
    </tr>
  </tbody>
</table>
</p>
<p><font color="#FF0000"><b>Discussion of the code</b></font></p>
<p>The <b>applyRSA</b> method begins by using a <b>for</b> loop to raise the value of <b>val</b> 
to the power given by <b>exp</b>.&nbsp; During each iteration, the method checks for the 
potential of arithmetic overflow during the next iteration.&nbsp; If arithmetic 
overflow is probable during the next iteration, the program prints an error 
message and terminates.</p>
<p>When the loop terminates normally, indicating that <b>val</b> has been raised 
to the correct power, the method uses the modulus operator to divide by n, 
discard the quotient, and return the remainder as type <b>long</b>.</p>
<p><font color="#FF0000"><b>Used for either encryption or decryption</b></font></p>
<p>This method can be used to execute either of the formulas shown in Figure 2.&nbsp; 
If the input parameters are m, e, and n, the method encrypts the message value 
into 
a cipher value.&nbsp; If the inputs are c, d, and n, the method decrypts a 
cipher value into a message value.</p>
<p><font color="#FF0000"><b>Test all values of d</b></font></p>
<p>Returning to the code in the <b>main</b> method, the innermost loop of the 
three loops begins in 
Listing 5.</p>
<p>
<table border="1" cols="1" width="400" bgcolor="#ffff00">
  <tbody>
    <tr>
      <td>
      <pre>        for(d=2;d < n;d++){
          x = applyRSA(c,d,n);
<br><b><font face="Courier New,Courier">Listing 5</font></b></pre>
      </td>
    </tr>
  </tbody>
</table>
</p>
<p>The purpose of this loop is to test all possible values of d in the specified 
range to see if a given value of d, along with the current values of e and m <i>
(previously established by the two outer loops)</i> will satisfy the conditions 
given in Figure 2.</p>
<p>The code in Listing 5 invokes the <b>applyRSA</b> method to decrypt the 
current cipher value using the current value of d.&nbsp; If this value of d is a 
valid decryption key, the value returned from the <b>applyRSA</b> method will 
match the current message value of m.</p>
<p><font color="#FF0000"><b>A process of elimination</b></font></p>
<p>The values of e and d that are valid encryption and decryption keys for all 
values of m are obtained through a process of elimination.&nbsp; This process 
needs to begin with a list containing all possible combinations of d and e 
within the specified ranges for d and e.</p>
<p>As it turns out, this list can be produced by processing a message value of 
1.&nbsp; The value 1 raised to any power is 1.&nbsp; The value 1 modulus n is 
also 1.&nbsp; Therefore, all combinations of d and e will successfully encrypt 
and decrypt a message value of 1.</p>
<p><font color="#FF0000"><b>Test the output against the message value</b></font></p>
<p>The code in Listing 6 is the beginning of a pair of nested <b>if</b> 
statements.&nbsp; If the decrypted output x is not equal to the message value m, 
then this value of d is not a valid decryption key and everything following 
within the loop is skipped.&nbsp; </p>
<p>
<table border="1" cols="1" width="400" bgcolor="#ffff00">
  <tbody>
    <tr>
      <td>
      <pre>          if(x == m){
            if(m == 1 && d != e){
              base.add(
                      "d:" + d + "-" + "e:" + e);
<br><b><font face="Courier New,Courier">Listing 6</font></b></pre>
      </td>
    </tr>
  </tbody>
</table>
</p>
<p>However, if x is equal to m, then a test is performed to determine if this 
test was performed on a message value of 1.&nbsp; If so, the values for d 
and e are encoded into a String and added to a <b>Vector</b> object referred to 
by the reference variable named <b>base</b>.&nbsp; When the first pass of the 
outer loop for m equal to 1 has completed processing, this vector will contain all 
combinations of d and e.</p>
<p><font color="#FF0000"><b>When m is not equal to 1</b></font></p>
<p>Listing 7 shows the <b>else</b> clause that goes with the <b>if</b> statement 
in Listing 6.&nbsp; This code is executed if x equals m but m is not equal to 1.&nbsp;
</p>
<p>
<table border="1" cols="1" width="400" bgcolor="#ffff00">
  <tbody>
    <tr>
      <td>
      <pre>            }else if(d != e){
              temp.add(
                      "d:" + d + "-" + "e:" + e);
            }//end else
          }//end if(x == m)
        }//end for loop on d
      }//end for loop on e<br><br><b><font face="Courier New,Courier">Listing 7</font></b></pre>
      </td>
    </tr>
  </tbody>
</table>
</p>
<p>The code in Listing 7 saves only those combinations of d and e that successfully encrypt and decrypt this value of m.&nbsp; 
The successful combinations are stored in a<b> Vector</b> object referred to by 
a reference variable named <b>temp</b>.</p>
<p><font color="#FF0000"><b>The process of elimination</b></font></p>
<p>The contents of this <b>Vector</b> will later be matched to the contents of 
the<b> Vector</b> referred to by<b> base</b>.&nbsp; Any combination contained in
<b>base</b> that is not also contained in <b>temp</b> will be removed from <b>base</b>.&nbsp; After all values of m have been processed, only those combinations of d and e that successfully encrypt and decrypt all values of m will remain in 
<b>base</b>.</p>
<p>Listing 7 also signals the end of the <b>for</b> loop on d and the <b>for</b> 
loop on e. </p>
<p><font color="#FF0000"><b>Invoke the andVectors method</b></font></p>
<p>At this point, control is still within the outer <b>for</b> 
loop on m.</p>
<p>If the value of m is greater than 1, the code in Listing 8 invokes the method 
named <b>andVectors</b> to remove all combinations of d and e from <b>base</b> 
that are not contained in <b>temp</b>.&nbsp; When all values of m have been 
processed, the only remaining values for d and e that will be contained in <b>
base</b> will be those values of e and d that are valid encryption and 
decryption keys for all values of m. </p>
<p>
<table border="1" cols="1" width="400" bgcolor="#ffff00">
  <tbody>
    <tr>
      <td>
      <pre>      if(m > 1){
        andVectors(base,temp);
      }//end if

      //Initialize a new empty temp Vector for
      // processing the next value of m.
      temp = new Vector();
    }//end for loop on m<br><br><b><font face="Courier New,Courier">Listing 8</font></b></pre>
      </td>
    </tr>
  </tbody>
</table>
</p>
<p><font color="#FF0000"><b>A new empty temp Vector</b></font></p>
<p>The code in Listing 8 also instantiates a new empty <b>temp</b> <b>Vector</b> 
object that used 
to process the next value of m.</p>
<p>Listing 8 also signals the end of the 
outer loop on m.&nbsp; If all values of m have been processed, control will 
transfer to Listing 10, which will display the remaining combinations of d and e 
in the <b>base</b> vector.&nbsp; Otherwise, control will return to the top of 
the loop and the next value for m will be processed.</p>
<p><font color="#FF0000"><b>The andVectors method</b></font></p>
<p>This method, which is shown in Listing 9, performs a logical <b>and</b> 
operation between the <b>base</b> vector and the <b>temp</b> vector, removing 
all combinations of d and e from <b>base</b> that are not also contained in <b>
temp</b>.&nbsp; This leaves only those elements in <b>base</b> that are 
contained in both <b>base</b> and <b>temp</b>.</p>
<p>
<table border="1" cols="1" width="400" bgcolor="#ffff00">
  <tbody>
    <tr>
      <td>
      <pre>  static void andVectors(
                        Vector base,Vector temp){
    Iterator iter = base.iterator();
    while(iter.hasNext()){
      //Get next element from base.
      Object str = iter.next();

      //Test to see if temp contains a matching
      // element.  Remove the element from base
      // if there is no match.
      if(!temp.contains(str)){
        iter.remove();
      }//end if
    }//end while
  }//end andVectors<br><br><b><font face="Courier New,Courier">Listing 9</font></b></pre>
      </td>
    </tr>
  </tbody>
</table>
</p>
<p>The code in Listing 9 is straightforward, and the comments should make the 
code self explanatory.&nbsp; Therefore, I won't discuss that code further.</p>
<p><font color="#FF0000"><b>Display the final results</b></font></p>
<p>Returning now to the discussion of <b>main</b>, after all values for m have 
been processed, the code in Listing 10 displays the combinations of d and e that 
remain in the <b>base</b> vector.&nbsp; The display format is shown in Figure 1.
</p>
<p>
<table border="1" cols="1" width="400" bgcolor="#ffff00">
  <tbody>
    <tr>
      <td>
      <pre>    System.out.println("Allowable keys");
    Iterator iter = base.iterator();
    while(iter.hasNext()){
      String str = (String)iter.next();
      System.out.println(str);
    }//end while

  }//end main<br><br><b><font face="Courier New,Courier">Listing 10</font></b></pre>
      </td>
    </tr>
  </tbody>
</table>
</p>
<p>Once again, the code in Listing 10 is straightforward so I won't discuss it 
further.</p>
<p>Listing 10 also signals the end of the <b>main</b> method and the end of the 
program named <b>Rsa07</b>.</p>
<p><font color="#FF0000"><b>Different values for n</b></font></p>
<p>If you decide to run this program for different values of n, you should note that there is no valid solution for some values of n.&nbsp; In that case, the list of allowable keys presented by the program will simply be blank.</p>
<p>I have also noticed that for some values of n, the code that checks for 
potential arithmetic overflow throws an <i>ArithmeticException: / by zero.&nbsp;
</i>However, since it didn't throw the error for the value of n that I was 
primarily interested in, and because that situation doesn't occur in the 
improved version <i>(<b>Rsa08</b>)</i> I didn't bother to find and fix that problem.&nbsp; If that proves to be a problem for you, I recommend 
that you experiment with <b>Rsa08</b> instead of <b>Rsa07</b>.</p>
<p><font color="#FF0000"><b>The program named Rsa08</b></font></p>
<p>The output produced by the program named <b>Rsa08</b> is shown in Figure 3.<br>
</p>
<table border="1" cols="1" width="400" bgcolor="#ccffff">
  <tbody>
    <tr>
      <td>
      <pre><b>n = 77
Range for m: 0 to 76
Range for e: 0 to 76
Range for d: 0 to 76
Allowable keys
d:13-e:7
d:43-e:7
d:73-e:7
d:41-e:11
d:71-e:11
d:7-e:13
d:37-e:13
d:67-e:13
d:23-e:17
d:53-e:17
d:49-e:19
d:17-e:23
d:47-e:23
d:59-e:29
d:61-e:31
d:13-e:37
d:43-e:37
d:73-e:37
d:11-e:41
d:71-e:41
d:7-e:43
d:37-e:43
d:67-e:43
d:23-e:47
d:53-e:47
d:19-e:49
d:17-e:53
d:47-e:53
d:29-e:59
d:31-e:61
d:13-e:67
d:43-e:67
d:73-e:67
d:11-e:71
d:41-e:71
d:7-e:73
d:37-e:73
d:67-e:73</b><br></pre>
      <pre><b>Figure 3</b></pre>
      </td>
    </tr>
  </tbody>
</table>
<p><font color="#FF0000"><b>Considerably different output</b></font></p>
<p>As you can see, this output is considerably different from the output 
produced by the program named <b>Rsa07</b> shown in Figure 1 <i>(although the 
overall format of the two outputs is the same).</i>&nbsp; To begin with, the output 
in Figure 3 corresponds to a value of 77 for n whereas the output in Figure 1 
corresponds to a value of 14 for n.&nbsp; In addition, the ranges for m, e, and d 
in Figure 3 extend from 0 through 76 inclusive whereas the ranges for the same 
items in Figure 1 extend from 0 to 13 inclusive.</p>
<p><font color="#FF0000"><b>The biggest difference</b></font></p>
<p>Perhaps the biggest difference is the increase in the number of allowable key combinations 
in Figure 3 as compared to Figure 1.&nbsp; 
For the set of parameters shown in Figure 3, there are 38 allowable key combinations as 
compared to only two for the parameters in Figure 1.&nbsp; This increase derives 
solely from the increased value for n and the increased range for m, e, and d.</p>
<p><font color="#FF0000"><b>Elimination of arithmetic overflow problems</b></font></p>
<p>The computational structure of the two programs is the same.&nbsp; However,
<b>Rsa08</b> uses <b>BigInteger</b> arithmetic <i>(as opposed to <b>long</b> 
arithmetic) </i>to eliminate the arithmetic overflow issue that is a limiting factor for
<b>Rsa07</b>.</p>
<p>In theory, you could run this program for as large a value of n as you may 
desire.&nbsp; However, if you use a very large value of n, the program will 
require an exceptionally long time to produce a solution.&nbsp; Therefore, using 
this program for large values of n is not practical.</p>
<p><font color="#FF0000"><b>Excludes output for e equal to d</b></font></p>
<p>As with the program named <b>Rsa07</b>, this program purposely excludes all combinations 
of d and e for which d equals e.&nbsp; Also, as was mentioned regarding <b>Rsa07</b>, the solutions occur in reciprocal value pairs. 
So there are really only 19 unique combinations of d and e in the output shown 
in Figure 3.</p>
<p><font color="#FF0000"><b>The BigInteger class</b></font></p>
<p>The primary difference between this program and the program named <b>Rsa07</b> 
is the use of the methods of the <b>BigInteger</b> class to perform 
arithmetic and to maintain integer values.&nbsp; In comparison, all of the 
integer arithmetic in <b>Rsa07</b> is performed using type <b>long</b>.</p>
<p>As I mentioned in the discussion for <b>Rsa07</b>, that program is subject to 
arithmetic overflow for values of n above about 14.&nbsp; In theory, the use of <b>
BigInteger</b> arithmetic in this program eliminates the possibility of such 
arithmetic overflow.</p>
<p><font color="#FF0000"><b>What does Sun have to say?</b></font></p>
<p>Here is part of what Sun has to say about the <b>BigInteger</b> class:</p>
<blockquote>
	<p><i>&quot;Immutable arbitrary-precision integers. All operations behave as if 
	BigIntegers were represented in two's-complement notation (like Java's 
	primitive integer types). BigInteger provides analogues to all of Java's 
	primitive integer operators, and all relevant methods from java.lang.Math. 
	Additionally, BigInteger provides operations for modular arithmetic, GCD 
	calculation, primality testing, prime generation, bit manipulation, and a 
	few other miscellaneous operations.&quot;</i></p>
</blockquote>
<p>Some of the extra methods mentioned by Sun in the above quotation are exactly 
what the doctor ordered for the type of programming being done here.&nbsp; <i>(It is almost as 
if Sun defined the <b>BigInteger</b> class with cryptography in mind.)</i></p>
<p><font color="#FF0000"><b>Program conversion</b></font></p>
<p>The conversion of the program named <b>Rsa07</b> to the program <b>Rsa08</b> 
mainly 
involved the substitution of <b>BigInteger</b> method calls for the integer 
operations in <b>Rsa07</b>.&nbsp; </p>
<p>Because the control structure of this program, which you will find in Listing 
46 near the end of the lesson, is essentially the same as the control structure of <b>
Rsa07</b>, I won't discuss this program in detail.&nbsp; Rather, I will simply 
highlight some of the code that illustrates the use of the <b>BigInteger</b> 
class.</p>
<p><font color="#FF0000"><b>Variable declarations</b></font></p>
<p>I will begin with the declaration of variables and the population of some of 
those variables in
<b>main</b> as shown in Listing 11.</p>
<p>
<table border="1" cols="1" width="400" bgcolor="#ffff00">
  <tbody>
    <tr>
      <td>
      <pre>    BigInteger e;//encryption key
    BigInteger d;//decryption key
    BigInteger n = new BigInteger("77");
    BigInteger c;//encrypted value
    BigInteger x;//decrypted value
    BigInteger bigOne = new BigInteger("1");<br><br><b><font face="Courier New,Courier">Listing 11</font></b></pre>
      </td>
    </tr>
  </tbody>
</table>
</p>
<p><font color="#FF0000"><b>Operations on objects</b></font></p>
<p>A couple of things are worthy of note in Listing 11.&nbsp; First, <b>
BigInteger</b> is the name of a class rather than the name of a primitive type.&nbsp; 
Therefore, all <b>BigInteger</b> operations are operations on objects rather than operations on 
primitives.</p>
<p>For example, to initialize the variable named n in Listing 11, it was 
necessary to instantiate a new 
object of the <b>BigInteger</b> class.&nbsp; That object's reference was 
assigned to the 
reference variable named n.</p>
<p>Further, when the object was instantiated, it was initialized using an integer 
value of 77 expressed as a <b>String</b>.</p>
<p><font color="#FF0000"><b>Input and output for BigInteger objects</b></font></p>
<p>As a practical matter, the input 
and output to <b>BigInteger</b> objects is in the form of strings of numeric 
characters of arbitrary length <i>(or arrays of bytes as an alternative to 
strings).</i></p>
<blockquote>
	<p><i>(While it is possible to extract an <b>int</b> value from a <b>
	BigInteger</b> object, it is very likely that the value will be too large to 
	fit in either an <b>int</b> or a <b>long</b> and you will simply end up with 
	garbage.&nbsp; Therefore, you need to be extremely careful when you do that.</i></p>
	<p><i>To extract the contents of a <b>BigInteger</b> object as a string of 
	numeric characters of arbitrary length, simply invoke the <b>toString</b> 
	method on the object.)</i></p>
</blockquote>
<p><font color="#FF0000"><b>A BigInteger object is immutable</b></font></p>
<p>In case you are unfamiliar with the term <i>immutable,</i> this means that 
once you have populated a <b>BigInteger</b> object, its contents cannot be 
modified.&nbsp; If you need to change the encapsulated value, you simply need to 
replace the current object with a new object that encapsulates the new value.</p>
<p><font color="#FF0000"><b>The bigOne variable</b></font></p>
<p>Many of the operations in this program involve adding or subtracting a value 
of 1 from a <b>BigInteger</b> object.&nbsp; Therefore, Listing 11 instantiates a
<b>BigInteger</b> object that encapsulates the integer value 1 and assigns its 
reference to the reference variable named <b>bigOne</b>.&nbsp; This will save a 
lot of typing later on.</p>
<p><font color="#FF0000"><b>The subtract method</b></font></p>
<p>Listing 12 illustrates the use of the <b>subtract</b> method of the <b>
BigInteger</b> class to subtract the contents of one <b>BigInteger</b> object 
from another <b>BigInteger</b> object.&nbsp; </p>
<p>
<table border="1" cols="1" width="400" bgcolor="#ffff00">
  <tbody>
    <tr>
      <td>
      <pre>    System.out.println("n = " + n);
    System.out.println("Range for m: 0 to "
                         + (n.subtract(bigOne)));
    System.out.println("Range for e: 0 to "
                         + (n.subtract(bigOne)));
    System.out.println("Range for d: 0 to "
                         + (n.subtract(bigOne)));<br><br><b><font face="Courier New,Courier">Listing 12</font></b></pre>
      </td>
    </tr>
  </tbody>
</table>
</p>
<p>The first statement in Listing 12 simply displays the value encapsulated in 
the <b>BigInteger</b> object referred to by the reference variable named n.&nbsp; 
This produces the first line of output shown in Figure 3.</p>
<p>The remaining three statements in Listing 12 subtract a value of 1 from the
<b>BigInteger</b> objects referred to by n and display the result as a part of a 
larger overall print statement.&nbsp; The four statements in Listing 12 produce 
the first four lines of output text shown in Figure 3.</p>
<p><font color="#FF0000"><b>Setting up a for loop</b></font></p>
<p>Listing 13 illustrates the use of the methods of the<b> BigInteger</b> class 
to construct the beginnings of a pair of nested <b>for</b> loops.&nbsp; These 
loops iterate for all values of m from 1 to n-1 and for all values of e from 2 to 
n-1.</p>
<blockquote>
	<p><i>(Compare Listing 13 with Listing 3 to see how <b>BigInteger</b> 
	programming compares with simple integer programming using type <b>long</b>.)</i></p>
</blockquote>
<p>
<table border="1" cols="1" width="400" bgcolor="#ffff00">
  <tbody>
    <tr>
      <td>
      <pre>    for(BigInteger m = new BigInteger("1");
          m.compareTo(n) < 0; m = m.add(bigOne)){
      for(e = new BigInteger("2");
          e.compareTo(n) < 0; e = e.add(bigOne)){
        c = applyRSA(m,e,n);<br><br><b><font face="Courier New,Courier">Listing 13</font></b></pre>
      </td>
    </tr>
  </tbody>
</table>
</p>
<p><font color="#FF0000"><b>The compareTo method</b></font></p>
<p>The ability to perform relational operations on <b>BigInteger</b> objects 
involves the use of the <b>compareTo</b> method.&nbsp; Here is part of what Sun 
has to say about that method:</p>
<blockquote>
	<p><i>&quot;Compares this BigInteger with the specified BigInteger.&nbsp; This 
	method is provided in preference to individual methods for each of the six 
	boolean comparison operators (&lt;, ==, &gt;, &gt;=, !=, &lt;=). The suggested idiom for 
	performing these comparisons is: <tt>(x.compareTo(y)</tt> &lt;op&gt; <tt>0)</tt>, 
	where &lt;op&gt; is one of the six comparison operators.&quot;</i></p>
</blockquote>
<p>This is the syntax used in the conditional clauses in the <b>for</b> loops in 
Listing 13.&nbsp; Listing 13 also illustrates the use of the <b>add</b> method 
to increment the loop counters.&nbsp; </p>
<p><font color="#FF0000"><b>Compare the two programs</b></font></p>
<p>If you do a side-by-side comparison of the code for <b>Rsa07</b> in Listing 
45 and <b>Rsa08</b> in Listing 46, you should have no difficulty understanding 
the remainder of the code in the program named <b>Rsa08</b>.</p>
<blockquote>
	<p><i>(Note that the code in <b>Rsa08</b> makes use of some other interesting 
	methods of the <b>BigInteger </b>class, such as <b>modPow, </b>which I will 
	discuss in conjunction with the program named <b>Rsa01</b>.)</i></p>
</blockquote>
<p>Once again, if you decide to experiment with different values for n, you 
should use the program named <b>Rsa08</b> for such experimentation in order to 
avoid the arithmetic overflow issues manifested by <b>Rsa07</b>.</p>
<p><font color="#FF0000"><b>The program named Rsa01</b></font></p>
<p>As explained earlier, this program extends and completes a small example that 
is presented in incomplete form by the original
<a href="http://theory.lcs.mit.edu/~rivest/rsapaper.pdf">authors</a> of the RSA 
algorithm.&nbsp; This program uses predetermined keys and a Java implementation to 
encrypt and decrypt a short message with a block size of 4 and n equal to 2773.</p>
<p>This program introduces and explains the issue of message coding and decoding 
and uses a fairly restrictive character set consisting of the space character 
and the twenty-six upper-case alphabetic characters.</p>
<p><font color="#FF0000"><b>The program output</b></font></p>
<p>A complete listing of this program is shown in Listing 47 near the end of the 
lesson.&nbsp; The program was tested using Sun's Java SDK 1.4.2 under WinXP, 
producing the output shown in Figure 4.</p>
<blockquote>
	<p><i>(Note that the plainText or input text string was extended by one 
	space character to make it evenly divisible by 4.)</i></p>
</blockquote>
<table border="1" cols="1" width="400" bgcolor="#ccffff">
  <tbody>
    <tr>
      <td>
      <pre><b>p: 47
q: 59
n: 2773
d: 157
e: 17
plainText
ITS ALL GREEK TO ME
encodedText
0920190001121200071805051100201500130500
cipherText
0948234210841444266323900778077402191655
decipheredText
0920190001121200071805051100201500130500
outputText
ITS ALL GREEK TO ME</b><br></pre>
      <pre><b>Figure 4</b></pre>
      </td>
    </tr>
  </tbody>
</table>
<p><font color="#FF0000"><b>Encoding and decoding the message text</b></font></p>
<p>Up to this point in this lesson, I haven't discussed anything about the text 
of the message being encrypted and decrypted.&nbsp; The RSA encryption algorithm 
is described in Figure 2, and is based solely on the use of a numeric input to 
produce a numeric output.&nbsp; Therefore, to make use of the RSA algorithm, you must 
devise a way to encode the text of your message into numeric form before 
encryption.&nbsp; You must then decode the numeric output from the decryption 
process using a reverse methodology to produce the original text of the message.</p>
<blockquote>
	<p><i>(Note however that there may be filler characters at the end of the 
	decrypted message.&nbsp; This is one approach to dealing with the reality 
	that the length of the encoded version of the message may not be an even 
	multiple of the block size.)</i></p>
</blockquote>
<p><font color="#FF0000"><b>Stream ciphers versus block ciphers</b></font></p>
<p>Now that I have mentioned the block size, I need to provide some background 
information to explain what I mean.&nbsp; Here is a little of what
<a href="http://en.wikipedia.org/wiki/Cryptography">Wikipedia</a> has to say on 
the subject:</p>
<blockquote>
	<p><i>&quot;... ciphers can be broadly grouped into
	<a title="Block cipher" href="http://en.wikipedia.org/wiki/Block_cipher">
	block ciphers</a> and
	<a title="Stream cipher" href="http://en.wikipedia.org/wiki/Stream_cipher">
	stream ciphers</a>. Stream ciphers encrypt one bit at a time, in contrast to 
	a block cipher, which operates on a group of bits (a &quot;block&quot;) of a certain 
	length all in one go.&quot;</i></p>
</blockquote>
<p>You can follow the links in the above quotation to learn more about the two 
types of ciphers.</p>
<p><font color="#FF0000"><b>RSA as a block cipher</b></font></p>
<p>As I understand it, the RSA algorithm must be implemented as a block cipher if the original 
message is of any significant length.&nbsp; As mentioned above, the original text message 
must be encoded 
into a string of digits.&nbsp; In my implementation, the string of digits is 
subdivided into equal length segments of length <b>blockSize</b>.</p>
<p>One such 
segment forms the <i>message</i> referred to as <b><i>m</i></b> in Figure 2.&nbsp; 
The entire encryption process involves applying the RSA algorithm separately to 
each of the <i>message</i> segments produced by subdividing the encoded message 
into blocks.</p>
<p><font color="#FF0000"><b>Two constraints on the common divisor n</b></font></p>
<p>The value of the <i>integer constant divisor</i> referred to by <i><b>n</b></i> 
in Figure 2 must have the same number of digits as the <b>blockSize</b>.&nbsp; 
In addition, the value of n must be larger than the largest possible value of 
any message m shown in Figure 2.</p>
<p><font color="#FF0000"><b>The encoding scheme for Rsa01</b></font></p>
<p>The encoding scheme for <b>Rsa01</b> is simple and straightforward.&nbsp; The 
scheme supports 27 characters consisting of a space character and the 26 
upper-case characters in the alphabet.&nbsp; The space 
character is replaced by 00, the A is replaced by 01, the Z is replaced by 26, 
etc.</p>
<p><font color="#FF0000"><b>Predetermined keys and divisor</b></font></p>
<p>The <b>blockSize</b> is 4.&nbsp; Therefore the integer value of a message m can 
range from 0000 to 2626 inclusive.</p>
<p>The program uses the predetermined values for n, d, and e shown near the top 
of Figure 4.</p>
<p>The theoretical basis for this program as well as a description of the 
example encryption problem are provided by the original authors of 
the RSA algorithm at:&nbsp;
<a href="http://theory.lcs.mit.edu/~rivest/rsapaper.pdf">
http://theory.lcs.mit.edu/~rivest/rsapaper.pdf</a> <br>
<br>
This program provides a Java implementation of the encrypting and deciphering 
operations described in the author's <i>Small Example</i> 
using p, q, n, d, and e given in that example at the above URL.</p>
<p><font color="#FF0000"><b>The main method</b></font></p>
<p>The code fragment shown in Listing 14 shows the beginning of the class and 
the beginning of the<b> main</b> method.</p>
<p>
<table border="1" cols="1" width="400" bgcolor="#ffff00">
  <tbody>
    <tr>
      <td>
      <pre>class Rsa01{
  public static void main(String&#91;&#93; args){
    BigInteger p = new BigInteger("47");
    BigInteger q = new BigInteger("59");
    BigInteger n = p.multiply(q);
    BigInteger d = new BigInteger("157");
    BigInteger e = new BigInteger("17");

    String plainText = "ITS ALL GREEK TO ME";<br><br><b><font face="Courier New,Courier">Listing 14</font></b></pre>
      </td>
    </tr>
  </tbody>
</table>
</p>
<p>The first five statements in Listing 14 establish predetermined values 
from the original author's website encapsulated in <b>BigInteger</b> objects.</p>
<p>The sixth statement in Listing 14 establishes a <b>plainText</b> string, 
which will be processed by the program, producing the output shown in Figure 4.</p>
<p><font color="#FF0000"><b>Miscellaneous material</b></font></p>
<p>The first four statements in Listing 15 declare some strings that will be 
populated later by the program.&nbsp; The next five statements display the 
values shown in the first five lines of text in the output shown in Figure 4.</p>
<p>
<table border="1" cols="1" width="400" bgcolor="#ffff00">
  <tbody>
    <tr>
      <td>
      <pre>    String encodedText = "";
    String cipherText = "";
    String decipheredText = "";
    String outputText = "";

    System.out.println("p: " + p);
    System.out.println("q: " + q);
    System.out.println("n: " + n);
    System.out.println("d: " + d);
    System.out.println("e: " + e);

    Rsa01 obj = new Rsa01();<br><br><b><font face="Courier New,Courier">Listing 15</font></b></pre>
      </td>
    </tr>
  </tbody>
</table>
</p>
<p>The final statement in Listing 15 instantiates an object of the class 
and stores its reference in the reference variable named <b>obj</b>.</p>
<p><font color="#FF0000"><b>Deal with potential end-effect problems</b></font></p>
<p>For a <b>blockSize</b> of 4, this program processes the characters in the 
encoded text four characters at a time.&nbsp; The <b>plainText</b> message in 
this example contains 19 characters.&nbsp; Using the encoding scheme described 
earlier, the encoded version of the <b>plainText</b> message would be 38 
characters long.</p>
<p>Because 38 is not evenly divisible by the <b>blockSize</b> value of 4, this results in a problem that must 
be dealt with either at this point or later.&nbsp; I chose to deal with it at 
this point to avoid having to deal with it later.&nbsp; </p>
<p><font color="#FF0000"><b>Append a space character</b></font></p>
<p>The code in Listing 16 appends a space 
character onto the end of the <b>plainText</b> message to cause its length to be 
an even number of characters.&nbsp; Then when it is encoded as described above, 
the number of characters in the encoded text will be evenly divisible by the <b>
blockSize</b> value of 4.</p>
<blockquote>
	<p><i>(Note that this problem could be dealt with after encoding just as 
	well as dealing with it before encoding.)</i></p>
</blockquote>
<p>
<table border="1" cols="1" width="400" bgcolor="#ffff00">
  <tbody>
    <tr>
      <td>
      <pre>    while(plainText.length()%4 != 0){
      //Append a space character on the end
      plainText += " ";
    }//end while

    System.out.println(
                      "plainText\n" + plainText);<br><br><b><font face="Courier New,Courier">Listing 16</font></b></pre>
      </td>
    </tr>
  </tbody>
</table>
</p>
<p>The code in Listing 16 also displays the extended <b>plainText</b> method as 
the seventh line of output text in Figure 4.</p>
<p><font color="#FF0000"><b>Encode the text message</b></font></p>
<p>Listing 17 invokes the<b>&nbsp;encode</b> method to encode the extended <b>
plainText</b> method.&nbsp; Then Listing 17 displays the encoded text producing 
the ninth line of text shown in Figure 4.</p>
<blockquote>
	<p><i>(Note that the text has not been encrypted at this point.&nbsp; It has 
	simply been encoded into numeric format in preparation for encrypting it 
	using the RSA algorithm.)</i></p>
</blockquote>
<p>
<table border="1" cols="1" width="400" bgcolor="#ffff00">
  <tbody>
    <tr>
      <td>
      <pre>    encodedText = obj.encode(plainText);
    System.out.println(
                  "encodedText\n" + encodedText);<br><br><b><font face="Courier New,Courier">Listing 17</font></b></pre>
      </td>
    </tr>
  </tbody>
</table>
</p>
<p><font color="#FF0000"><b>The encode method</b></font></p>
<p>Setting the <b>main</b> method aside temporarily, Listing 18 shows the <b>
encode</b> method in its entirety.</p>
<p>
<table border="1" cols="1" width="400" bgcolor="#ffff00">
  <tbody>
    <tr>
      <td>
      <pre>  String <b>encode</b>(String plainText){
    byte&#91;&#93; textChars = plainText.getBytes();
    String temp = "";
    String encodedText = "";

    //Build the encoded text string two numeric
    // characters at a time.  Each plainText
    // character is converted to two numeric
    // characters according to the relationships
    // given above.
    for(int cnt = 0; cnt < plainText.length();
                                          cnt++){
      temp = String.valueOf(
                       textChars&#91;cnt&#93; - 'A' + 1);
      //Handle the special case of a space
      // character.
      if(temp.equals("-32")) temp = "00";
      //Convert all single-character numeric
      // values to two characters with a leading
      // zero, as in 09.
      if(temp.length() < 2) temp = "0" + temp;
      encodedText += temp;
    }//end for loop
    return encodedText;
  }//end encode<br><br><b><font face="Courier New,Courier">Listing 18</font></b></pre>
      </td>
    </tr>
  </tbody>
</table>
</p>
<p>The purpose of the <b>encode</b> method is to encode a plain text message into numeric format where:</p>
<ul>
	<li>space = 00</li>
	<li>A = 01</li>
	<li>B = 02</li>
	<li>C = 03</li>
	<li>...</li>
	<li>Z = 26</li>
</ul>
<blockquote>
	<p><i>(Note that this encoding scheme supports only space characters and upper-case alphabetic characters.)</i></p>
</blockquote>
<p>The code in Listing 18 implements a simple substitution approach and 
shouldn't require further explanation.&nbsp; The <b>String</b> that is returned 
by this method will be encrypted using the RSA algorithm.</p>
<p><font color="#FF0000"><b>Encrypt the encoded text</b></font></p>
<p>Listing 19 invokes the <b>doRSA</b> method to encrypt the encoded text.&nbsp; 
Then it displays the encrypted result as the eleventh line of text in Figure 4.</p>
<table border="1" cols="1" width="400" bgcolor="#ffff00">
  <tbody>
    <tr>
      <td>
      <pre>    cipherText = obj.doRSA(encodedText,e,n);
    System.out.println(
                    "cipherText\n" + cipherText);<br><br><b><font face="Courier New,Courier">Listing 19</font></b></pre>
      </td>
    </tr>
  </tbody>
</table>
</p>
<p><font color="#FF0000"><b>The doRSA method</b></font></p>
<p>The <b>doRSA </b>method applies the RSA algorithm to an input string of 
numeric characters using a 
specified exponent exp and a specified modulus operator n.&nbsp; The input 
string is provided as the first input parameter to the method.&nbsp; The values 
of the exponent and the modulus operator are provided as the second and third 
input parameters.</p>
<p>This method can be used to encrypt or to decrypt the input string depending 
on whether the exponent is an encryption key or a decryption key.</p>
<p>The method is hard coded to apply the algorithm for a fixed block size of 
four characters. Thus, this is not a general-purpose RSA method that can be 
applied for different block sizes.</p>
<blockquote>
	<p><i>(I will provide a more general-purpose version of the method that 
	allows for different block sizes in the 
	next program.)</i></p>
</blockquote>
<p><font color="#FF0000"><b>Let's see some code</b></font></p>
<p>Once again setting the <b>main</b> method aside temporarily, Listing 20 shows 
the beginning of the <b>doRSA</b> method.</p>
<p>
<table border="1" cols="1" width="400" bgcolor="#ffff00">
  <tbody>
    <tr>
      <td>
      <pre>  String doRSA(String inputString,
                    BigInteger exp,BigInteger n){
    BigInteger block;
    BigInteger output;
    String temp = "";
    String outputString = "";<br><br><b><font face="Courier New,Courier">Listing 20</font></b></pre>
      </td>
    </tr>
  </tbody>
</table>
</p>
<p>The code in Listing 20 declares and initializes some variables that 
will be used later.&nbsp;
</p>
<p><font color="#FF0000"><b>Process one block at a time</b></font></p>
<p>Listing 21 shows the beginning of a <b>for</b> loop that iterates and 
processes the incoming string by subdividing the string into one block of four characters during each 
iteration.</p>
<p>
<table border="1" cols="1" width="400" bgcolor="#ffff00">
  <tbody>
    <tr>
      <td>
      <pre>    for(int cnt = 0; cnt < inputString.length();
                                       cnt += 4){
      temp = inputString.substring(cnt,cnt + 4);
      block = new BigInteger(temp);

<br><b><font face="Courier New,Courier">Listing 21</font></b></pre>
      </td>
    </tr>
  </tbody>
</table>
</p>
<p>The code in Listing 21 gets the next block of four characters and uses them 
to initialize a new <b>BigInteger</b> object that treats the four character 
substring as an integer.</p>
<blockquote>
	<p><i>(This is where the program gets into trouble and throws an 
	exception if the length of the incoming string is not divisible by 4.&nbsp; 
	In that case, the partial block at the end causes the invocation of the
	<b>substring </b>method to throw a <b>StringIndexOutOfBoundsException</b>.)</i></p>
</blockquote>
<p><font color="#FF0000"><b>The meaning of the data in block</b></font></p>
<p>At this point, the value encapsulated in the <b>BigInteger</b> object 
referred to by <b>block</b> is analogous to either the value of the message m or 
the value of the cipher c shown in the explanation of the algorithm in Figure 2.</p>
<p><font color="#FF0000"><b>Raise the block to the power exp</b></font></p>
<p>Referring back to Figure 2, the next step is to invoke the <b>modPow</b>&nbsp;method 
of the <b>BigInteger</b> class to:</p>
<ul>
	<li>Raise the value encapsulated in the object 
referred to by <b>block</b> to the power <b>exp</b> and to </li>
	<li>Compute the modulus 
using the divisor n, saving the remainder in the <b>BigInteger </b>object 
referred to by <b>output</b>&nbsp; </li>
</ul>
<p>This is shown in Listing 22.</p>
<p>
<table border="1" cols="1" width="400" bgcolor="#ffff00">
  <tbody>
    <tr>
      <td>
      <pre>      output = block.modPow(exp,n);
<br><b><font face="Courier New,Courier">Listing 22</font></b></pre>
      </td>
    </tr>
  </tbody>
</table>
</p>
<p><font color="#FF0000"><b>The modPow method</b></font></p>
<p>This is one of the methods of the <b>BigInteger</b> class that is 
particularly useful for this type of processing.&nbsp; This method raises <i>
this</i> to the <b>exp</b> power, divides the result by <b>n</b>, and returns 
the remainder.</p>
<p><font color="#FF0000"><b>The magnitude of the remainder</b></font></p>
<p>For this case, the message substring encapsulated by <b>block</b> must be a positive integer 
less than or equal to 2626.&nbsp; Given that n is 2773, the resulting value must 
be less than 2773 <i>(the remainder can never be greater than the divisor).</i></p>
<p><font color="#FF0000"><b>Convert remainder to four-character string</b></font></p>
<p>For our purposes, we need to convert the remainder to a four-character string 
inserting leading zeros if necessary.&nbsp; This is accomplished in a somewhat 
brute force manner shown in Listing 23.</p>
<p>
<table border="1" cols="1" width="400" bgcolor="#ffff00">
  <tbody>
    <tr>
      <td>
      <pre>      temp = output.toString();
      if(temp.length() == 3){
        temp = &quot;0&quot; + temp;
      }else if(temp.length() == 2){
        temp = &quot;00&quot; + temp;
      }else if(temp.length() == 1){
        temp = &quot;000&quot; + temp;
      }//end else if<br><br><b><font face="Courier New,Courier">Listing 23</font></b></pre>
      </td>
    </tr>
  </tbody>
</table>
</p>
<p><font color="#FF0000"><b>Concatenate to produce the output string</b></font></p>
<p>Finally, the statement at the bottom of the <b>for</b> loop in Listing 24 
builds the output string four characters at a time by concatenating the results 
of processing each block of four input characters to the output string.</p>
<p>
<table border="1" cols="1" width="400" bgcolor="#ffff00">
  <tbody>
    <tr>
      <td>
      <pre>      outputString += temp;
    }//end for loop

    return outputString;
  }//end doRSA<br><br><b><font face="Courier New,Courier">Listing 24</font></b></pre>
      </td>
    </tr>
  </tbody>
</table>
</p>
<p>When all of the four-character blocks in the input string have been 
processed, the <b>doRSA</b> method terminates returning the output string.</p>
<p><font color="#FF0000"><b>An encryption operation</b></font></p>
<p>When the incoming string is the encoded text message and the incoming 
parameter named <b>exp</b> is the encryption key, the output is the cipher text 
shown in the eleventh line of text in Figure 4.</p>
<p><font color="#FF0000"><b>A decryption operation</b></font></p>
<p>When the incoming string is the cipher text and the incoming parameter named
<b>exp</b> is the decryption key, the output is the deciphered encoded text 
shown in the thirteenth line in Figure 4.</p>
<blockquote>
	<p><i>(Note that the thirteenth line of text matches the encoded text shown 
	in the ninth line in Figure 4.)</i></p>
</blockquote>
<p><font color="#FF0000"><b>Decipher the cipher text</b></font></p>
<p>Returning now to the <b>main</b> method, Listing 25 passes the <b>cipherText</b> 
along with the decryption key d and the common divisor n to the <b>doRSA</b> 
method to decrypt the encrypted message.</p>
<p>
<table border="1" cols="1" width="400" bgcolor="#ffff00">
  <tbody>
    <tr>
      <td>
      <pre>    decipheredText = obj.doRSA(cipherText,d,n);
    System.out.println(
            "decipheredText\n" + decipheredText);<br><br><b><font face="Courier New,Courier">Listing 25</font></b></pre>
      </td>
    </tr>
  </tbody>
</table>
</p>
<p>Listing 25 displays the result in the thirteenth line in Figure 4.&nbsp; As 
mentioned earlier, this line of text matches the ninth line of text in Figure 4 
which is the encoded message text prior to encryption.</p>
<p><font color="#FF0000"><b>Decode the message</b></font></p>
<p>Finally, Listing 26 invokes the <b>decode</b> method to transform the encoded 
message text back to raw text&nbsp; Listing 26 also displays the result producing the last line 
of text in Figure 4.&nbsp; As expected, this line of text matches the seventh 
line of text which was the original plain text message with an extra space 
appended to the end to handle the end-effect problem.</p>
<p>
<table border="1" cols="1" width="400" bgcolor="#ffff00">
  <tbody>
    <tr>
      <td>
      <pre>    outputText = obj.decode(decipheredText);
    System.out.println(
                    "outputText\n" + outputText);
  }//end main<br><br><b><font face="Courier New,Courier">Listing 26</font></b></pre>
      </td>
    </tr>
  </tbody>
</table>
</p>
<p><font color="#FF0000"><b>The decode method</b></font></p>
<p>The <b>decode</b> method is straightforward, simply reversing the encoding 
process implemented by the <b>encode</b> method.&nbsp; You can view the <b>
decode</b> method in its entirety in the complete listing of program <b>Rsa01</b> 
in Listing 47 near the end of the lesson.</p>
<p><font color="#FF0000"><b>The program named Rsa03</b></font></p>
<p>IMPORTANT: THIS PROGRAM IS DESIGNED SPECIFICALLY FOR INSTRUCTIONAL PURPOSES. 
IT WILL NOT EXECUTE PROPERLY FOR BLOCK SIZES AND KEYS GREATER THAN 6 CHARACTERS IN LENGTH.</p>
<p>This program is a significant update to <b>Rsa01</b>. This update makes the 
program more general.&nbsp; Everything spawns from a specification of the block 
size.&nbsp; In addition, this program includes the computation of the encryption 
and decryption keys using a procedure described by the
<a href="http://theory.lcs.mit.edu/~rivest/rsapaper.pdf">authors</a> of the RSA 
algorithm.</p>
<p>The encoding and decoding approach used in this program supports the 95 ASCII 
characters between space and tilde (~) inclusive.</p>
<p><font color="#FF0000"><b>The screen output</b></font></p>
<p>This program uses the RSA algorithm along with the computed keys and common 
divisor to encrypt and decrypt a message containing 23 characters using a block 
size of 4 producing the output shown in Figure 5.<br>
</p>
<table border="1" cols="1" width="400" bgcolor="#ccffff">
  <tbody>
    <tr>
      <td>
      <pre><b>p: 19
q: 503
n: 9557
phi: 9036
e: 17
d: 7973
plainText
0123 89!@ abcd ABCD EF~-
encodedText
161718190024250132006566676800333435360037389413
cipherText
831382420004363732998462293181478621167049176719
decipheredText
161718190024250132006566676800333435360037389413
outputText
0123 89!@ abcd ABCD EF~-</b><br></pre>
      <pre><b>Figure 5</b></pre>
      </td>
    </tr>
  </tbody>
</table>
<p><font color="#FF0000"><b>Experimentation</b></font></p>
<p>You can experiment with different block sizes by changing the value of the 
variable named <b>blockSize</b> and recompiling <i>(as long as you don't cause 
the block size to be greater than 6).</i></p>
<p>You can experiment with different encryption and decryption keys as well as a 
different common divisor by changing the value of the variable named e and 
recompiling.</p>
<p>You can also produce a different decryption key k and a different common 
divisor n by changing the initial value of p and recompiling.</p>
<p><i>This program should not be used for production purposes. If you need a Java 
encryption program for production use, you should develop it using Sun's JCE 
API.</i></p>
<p>See the theoretical basis for RSA at:
<a href="http://theory.lcs.mit.edu/~rivest/rsapaper.pdf">
http://theory.lcs.mit.edu/~rivest/rsapaper.pdf</a></p>
<p>Another good reference is at:
<a href="http://www.math.mtu.edu/mathlab/COURSES/holt/dnt/phi4.html">
http://www.math.mtu.edu/mathlab/COURSES/holt/dnt/phi4.html</a></p>
<p><font color="#FF0000"><b>Key reversal</b></font></p>
<p>Note that you can reverse the use of the two keys for encryption and 
decryption and get the same results.&nbsp; 
In other words, it doesn't matter which key you use to encrypt the message into cipher 
text as long as you use the other key to decrypt the cipher text.</p>
<p><font color="#FF0000"><b>Simultaneous conditions</b></font></p>
<p>In order for this algorithm to work correctly, it is necessary for the value 
of n to be greater than the maximum value of an encoded data block.&nbsp; It is 
also necessary for the number of characters in the value of n to be less than or 
equal to the block size.&nbsp; If the program is unable to satisfy both 
conditions simultaneously, it terminates with an error message.</p>
<p><font color="#FF0000"><b>The program output</b></font></p>
<p>This program was tested using SDK 1.4.2 and WinXP.&nbsp; The program produces 
the output shown in Figure 5.</p>
<p><font color="#FF0000"><b>The Rsa03 class</b></font></p>
<p>The controlling class for the program named <b>Rsa03</b> begins in Listing 27.</p>
<p>
<table border="1" cols="1" width="400" bgcolor="#ffff00">
  <tbody>
    <tr>
      <td>
      <pre>class Rsa03{
  static class Params{
    BigInteger p = new BigInteger("0");
    BigInteger q = new BigInteger("0");
    BigInteger n = new BigInteger("0");
    BigInteger d = new BigInteger("0");
    BigInteger e = new BigInteger("15");
    BigInteger phi = new BigInteger("0");
    BigInteger max;
  }//end inner class Params<br><br><b><font face="Courier New,Courier">Listing 27</font></b></pre>
      </td>
    </tr>
  </tbody>
</table>
</p>
<p>Listing 27 defines a <i>static</i> class named <b>Params</b> inside the class 
named <b>Rsa03</b>.&nbsp; The purpose of this class is to create an object that 
serves as a container for the two keys, the modulus operand, and several other 
important parameters.&nbsp; It was made static so that it can be instantiated 
from inside the static <b>main</b> method.</p>
<p><font color="#FF0000"><b>The main method</b></font></p>
<p>The <b>main</b> method begins in Listing 28.</p>
<p>
<table border="1" cols="1" width="400" bgcolor="#ffff00">
  <tbody>
    <tr>
      <td>
      <pre>  public static void main(String&#91;&#93; args){
    Params par = new Params();

    String plainText = "0123 89!@ abcd ABCD EF~";

    //Strings to be populated by the program.
    String encodedText = "";
    String cipherText = "";
    String decipheredText = "";
    String outputText = "";

    int blockSize = 4;
    if(blockSize % 2 != 0){
      System.out.println(
                       "blockSize must be even");
      System.exit(1);
    }//end if

    String maxEncodedString = "";
    for(int cnt = 0; cnt < blockSize; cnt += 2){
      maxEncodedString += "94";
    }//end for loop
    par.max = new BigInteger(maxEncodedString);<br><br><b><font face="Courier New,Courier">Listing 28</font></b></pre>
      </td>
    </tr>
  </tbody>
</table>
</p>
<p>The code in Listing 28 is straightforward.&nbsp; It does the following:</p>
<ul>
	<li>Instantiates an object of the class <b>Params</b> in which to store the 
	parameters.</li>
	<li>Creates a test message string containing characters from the full range 
	of the 95 characters supported by the encoding method.</li>
	<li>Declares some variables to be populated later by the program.</li>
	<li>Sets the block size and makes certain that it is divisible by 2.</li>
	<li>Gets and saves the maximum value of an encoded string for the specified block size and the encoding format used.&nbsp; 
	For example, for a block size of 4, the maximum value would be 9494.</li>
</ul>
<p><font color="#FF0000"><b>Get initial value for p</b></font></p>
<p>If you visit the <a href="http://theory.lcs.mit.edu/~rivest/rsapaper.pdf">
theoretical basis</a> published by the original authors of the RSA algorithm, 
you will see that the process of computing the keys requires the product of two 
prime numbers, p and q, whose product, n, must be greater than the largest possible 
value of a data block.</p>
<blockquote>
	<p><i>(In addition, the number of characters in the product must not be 
	greater than the block size in order for the algorithm to work properly.)</i></p>
</blockquote>
<p>Listing 29 computes an initial value for p.&nbsp; There is nothing special 
about the approach used to get the initial value in Listing 29.&nbsp; In fact, 
it might be preferable to use a random number generator to produce this initial 
value.&nbsp; The final value for p will be a prime number close to this value.</p>
<p>
<table border="1" cols="1" width="400" bgcolor="#ffff00">
  <tbody>
    <tr>
      <td>
      <pre>    par.p = par.max.divide(
                          new BigInteger("502"));

    Rsa03 obj = new Rsa03();<br><br><b><font face="Courier New,Courier">Listing 29</font></b></pre>
      </td>
    </tr>
  </tbody>
</table>
</p>
<p>Listing 29 also instantiates an object of the class and saves its reference 
in the reference variable named <b>obj</b>.</p>
<p><font color="#FF0000"><b>Get and display keys</b></font></p>
<p>Listing 30 invokes the <b>getKeys</b> method to get and then to display the 
values of the keys, e and d, and other important parameters in the first six 
lines of Figure 5.</p>
<p>
<table border="1" cols="1" width="400" bgcolor="#ffff00">
  <tbody>
    <tr>
      <td>
      <pre>    obj.getKeys(par,blockSize);

    System.out.println("p: " + par.p);
    System.out.println("q: " + par.q);
    System.out.println("n: " + par.n);
    System.out.println("phi: " + par.phi);
    System.out.println("e: " + par.e);
    System.out.println("d: " + par.d);<br><br><b><font face="Courier New,Courier">Listing 30</font></b></pre>
      </td>
    </tr>
  </tbody>
</table>
</p>
<p><font color="#FF0000"><b>The getKeys method</b></font></p>
<p>The <b>getKeys</b> method is new to this program.&nbsp; It was not included 
in any of the previous three programs.&nbsp; This method implements the 
algorithm <a href="http://theory.lcs.mit.edu/~rivest/rsapaper.pdf">published</a> 
by the original authors of the RSA method for computing the public and private 
keys, e and d, as well as the common divisor, n, as described in Figure 2.</p>
<p>I will make no attempt in this lesson to explain how and why this algorithm 
works for producing e, d, and n.&nbsp; Rather, I will simply walk you through 
the code that implements the steps described by the authors.</p>
<p><font color="#FF0000"><b>Code for the getKeys method</b></font></p>
<p>Putting the <b>main</b> method aside temporarily, the <b>getKeys</b> method 
begins in Listing 31.&nbsp; As you can see, this method receives a reference to the container 
object for the keys and other parameters along with the block size as 
parameters.</p>
<p>The method begins by instantiating a <b>BigInteger</b> object that 
encapsulates the value 1.</p>
<p>
<table border="1" cols="1" width="400" bgcolor="#ffff00">
  <tbody>
    <tr>
      <td>
      <pre>  void getKeys(Params par,int blockSize){

    //A frequently used constant
    BigInteger bigOne = new BigInteger("1");

    while(!(par.p.isProbablePrime(1000))){
      par.p = par.p.add(bigOne);
    }//end while loop<br><br><b><font face="Courier New,Courier">Listing 31</font></b></pre>
      </td>
    </tr>
  </tbody>
</table>
</p>
<p><font color="#FF0000"><b>Needed, two prime numbers</b></font></p>
<p>Then the <b>getKeys</b> method initiates the process of selecting two prime numbers, p and 
q, such that the following two conditions are satisfied where <b>max</b> is the maximum possible data value in a data block:</p>
<ul>
	<li>n = p*q &gt; max </li>
	<li>The number of characters in n is &lt;= blockSize</li>
</ul>
<p>The first task is to get a prime number close to the initial value for p 
produced in Listing 29.&nbsp; The method uses this incoming initial value for p 
and then iterates by increasing the value of p until a highly-probable prime 
number is found.</p>
<p><font color="#FF0000"><b>The isProbablePrime method</b></font></p>
<p>As far as I can tell, there is no method to determine with absolute certainty 
whether or not the value of a <b>BigInteger</b> is prime.&nbsp; However, the <b>
BigInteger</b> class provides the <b>isProbablePrime</b> method, which makes it 
possible to determine within a specified level of uncertainty whether or not a 
given <b>BigInteger</b> value is a prime number.</p>
<p><i>(The larger the value 
passed to the method, the longer the method takes to execute, and the greater is 
the certainty that the number is prime if the method returns true.)</i></p>
<p>This is 
the method used in the loop in Listing 31 to get a probable prime number for p 
that is close to the initial value for p.</p>
<p><font color="#FF0000"><b>Get a prime number for q</b></font></p>
<p>The next step is to get a prime number for q that satisfies the two conditions 
listed earlier.&nbsp; This process begins in Listing 32.</p>
<p>
<table border="1" cols="1" width="400" bgcolor="#ffff00">
  <tbody>
    <tr>
      <td>
      <pre>    String firstQ =
                   "" + (par.p.subtract(bigOne));
    par.q = new BigInteger(firstQ);<br><br><b><font face="Courier New,Courier">Listing 32</font></b></pre>
      </td>
    </tr>
  </tbody>
</table>
</p>
<p>Listing 32 makes a first guess for the value of q as being one less than the 
current prime value of p.&nbsp; This value will be modified through iteration 
until a value is found that satisfies the conditions listed earlier, or it is 
concluded that those conditions cannot be satisfied.</p>
<p><font color="#FF0000"><b>Satisfy the block size constraint on n</b></font></p>
<p>Without regard for whether or not q is prime, Listing 33 gets a value for q 
for which the number of digits in the product p*q doesn't exceed the block size.&nbsp; 
This is done by successively halving the value for q until the condition is 
satisfied.</p>
<p>Then Listing 33 divides the value of q by 2 one more time to allow some room 
for incrementing the value of q later.</p>
<p>
<table border="1" cols="1" width="400" bgcolor="#ffff00">
  <tbody>
    <tr>
      <td>
      <pre>    par.n = par.p.multiply(par.q);
    while(par.n.toString().length() > blockSize){
      par.q = par.q.divide(new BigInteger("2"));
      par.n = par.p.multiply(par.q);
    }//end while

    par.q = par.q.divide(new BigInteger("2"));
<br><b><font face="Courier New,Courier">Listing 33</font></b></pre>
      </td>
    </tr>
  </tbody>
</table>
</p>
<p><font color="#FF0000"><b>Now get a prime number for q</b></font></p>
<p>The current value of q satisfies one of the two required conditions, but may not 
be a prime number.&nbsp; Listing 34 gets the next prime number that is smaller than the 
current value of q.</p>
<p>
<table border="1" cols="1" width="400" bgcolor="#ffff00">
  <tbody>
    <tr>
      <td>
      <pre>    while(!(par.q.isProbablePrime(1000))){
      par.q = par.q.subtract(bigOne);
    }//end while loop<br><br><b><font face="Courier New,Courier">Listing 34</font></b></pre>
      </td>
    </tr>
  </tbody>
</table>
</p>
<p><font color="#FF0000"><b>Satisfy the condition n &gt; max</b></font></p>
<p>Now we have prime values for p and q such that the number of characters in 
p*q is less than or equal to the block size.&nbsp; Next we need to confirm that 
the product of p and q is greater than the maximum possible value for a data block.&nbsp; This 
accomplished in Listing 35 by successively increasing the value of q by 1 until 
the condition is met.</p>
<blockquote>
	<p><i>(Note, however, that this adjustment could violate 
the previously satisfied condition involving the number of characters and the block size.)</i></p>
</blockquote>
<p>
<table border="1" cols="1" width="400" bgcolor="#ffff00">
  <tbody>
    <tr>
      <td>
      <pre>    par.n = par.p.multiply(par.q);

    while(par.n.compareTo(par.max) <= 0){
      //Get a larger prime value for q
      par.q = par.q.add(bigOne);
      while(!(par.q.isProbablePrime(1000))){
        par.q = par.q.add(bigOne);
      }//end while loop
      //Compute the new value for n and go back
      // to the top and test again.
      par.n = par.p.multiply(par.q);
    }//end while loop<br><br><b><font face="Courier New,Courier">Listing 35</font></b></pre>
      </td>
    </tr>
  </tbody>
</table>
</p>
<p><font color="#FF0000"><b>Confirm that both conditions are met</b></font></p>
<p>Listing 36 confirms that both conditions are still being met.&nbsp; If not, 
the program terminates with an error message.</p>
<p>
<table border="1" cols="1" width="400" bgcolor="#ffff00">
  <tbody>
    <tr>
      <td>
      <pre>    if((par.n.toString().length() > blockSize)
             || (par.n.compareTo(par.max) <= 0)){
      System.out.println(
              "Required conditions are not met");
      System.exit(1);
    }//end if<br><br><b><font face="Courier New,Courier">Listing 36</font></b></pre>
      </td>
    </tr>
  </tbody>
</table>
</p>
<p><font color="#FF0000"><b>Three more steps</b></font></p>
<p>There are three more steps required to compute e, d, and n as described in 
Figure 2.&nbsp; The next step is to compute a value referred to by the original 
authors as phi <i>(although it is described by those authors using the Greek 
character for phi in their
<a href="http://theory.lcs.mit.edu/~rivest/rsapaper.pdf">paper</a>).</i></p>
<p>This computation is straightforward as shown in Listing 37.</p>
<p>
<table border="1" cols="1" width="400" bgcolor="#ffff00">
  <tbody>
    <tr>
      <td>
      <pre>    //Compute phi, as (p - 1)*(q - 1).
    BigInteger pPrime = par.p.subtract(bigOne);
    BigInteger qPrime = par.q.subtract(bigOne);
    par.phi = pPrime.multiply(qPrime);

<b><font face="Courier New,Courier">Listing 37</font></b></pre>
      </td>
    </tr>
  </tbody>
</table>
</p>
<p><font color="#FF0000"><b>Greatest common denominator</b></font></p>
<p>The next step is to find a value for e such that the greatest common 
denominator of e and phi is equal to 1.&nbsp; This is accomplished using the <b>
gcd</b> method of the <b>BigInteger</b> class as shown in Listing 38.</p>
<p>
<table border="1" cols="1" width="400" bgcolor="#ffff00">
  <tbody>
    <tr>
      <td>
      <pre>    //Compute e.  First guess is incoming
    // value.
    while(!par.e.gcd(par.phi).equals(bigOne)){
      par.e = par.e.add(bigOne);
    }//end while loop

<b><font face="Courier New,Courier">Listing 38</font></b></pre>
      </td>
    </tr>
  </tbody>
</table>
</p>
<p>The <b>gcd</b> method is straightforward enough, so I will simply refer you 
to the Sun documentation to read about it.</p>
<p><font color="#FF0000"><b>The mod inverse method</b></font></p>
<p>The final step is to compute the value of d using the <b>modInverse</b> 
method of the <b>BigInteger</b> class as shown in Listing 39.</p>
<p>
<table border="1" cols="1" width="400" bgcolor="#ffff00">
  <tbody>
    <tr>
      <td>
      <pre>    //Compute the value for d
    par.d = par.e.modInverse(par.phi);

  }//end getKeys<br><br><b><font face="Courier New,Courier">Listing 39</font></b></pre>
      </td>
    </tr>
  </tbody>
</table>
</p>
<p><font color="#FF0000"><b>Obscure steps</b></font></p>
<p>Listing 39 also signals the end of the <b>getKeys</b> method.</p>
<p>The purpose of these three final steps in the <b>getKeys</b> method may seem 
somewhat obscure.&nbsp; If you really want to understand how and why they 
accomplish what they do, you can read the
<a href="http://theory.lcs.mit.edu/~rivest/rsapaper.pdf">mathematical derivation</a> 
of the algorithm provided by the original authors of the RSA algorithm.</p>
<p>Alternatively, you can take it on faith that they successfully developed a 
mathematical solution to the same problem that we solved using brute force trial 
and error iteration in the programs named <b>Rsa07</b> and <b>Rsa08</b>.&nbsp; 
Hopefully, even if you don't understand the mathematical solution, you do have 
an intuitive understanding of the solution based on those two programs.</p>
<p><font color="#FF0000"><b>The screen output</b></font></p>
<p>The first six lines of text in Figure 5 show the values produced by the 
invocation of the <b>getKeys</b> method in this program.</p>
<p><font color="#FF0000"><b>Adjust the message length</b></font></p>
<p>Returning to the <b>main</b> method, the code in Listing 40 forces the plain 
text message length to be a multiple of half the block size to avoid the 
end-effect problems discussed earlier.</p>
<p>
<table border="1" cols="1" width="400" bgcolor="#ffff00">
  <tbody>
    <tr>
      <td>
      <pre>    while(plainText.length()%(blockSize/2) != 0){
      plainText += "-";
    }//end while
    System.out.println(
                      "plainText\n" + plainText);<br><br><b><font face="Courier New,Courier">Listing 40</font></b></pre>
      </td>
    </tr>
  </tbody>
</table>
</p>
<p>In this case, I purposely extended the message with dashes so that the 
extension would be visible in the screen output.&nbsp; Listing 40 also displays 
the extended message as shown in Figure 5.</p>
<p><font color="#FF0000"><b>Encode the plain text</b></font></p>
<p>Listing 41 encodes the plain text into numeric format to prepare it for 
encryption using the RSA algorithm and displays the encoded result in Figure 5.</p>
<p>
<table border="1" cols="1" width="400" bgcolor="#ffff00">
  <tbody>
    <tr>
      <td>
      <pre>    encodedText = obj.encode(plainText);
    System.out.println(
                  "encodedText\n" + encodedText);<br><br><b><font face="Courier New,Courier">Listing 41</font></b></pre>
      </td>
    </tr>
  </tbody>
</table>
</p>
<p><font color="#FF0000"><b>The encode method</b></font></p>
<p>The <b>encode</b> method that is invoked in Listing 41 to encode the plain 
text message is very similar to the method having the same name in the program 
named<b> Rsa01</b>.<b>&nbsp; </b>The main difference is that this version 
supports ninety-five characters extending from the space character to the tilde 
(~) character in the ASCII character set.</p>
<p>The purpose of this version of the <b>encode</b> method is to encode a plain text message into numeric format where:</p>
<ul>
	<li>space&nbsp; = 00</li>
	<li>A = 33</li>
	<li>...</li>
	<li>Z = 58</li>
	<li>...</li>
	<li>a = 65</li>
	<li>...</li>
	<li>~ = 94</li>
</ul>
<p>The code used to accomplish this is straightforward and won't be discussed in 
detail.&nbsp; You can view that code in Listing 48 near the end of the lesson.</p>
<p><b><font color="#FF0000">Encrypt the encoded message</font></b></p>
<p>Listing 42 invokes the <b>doRSA</b> method to encrypt the encoded text and 
displays the encrypted message as the twelfth line of output in Figure 5.</p>
<p>Note that this invocation of the method receives the encryption key e an 
incoming parameter.</p>
<p>
<table border="1" cols="1" width="400" bgcolor="#ffff00">
  <tbody>
    <tr>
      <td>
      <pre>    //Encrypt the encoded text and display the
    // result.
    cipherText = obj.doRSA(encodedText,par.e,
                                par.n,blockSize);
    System.out.println(
                    "cipherText\n" + cipherText);<br><br><b><font face="Courier New,Courier">Listing 42</font></b></pre>
      </td>
    </tr>
  </tbody>
</table>
</p>
<p><font color="#FF0000"><b>The doRSA method</b></font></p>
<p>This version of the <b>doRSA</b> method is very similar to the version that I 
explained in conjunction with the program named <b>Rsa01</b> beginning in 
Listing 20.&nbsp; The primary difference is that the previous version was 
hard-coded to work on a block size of 4.&nbsp; This version receives the block 
size as an incoming parameter and uses that value as a variable.</p>
<p>Because of the similarity of the two versions, I won't discuss this version 
in detail.&nbsp; You can view the method in Listing 48 near the end of the 
lesson.</p>
<p><font color="#FF0000"><b>Decrypt the encrypted message</b></font></p>
The code in Listing 43 invokes the <b>doRSA</b> method again, passing the 
decryption key d as a parameter to decrypt the encrypted message.<p>
<table border="1" cols="1" width="400" bgcolor="#ffff00">
  <tbody>
    <tr>
      <td>
      <pre>    decipheredText = obj.doRSA(cipherText,par.d
                               ,par.n,blockSize);
    System.out.println(
            "decipheredText\n" + decipheredText);<br><br><b><font face="Courier New,Courier">Listing 43</font></b></pre>
      </td>
    </tr>
  </tbody>
</table>
</p>
<p>Listing 43 also displays the decrypted message as the fourteenth line of 
output in Figure 5.&nbsp; Note that the decrypted message exactly matches the 
encoded text in the tenth line in Figure 5 as would be expected.</p>
<p><font color="#FF0000"><b>Decode the message</b></font></p>
Listing 44 invokes the <b>decode</b> method to transform the message from 
numeric format back to plain text.&nbsp; Listing 44 also displays the resulting 
text as the last line in Figure 5.&nbsp; As you can see, the result is an exact 
match for the extended plain text message shown in the eighth line of Figure 5.<p>
<table border="1" cols="1" width="400" bgcolor="#ffff00">
  <tbody>
    <tr>
      <td>
      <pre>    outputText = obj.decode(decipheredText);
    System.out.println(
                    "outputText\n" + outputText);

  }//end main<br><br><b><font face="Courier New,Courier">Listing 44</font></b></pre>
      </td>
    </tr>
  </tbody>
</table>
</p>
<p>Listing 44 also signals the end of the <b>main</b> method and the end of the 
program.</p>
<p><font color="#FF0000"><b>The decode method</b></font></p>
The <b>decode</b> method simply reverses the transformation performed by the <b>
encode</b> method discussed earlier.&nbsp; The code in the <b>decode</b> method 
is straightforward and doesn't merit a detailed discussion here.&nbsp; You can 
view the <b>decode</b> method in its entirety in Listing 48 near the end of the 
lesson.<h2 align="center"><a name="Run_the_Programs">Run the Program</a>s</h2>
<p>I encourage you to copy, compile and run the following programs that are 
provided in this lesson:</p>
<ul>
	<li>Rsa07</li>
	<li>Rsa08</li>
	<li>Rsa01</li>
	<li>Rsa03</li>
</ul>
<p>Experiment with the programs, making changes and observing the results of your changes.</p>
<p>Above all, have fun and use these programs to learn as much as you can about 
the theory behind and the mechanics of public key cryptography as implemented 
using Java.</p>
<h2 align="center"><a name="Summary">Summary</a></h2>
<p>In this lesson, I explained the general philosophy of public key 
cryptography.&nbsp; I also provided four sample programs that illustrate various 
aspects of public key cryptography through the use of the RSA algorithm.</p>
<p>The first two programs were designed to give you an intuitive understanding 
of the RSA algorithm.</p>
<p>The third program provides a Java implementation of a small example that is 
presented in incomplete form by the RSA algorithm's
<a href="http://theory.lcs.mit.edu/~rivest/rsapaper.pdf">authors</a>.</p>
<p>The fourth program is a more general implementation of the RSA algorithm.</p>
<h2 align="center"><a name="Whats Next">What's Next?</a></h2>
<p>The next lesson in this series will explain the use of public key 
cryptography for the creation and use of digital signatures for the signing of 
messages.</p>
<p>Future lessons will explain the use of symmetric key cryptography using Java.</p>
<h2 align="center"><a name="Complete_Program_Listings">Complete Program Listings</a></h2><p>
Complete listings of the programs discussed in this lesson are provided in 
Listing 45 through Listing 48 below.&nbsp; </p>
<p><font color="#FF0000"><b>A disclaimer</b></font></p>
<p>The programs that I am providing and explaining in this series of lessons are 
not intended to be used for production cryptography.&nbsp; If you need to do 
cryptography using Java, you should use
<a href="http://java.sun.com/j2se/1.4/docs/guide/security/jce/JCERefGuide.html">
Sun's Java Cryptography Extension <i>(JCE)</i></a><i>.</i></p>
<p>The programs that I am providing were developed solely for instructional 
purposes.&nbsp; They are intended to 
help you to experiment with and to learn about various cryptographic algorithms and 
to gain a better understanding of how they work, and why they do what they do.</p>
<table border="1" cols="1" width="400" bgcolor="#FFFF00">
<tbody>
<tr>
<td>                     
<pre>
/*File Rsa07.java
Copyright 2004, R.G.Baldwin

The purpose of this program is to provide a very
simple and intuitive explanation of the RSA
encryption algorithm.  This program uses
iteration to determine all of the non-duplicate
values for e and d that can be used in
combination to encrypt and decrypt message values
ranging from 0 through 13 inclusive when n has a
value of 14.  Both e and d are constrained to
have values of 13 or less.

Tested using SDK 1.4.2 under WinXP.

The program output is:

n = 14
Range for m: 0 to 13
Range for e: 0 to 13
Range for d: 0 to 13
Allowable keys
d:11-e:5
d:13-e:7
d:5-e:11
d:7-e:13

Note that the program purposely excludes all
combinations for which d equals e.

Note that these four combinations occur as two
reciprocal pairs.  This confirms the notion that
either key can be used to encrypt with the other
key being use to decrypt.
************************************************/
import java.util.*;

class Rsa07{
  public static void main(String&#91;&#93; args){

    long e;//encryption key
    long d;//decryption key
    long n = 14;//fixed divisor
    long c;//encrypted value
    long x;//decrypted value

    Vector base = new Vector();
    Vector temp = new Vector();

    System.out.println("n = " + n);
    System.out.println(
                 "Range for m: 0 to " + (n - 1));
    System.out.println(
                 "Range for e: 0 to " + (n - 1));
    System.out.println(
                 "Range for d: 0 to " + (n - 1));

    //Iterate for all values of m from 1 to 13.
    // No need to include 0 because 0 raised to
    // any power is 0.
    for(long m = 1; m < n; m++){
      //Iterate for all values of e from 2 to 13.
      // No need to include 1 because raising the
      // message to the first power is not
      // interesting.
      for(e = 2; e < n; e++){
        //Compute the cipher value c for the
        // current value of m and the current
        // value of e.
        c = applyRSA(m,e,n);

        //Search for all values of d that will
        // successfully decrypt the cipher value.
        for(d=2;d < n;d++){
          //Decipher c using current value of d
          x = applyRSA(c,d,n);

          //Test for correct decyphered value.
          if(x == m){
            //Enable the following statement to
            // see intermediate results.
            //System.out.println(
            //  "Success, d=" + d + " e=" + e
            //   + " " + "m=" + m + " " + "c="
            //   + c + " " + "x=" + x);
            if(m == 1 && d != e){
              //Raising 1 to any power produces
              // 1.  Therefore, all combinations
              // of d and e will successfully
              // encrypt and decrypt a message
              // value of 1.  Store all
              // combinations of d and e in the
              // base Vector where they will be
              // systematically eliminated as the
              // remaining values of m are
              // processed.
              base.add(
                      "d:" + d + "-" + "e:" + e);
            }else if(d != e){
              //Store only those combinations of
              // d and e that will successfully
              // encrypt and decrypt this value
              // of m in the Vector named temp.
              // The contents of this Vector
              // will be matched to the contents
              // of base.  Any combination
              // contained in base that is not
              // also contained in temp will be
              // removed from base.  After all
              // values of m have been processed,
              // only those combinations of d and
              // e that successfully encrypt and
              // decrypt all values of m will
              // remain in base.
              temp.add(
                      "d:" + d + "-" + "e:" + e);
            }//end else
          }//end if(x == m)
        }//end for loop on d
      }//end for loop on e

      if(m > 1){
        //Remove all elements from base that are
        // not also contained in temp.
        andVectors(base,temp);
      }//end if
      //Initialize a new empty temp Vector for
      // processing the next value of m.
      temp = new Vector();
    }//end for loop on m

    //After all values for m have been processed,
    // display the remaining combinations of d
    // and e in base.
    System.out.println("Allowable keys");
    Iterator iter = base.iterator();
    while(iter.hasNext()){
      String str = (String)iter.next();
      System.out.println(str);
    }//end while

  }//end main
  //-------------------------------------------//

  //This method tests each element in base to see
  // if it is contained in temp.  If not, the
  // element is removed from base.  This
  // effectively performs an and operation
  // between base and temp leaving only those
  // elements in base that are contained in both
  // base and temp.
  static void andVectors(
                        Vector base,Vector temp){
    Iterator iter = base.iterator();
    while(iter.hasNext()){
      //Get next element from base.
      Object str = iter.next();

      //Test to see if temp contains a matching
      // element.  Remove the element from base
      // if there is no match.
      if(!temp.contains(str)){
        iter.remove();
      }//end if
    }//end while
  }//end andVectors
  //-------------------------------------------//

  //This method applies the RSA encryption
  // algorithm to an input value using an input
  // key and an input divisor.  It returns the
  // result as type long.
  static long applyRSA(long val,long exp,long n){
    long temp = val;
    //Raise the input value to the exp power.
    // Could use Math.pow method but might suffer
    // a loss of accuracy when converting result
    // from double to long.
    for(int cnt = 0; cnt < (exp - 1); cnt++){
      temp *= val;
      if(val >= (Long.MAX_VALUE/val - 1)){
        System.out.println(
                "Arithmetic overflow probable.");
        System.out.println(
                         "Terminating program.");
        System.exit(1);
      }//end if
    }//end for loop
    //Compute the modulus of the modified input
    // value using n as a modulus divisor.
    return temp % n;
  }//end applyRSA
  //-------------------------------------------//

}//end class Rsa07

<b>Listing 45</b>
</pre>
</td>
</tr>
</tbody>                                
</table><p>
<table border="1" cols="1" width="400" bgcolor="#FFFF00">
<tbody>
<tr>
<td>                     
<pre>
/*File Rsa08.java
Copyright 2004, R.G.Baldwin

The purpose of this program is to provide a very
simple and intuitive explanation of the RSA
encryption algorithm.  This program uses
iteration to determine all of the non-duplicate
values for e and d that can be used in
combination to encrypt and decrypt message values
ranging from 0 through n-1 inclusive.  Both e and
d are constrained to have values less than n.

This update to Rsa07 uses BigInteger rather than
long arithmetic to avoid arithmetic overflow and
to allow for the solution of larger problems than
can be solved using Rsa07.  Otherwise, the
algorithm used by this program is the same as the
algorithm used by Rsa07.

Thus, this program provides an introduction to
the use of BigInteger arithmetic.  You can solve
problems for values of n greater than is the
case with Rsa07.  However, if you make n much
larger than 77, be prepared to wait quite a while
for the solution to develop.

Note that there is no valid solution for some
values of n.  In that case, the list of allowable
keys presented by the program will simply be
blank.

Tested using SDK 1.4.2 under WinXP.

The program output for n = 77 is:

n = 77
Range for m: 0 to 76
Range for e: 0 to 76
Range for d: 0 to 76
Allowable keys
d:13-e:7
d:43-e:7
d:73-e:7
d:41-e:11
d:71-e:11
d:7-e:13
d:37-e:13
d:67-e:13
d:23-e:17
d:53-e:17
d:49-e:19
d:17-e:23
d:47-e:23
d:59-e:29
d:61-e:31
d:13-e:37
d:43-e:37
d:73-e:37
d:11-e:41
d:71-e:41
d:7-e:43
d:37-e:43
d:67-e:43
d:23-e:47
d:53-e:47
d:19-e:49
d:17-e:53
d:47-e:53
d:29-e:59
d:31-e:61
d:13-e:67
d:43-e:67
d:73-e:67
d:11-e:71
d:41-e:71
d:7-e:73
d:37-e:73
d:67-e:73

Note that the program purposely excludes all
combinations for which d equals e.

As was discussed in Rsa07, the solutions occur
in reciprocal value pairs.
************************************************/
import java.util.*;
import java.math.BigInteger;

class Rsa08{
  public static void main(String&#91;&#93; args){

    BigInteger e;//encryption key
    BigInteger d;//decryption key
    //Fixed divisor
    BigInteger n = new BigInteger("77");
    BigInteger c;//encrypted value
    BigInteger x;//decrypted value
    //Commonly used constant
    BigInteger bigOne = new BigInteger("1");

    Vector base = new Vector();
    Vector temp = new Vector();

    System.out.println("n = " + n);
    System.out.println("Range for m: 0 to "
                         + (n.subtract(bigOne)));
    System.out.println("Range for e: 0 to "
                         + (n.subtract(bigOne)));
    System.out.println("Range for d: 0 to "
                         + (n.subtract(bigOne)));

    //Iterate for all values of m from 1 to n-1.
    // No need to include 0 because 0 raised to
    // any power is 0.
    for(BigInteger m = new BigInteger("1");
          m.compareTo(n) < 0; m = m.add(bigOne)){
      //Iterate for all values of e from 2 to
      // n-1.  No need to include 1 because
      // raising the message to the first
      //power is not interesting.
      for(e = new BigInteger("2");
          e.compareTo(n) < 0; e = e.add(bigOne)){
        //Compute the cipher value c for the
        // current value of m and the current
        // value of e.
        c = applyRSA(m,e,n);

        //Search for all values of d from 2 to
        // n-1 that will successfully decrypt
        // the cipher value.
        for(d = new BigInteger("2");
           d.compareTo(n) < 0;d = d.add(bigOne)){
          //Decipher c using current value of d
          x = applyRSA(c,d,n);
          //Test for correct deciphered value.
          if(x.compareTo(m) == 0){//if(x == m)
            if((m.compareTo(bigOne) == 0)
                       && (d.compareTo(e) != 0)){
              //Raising 1 to any power produces
              // 1.  Therefore, all combinations
              // of d and e will successfully
              // encrypt and decrypt a message
              // value of 1.  Store all
              // combinations of d and e in the
              // base Vector where they will be
              // systematically eliminated as the
              // remaining values of m are
              // processed.
              base.add("d:" + d.toString() + "-"
                          + "e:" + e.toString());
            }else if(d.compareTo(e) != 0){
              //Store only those combinations of
              // d and e that will successfully
              // encrypt and decrypt this value
              // of m in the Vector named temp.
              // The contents of this Vector
              // will be matched to the contents
              // of base.  Any combination
              // contained in base that is not
              // also contained in temp will be
              // removed from base.  After all
              // values of m have been processed,
              // only those combinations of d and
              // e that successfully encrypt and
              // decrypt all values of m will
              // remain in base.
              temp.add("d:" + d.toString() + "-"
                          + "e:" + e.toString());
            }//end else
          }//end if(x == m)
        }//end for loop on d
      }//end for loop on e

      if(m.compareTo(bigOne) > 0){//if(m > 1)
        //Remove all elements from base that are
        // not also contained in temp.
        andVectors(base,temp);
      }//end if
      //Initialize a new empty temp Vector for
      // processing the next value of m.
      temp = new Vector();
    }//end for loop on m

    //After all values for m have been processed,
    // display the remaining combinations of d
    // and e in base.
    System.out.println("Allowable keys");
    Iterator iter = base.iterator();
    while(iter.hasNext()){
      String str = (String)iter.next();
      System.out.println(str);
    }//end while

  }//end main
  //-------------------------------------------//

  //This method tests each element in base to see
  // if it is contained in temp.  If not, the
  // element is removed from base.  This
  // effectively performs an and operation
  // between base and temp leaving only those
  // elements in base that are contained in both
  // base and temp.
  static void andVectors(
                        Vector base,Vector temp){
    Iterator iter = base.iterator();
    while(iter.hasNext()){
      //Get next element from base.
      Object str = iter.next();

      //Test to see if temp contains a matching
      // element.  Remove the element from base
      // if there is no match.
      if(!temp.contains(str)){
        iter.remove();
      }//end if
    }//end while
  }//end andVectors
  //-------------------------------------------//

  //This method applies the RSA encryption
  // algorithm to an input value using an input
  // key and an input divisor.  It returns the
  // result as type BigInteger.
  static BigInteger applyRSA(BigInteger val,
                             BigInteger exp,
                             BigInteger n){
    //Raise the input value to the exp power,
    // divide by n, throw away the quotient, and
    // return the remainder..
    return val.modPow(exp,n);
  }//end applyRSA
  //-------------------------------------------//

}//end class Rsa08

<b>Listing 46</b>
</pre>
</td>
</tr>
</tbody>                                
</table></p><p>
<table border="1" cols="1" width="400" bgcolor="#FFFF00">
<tbody>
<tr>
<td>                     
<pre>
/*File Rsa01.java
Copyright 2004, R.G.Baldwin

This program illustrates a very simple example
of encrypting and deciphering using the RSA
algorithm.

See the theoretical basis at:
http://theory.lcs.mit.edu/~rivest/rsapaper.pdf

This program implements the encrypting and
deciphering in the Small Example using p, q,
n, d, and e given in that example at the
above URL.

Another good reference is at:
http://www.math.mtu.edu/mathlab/COURSES/holt/dnt
/phi4.html

Tested using SDK 1.4.2 and WinXP.  This program
produces the following output:

p: 47
q: 59
n: 2773
d: 157
e: 17
plainText
ITS ALL GREEK TO ME
encodedText
0920190001121200071805051100201500130500
cipherText
0948234210841444266323900778077402191655
decipheredText
0920190001121200071805051100201500130500
outputText
ITS ALL GREEK TO ME

Note that the plainText string was extended by
one space character to make it evenly divisible
by 4.
************************************************/
import java.math.BigInteger;

class Rsa01{
  public static void main(String&#91;&#93; args){
    //Values from original author's web page.
    // See URL in above comments.
    BigInteger p = new BigInteger("47");
    BigInteger q = new BigInteger("59");
    BigInteger n = p.multiply(q);
    BigInteger d = new BigInteger("157");
    BigInteger e = new BigInteger("17");
    String plainText = "ITS ALL GREEK TO ME";

    //Strings to be populated by the program.
    String encodedText = "";
    String cipherText = "";
    String decipheredText = "";
    String outputText = "";

    System.out.println("p: " + p);
    System.out.println("q: " + q);
    System.out.println("n: " + n);
    System.out.println("d: " + d);
    System.out.println("e: " + e);

    Rsa01 obj = new Rsa01();

    //Force the plainText length to be a multiple
    // of half the block size to avoid end-effect
    // problem later.
    while(plainText.length()%4 != 0){
      //Append a space character on the end
      plainText += " ";
    }//end while
    System.out.println(
                      "plainText\n" + plainText);

    //Encode the plain text into numeric format
    // and display the result.
    encodedText = obj.encode(plainText);
    System.out.println(
                  "encodedText\n" + encodedText);

    //Encrypt the encoded text and display the
    // result.
    cipherText = obj.doRSA(encodedText,e,n);
    System.out.println(
                    "cipherText\n" + cipherText);

    //Decipher the cipherText and display the
    // result.  Should match the encoded text
    // above with the possibility of extra
    // characters to represent spaces at the
    // end.
    decipheredText = obj.doRSA(cipherText,d,n);
    System.out.println(
            "decipheredText\n" + decipheredText);

    //Decode back to plain text and display the
    // result.  Should match the input plainText
    // with the possibility of extra space
    // characters at the end.
    outputText = obj.decode(decipheredText);
    System.out.println(
                    "outputText\n" + outputText);
  }//end main
  //-------------------------------------------//

  //The purpose of this method is to encode a
  // plain text message into numeric format
  // where:
  // space = 00
  // A = 01
  // B = 02
  // C = 03
  // ...
  // J = 10, etc.
  // Note that this encoding method supports only
  // space characters and upper-case alphabetic
  // characters.
  String encode(String plainText){
    byte&#91;&#93; textChars = plainText.getBytes();
    String temp = "";
    String encodedText = "";

    //Build the encoded text string two numeric
    // characters at a time.  Each plainText
    // character is converted to two numeric
    // characters according to the relationships
    // given above.
    for(int cnt = 0; cnt < plainText.length();
                                          cnt++){
      temp = String.valueOf(
                       textChars&#91;cnt&#93; - 'A' + 1);
      //Handle the special case of a space
      // character.
      if(temp.equals("-32")) temp = "00";
      //Convert all single-character numeric
      // values to two characters with a leading
      // zero, as in 09.
      if(temp.length() < 2) temp = "0" + temp;
      encodedText += temp;
    }//end for loop
    return encodedText;
  }//end encode
  //-------------------------------------------//

  //The purpose of this method is to reverse the
  // encoding process implemented by the encode
  // method, converting a string of numeric
  // characters back to a text string containing
  // space characters and upper-case alphabetic
  // characters.
  String decode(String encodedText){
    String temp = "";
    String decodedText = "";
    for(int cnt = 0; cnt < encodedText.length();
                                       cnt += 2){
      temp = encodedText.substring(cnt,cnt + 2);
      //Convert two numeric text characters to a
      // value of type int.
      int val = Integer.parseInt(temp);
      //Convert int value to an ASCII character
      // value for the space character and the
      // upper-case alphabetic characters.
      if(val == 0){
        val = 32;//blank
      }else{
        val += ('A' -1);
      }//end else
      //Convert the ASCII character values to
      // numeric String values and build the
      // output String one character at a time.
      decodedText += String.valueOf((char)val);
    }//end for loop
    return decodedText;
  }//end decode
  //-------------------------------------------//

  //Apply the RSA algorithm to an input string
  // using the exponent exp and the modulus
  // operator n, which are provided as input
  // parameters.  This method can be used to
  // encrypt or to decipher the input string
  // depending on whether the exponent is an
  // encryption key or a decryption key.  Apply
  // the algorithm for a block size of four
  // characters.  This block size is based on the
  // known number of characters in the modulus
  // operator n, and may not be appropriate
  // for other modulus operators.  Thus, this is
  // not a general-purpose RSA method.
  String doRSA(String inputString,
                    BigInteger exp,BigInteger n){
    BigInteger block;
    BigInteger output;
    String temp = "";
    String outputString = "";

    //Iterate and process one block at a time.
    for(int cnt = 0; cnt < inputString.length();
                                       cnt += 4){
      //Get the next block of four characters
      // and encapsulate them in a BigInteger
      // object.
      temp = inputString.substring(cnt,cnt + 4);
      block = new BigInteger(temp);
      //Raise the block to the power exp, apply
      // the modulus operand n, and save the
      // remainder.  This is the essence of the
      // RSA algorithm.
      output = block.modPow(exp,n);
      //Convert the numeric result to a
      // four-character string, appending leading
      // zeros as necessary.
      temp = output.toString();
      if(temp.length() == 3){
        temp = "0" + temp;
      }else if(temp.length() == 2){
        temp = "00" + temp;
      }else if(temp.length() == 1){
        temp = "000" + temp;
      }//end else if
      //Build the outputString four characters at
      // a time.  Each character in the
      // inputString results in one character in
      // the outputString. Referring back to the
      // plainText string, encryption produces
      // two output characters for each character
      // in the plainText string after extending
      // the plainText string to make it
      // divisible by four if necessary.
      outputString += temp;
    }//end for loop

    return outputString;
  }//end doRSA
  //-------------------------------------------//
}//end class Rsa01

<b>Listing 47</b>
</pre>
</td>
</tr>
</tbody>                                
</table></p>
<p>
<table border="1" cols="1" width="400" bgcolor="#FFFF00">
<tbody>
<tr>
<td>                     
<pre>
/*File Rsa03.java
Copyright 2004, R.G.Baldwin

IMPORTANT:  THIS PROGRAM IS DESIGNED SPECIFICALLY
FOR INSTRUCTIONAL PURPOSES.  IT CANNOT BE USED
FOR BLOCK SIZES AND KEYS GREATER THAN 6
CHARACTERS IN LENGTH.

This is a significant update to Rsa01.  This
update makes the program more general.
Everything spawns from a specification of the
block size.  For example, this program includes
the computation of the encryption and
deciphering keys in addition to the modulus
operand n.

The encoding and decoding approach used in this
program supports the 95 ASCII characters between
space and tilde (~) inclusive.

This program uses the RSA algorithm to encrypt
and decipher a message containing 23 characters
using a block size of 4 producing the results
shown below.

You can experiment with different block sizes
by changing the value of the variable named
blockSize and recompiling.

You can experiment with different encryption
and deciphering keys as well as a different
modulus operand by changing the value of
the variable named e and recompiling.

You can also produce a different deciphering
key and a different modulus operand by changing
the initial value of p and recompiling.

This program should not be used for production
purposes.  If you need a Java program for
production use, you should develop it using Sun's
JCE API.

See the theoretical basis for RSA at:
http://theory.lcs.mit.edu/~rivest/rsapaper.pdf

Another good reference is at:
http://www.math.mtu.edu/mathlab/COURSES/holt/dnt
/phi4.html

Tested using SDK 1.4.2 and WinXP.  This program
produces the following output:

p: 19
q: 503
n: 9557
phi: 9036
e: 17
d: 7973
plainText
0123 89!@ abcd ABCD EF~-
encodedText
161718190024250132006566676800333435360037389413
cipherText
831382420004363732998462293181478621167049176719
decipheredText
161718190024250132006566676800333435360037389413
outputText
0123 89!@ abcd ABCD EF~-

Also note that you can reverse the use of the
two keys and get the same results.  In other
words, it doesn't matter which key you use to
encrypt the message into cipherText as long
as you use the other key to decipher the
cipherText.

In order for this algorithm to work correctly, it
is necessary for the value of n to be greater
than the maximum value of an encoded data block.
It is also necessary for the number of characters
in the value of n to be less than or equal to the
block size.  If the program is unable to satisfy
both conditions simultaneously, it terminates
with an error message.
************************************************/
import java.math.BigInteger;

class Rsa03{
  //This is a static inner class whose sole
  // purpose is to create an object that serves
  // as a container for several important
  // parameters.  It was made static so that
  // it can be instantiated from within main.
  static class Params{
    BigInteger p = new BigInteger("0");
    BigInteger q = new BigInteger("0");
    BigInteger n = new BigInteger("0");
    BigInteger d = new BigInteger("0");
    BigInteger e = new BigInteger("15");
    BigInteger phi = new BigInteger("0");
    BigInteger max;
  }//end inner class Params

  public static void main(String&#91;&#93; args){
    //Instantiate an object in which to store
    // parameters.
    Params par = new Params();

    //Test data.
    String plainText = "0123 89!@ abcd ABCD EF~";

    //Strings to be populated by the program.
    String encodedText = "";
    String cipherText = "";
    String decipheredText = "";
    String outputText = "";

    //Set blockSize and make certain that it is
    // divisible by 2.
    int blockSize = 4;
    if(blockSize % 2 != 0){
      System.out.println(
                       "blockSize must be even");
      System.exit(1);
    }//end if

    //Get and save the maximum value of an
    // encoded string for the specified block
    // size and the encoding format used.
    String maxEncodedString = "";
    for(int cnt = 0; cnt < blockSize; cnt += 2){
      maxEncodedString += "94";
    }//end for loop
    par.max = new BigInteger(maxEncodedString);

    //Create an initial value for p.  The final
    // value for p will be a prime close to this
    // value.  Could use a random number
    // generator here to cause this value to be
    // random.
    par.p = par.max.divide(
                          new BigInteger("502"));

    //Instantiate an object of this class
    Rsa03 obj = new Rsa03();

    //Get and display the key values along with
    // the other parameter values.
    obj.getKeys(par,blockSize);
    System.out.println("p: " + par.p);
    System.out.println("q: " + par.q);
    System.out.println("n: " + par.n);
    System.out.println("phi: " + par.phi);
    System.out.println("e: " + par.e);
    System.out.println("d: " + par.d);

    //Force the plainText length to be a multiple
    // of half the block length to avoid
    // end-effect problems later.
    while(plainText.length()%(blockSize/2) != 0){
      //Append a visible character on the end.
      // A space would probably be better, but
      // I wanted to be able to see the extension
      // character for illustration purposes.
      // Remember, this code is intended for
      // illustration of the algorithm and is
      // not intended for production use.
      plainText += "-";
    }//end while
    System.out.println(
                      "plainText\n" + plainText);

    //Encode the plain text into numeric format
    // and display the result.  Note that
    // encoding is not the same as encrypting.
    // Encoding simply prepares the message
    // for encryption by converting it to a
    // numeric representation.
    encodedText = obj.encode(plainText);
    System.out.println(
                  "encodedText\n" + encodedText);

    //Encrypt the encoded text and display the
    // result.
    cipherText = obj.doRSA(encodedText,par.e,
                                par.n,blockSize);
    System.out.println(
                    "cipherText\n" + cipherText);

    //Decipher the cipherText and display the
    // result.  Should match the encoded text
    // above.
    decipheredText = obj.doRSA(cipherText,par.d
                               ,par.n,blockSize);
    System.out.println(
            "decipheredText\n" + decipheredText);

    //Decode back to plain text and display the
    // result.  Should match the input plainText
    // with the possibility that extra characters
    // were added at the end.
    outputText = obj.decode(decipheredText);
    System.out.println(
                    "outputText\n" + outputText);

  }//end main
  //-------------------------------------------//

  //The purpose of this method is to create the
  // encryption and decryption keys, e and d,
  // along with the modulus operator, n, and
  // some other important parameters.
  void getKeys(Params par,int blockSize){

    //A frequently used constant
    BigInteger bigOne = new BigInteger("1");

    //Select two prime numbers, p and q, such
    // that n = p*q > max and the number of
    // characters in n is <= blockSize, where
    // max is the maximum possible data value in
    // a data block.
    //Use the incoming first guess for p and then
    // iterate by increasing the value of p until
    // a highly-probable prime number is
    // found.

    while(!(par.p.isProbablePrime(1000))){
      par.p = par.p.add(bigOne);
    }//end while loop

    //Make the first guess for q one less than p
    // and then iterate until a highly-probable
    // prime number is found for q that satisfies
    // the two conditions given above.
    String firstQ =
                   "" + (par.p.subtract(bigOne));
    par.q = new BigInteger(firstQ);

    //First, without regard for prime, get a
    // value for q for which the number of
    // digits in the product p*q doesn't exceed
    // the block size.  Do this by successively
    // halving the value for q until the
    // condition is satisfied.
    par.n = par.p.multiply(par.q);
    while(par.n.toString().length() > blockSize){
      par.q = par.q.divide(new BigInteger("2"));
      par.n = par.p.multiply(par.q);
    }//end while

    //Divide q by 2 one more time to allow for
    // incrementing later on.
    par.q = par.q.divide(new BigInteger("2"));

    //The current value of q satisfies one of
    // the required conditions, but may not be
    // a prime number.  Get the next prime number
    // smaller than the current value of q.
    while(!(par.q.isProbablePrime(1000))){
      par.q = par.q.subtract(bigOne);
    }//end while loop

    //Now we have a prime value for q that
    // satisfies one of the two required
    // conditions.  Compute the current value
    // for n and start working to confirm or
    // satisfy the other condition.
    par.n = par.p.multiply(par.q);

    //Confirm that p*q > max.  If not, increase
    // the value of q until the condition is met.
    // This adjustment could violate the first
    // condition.
    while(par.n.compareTo(par.max) <= 0){
      //Get a larger prime value for q
      par.q = par.q.add(bigOne);
      while(!(par.q.isProbablePrime(1000))){
        par.q = par.q.add(bigOne);
      }//end while loop
      //Compute the new value for n and go back
      // to the top and test again.
      par.n = par.p.multiply(par.q);
    }//end while loop

    //Confirm that both conditions are still
    // being met.  If either condition is not
    // being met, terminate the program.
    if((par.n.toString().length() > blockSize)
             || (par.n.compareTo(par.max) <= 0)){
      System.out.println(
              "Required conditions are not met");
      System.exit(1);
    }//end if

    //Compute phi, as (p - 1)*(q - 1).
    BigInteger pPrime = par.p.subtract(bigOne);
    BigInteger qPrime = par.q.subtract(bigOne);
    par.phi = pPrime.multiply(qPrime);

    //Compute e.  First guess is incoming
    // value.
    while(!par.e.gcd(par.phi).equals(bigOne)){
      par.e = par.e.add(bigOne);
    }//end while loop

    //Compute the value for d
    par.d = par.e.modInverse(par.phi);

    if(blockSize > 6)System.exit(0);

  }//end getKeys
  //-------------------------------------------//

  //The purpose of this method is to encode a
  // plain text message into numeric format
  // where:
  // space = 32 - 32 = 0
  // A = 65 - 32 = 33
  // ...
  // Z = 90 - 32 = 58
  // ...
  // a = 97 - 32 = 65
  // ...
  // ~ = 126 - 32 = 94

  //Note that this encoding method supports all
  //of the ASCII characters from space through
  // tilde (~) inclusive.
  String encode(String plainText){
    byte&#91;&#93; textChars = plainText.getBytes();
    String temp = "";
    String encodedText = "";

    //Build the encoded text string two numeric
    // characters at a time.  Each plainText
    // character is converted into two numeric
    // characters according to the relationships
    // given above.
    for(int cnt = 0; cnt < plainText.length();
                                          cnt++){
      temp = String.valueOf(
                       textChars&#91;cnt&#93; - ' ');
      //Convert all single-character numeric
      // values to two characters with a leading
      // zero, as in 09.
      if(temp.length() < 2) temp = "0" + temp;
      encodedText += temp;
    }//end for loop
    return encodedText;
  }//end encode
  //-------------------------------------------//

  //The purpose of this method is to reverse the
  // encoding process implemented by the encode
  // method, converting a string of numeric
  // characters back to a text string containing
  // the ASCII characters from space through
  // tilde.
  String decode(String encodedText){
    String temp = "";
    String decodedText = "";
    for(int cnt = 0; cnt < encodedText.length();
                                       cnt += 2){
      temp = encodedText.substring(cnt,cnt + 2);
      //Convert two numeric text characters to a
      // value of type int.
      int val = Integer.parseInt(temp) + 32;
      //Convert the ASCII character values to
      // numeric String values and build the
      // output String one character at a time.
      decodedText += String.valueOf((char)val);
    }//end for loop
    return decodedText;
  }//end decode
  //-------------------------------------------//

  //Apply the RSA algorithm to an input string
  // using the exponent exp and the modulus
  // operator n, which are provided as input
  // parameters.  This method can be used to
  // encrypt or to decipher the input string
  // depending on whether the exponent is an
  // encryption key or a decryption key.  Apply
  // the algorithm for the block size given by
  // the incoming parameter named blockSize.
  String doRSA(String inputString,
               BigInteger exp,
               BigInteger n,
               int blockSize){

    BigInteger block;
    BigInteger output;
    String temp = "";
    String outputString = "";

    //Iterate and process one block at a time.
    for(int cnt = 0; cnt < inputString.length();
                               cnt += blockSize){
      //Get the next block of characters
      // and encapsulate them in a BigInteger
      // object.
      temp = inputString.substring(
                            cnt,cnt + blockSize);

      block = new BigInteger(temp);
      //Raise the block to the power exp, apply
      // the modulus operand n, and save the
      // remainder.  This is the essence of the
      // RSA algorithm.
      output = block.modPow(exp,n);

      //Convert the numeric result to a
      // four-character string, appending leading
      // zeros as necessary.
      temp = output.toString();
      while(temp.length() < blockSize){
        temp = "0" + temp;
      }//end while

      //Build the outputString blockSize
      // characters at a time.  Each character
      // in the inputString results in one
      // character in the outputString.
      outputString += temp;
    }//end for loop

    return outputString;
  }//end doRSA
  //-------------------------------------------//

}//end class Rsa03

<b>Listing 48</b>
</pre>
</td>
</tr>
</tbody>                                
</table></p>
<p>
<hr size="3" width="100%" align="center">    
<p>Copyright 2004, Richard G. Baldwin.&nbsp; Reproduction in whole or in
part in any form or medium without express written permission from Richard
Baldwin is prohibited. </p>
     
<h4> <a name="About_the_author">About the author</a></h4><b>
<a href="mailto:baldwin@dickbaldwin.com">Richard Baldwin</a></b><i>
  is a college professor (at Austin Community College in Austin, TX) and
private  consultant whose primary focus is a combination of Java, C#, and
XML. In addition to the many platform and/or language independent benefits
of Java and C# applications, he believes that a combination of Java, C#,
and XML will become the primary driving force in the delivery of structured
information on the Web.</i>    
<p><i>Richard has participated in numerous consulting projects, and he frequently 
 provides onsite training at the high-tech companies located in and around 
 Austin, Texas.&nbsp; He is the author of Baldwin's Programming <a
 href="http://www.dickbaldwin.com">Tutorials</a>,
  which has gained a worldwide following among experienced and aspiring programmers.
  He has also published articles in JavaPro magazine.</i> </p>
     
<p><i>In addition to his programming expertise, Richard has many years of 
 practical experience in Digital Signal Processing (DSP).&nbsp; His first
 job after he earned his Bachelor's degree was doing DSP in the Seismic Research 
 Department of Texas Instruments.&nbsp; (TI is still a world leader in DSP.)&nbsp; 
 In the following years, he applied his programming and DSP expertise to other
 interesting areas including sonar and underwater acoustics.</i> </p>
     
<p><i>Richard holds an MSEE degree from Southern Methodist University and
  has many years of experience in the application of computer technology
to  real-world problems.</i> </p>
     
<p><i><a href="mailto:baldwin@dickbaldwin.com">Baldwin@DickBaldwin.com</a></i>
  </p>
     
<p>-end- </p>
<!--content_stop-->			
			</div>
			
			<div class="paging">
				<span class="numbers">
<a href="javascript:void(0);">1</a> 
</span>
			</div>
			
			<br>
			<br>
			
<!-- START COMMENTING CODE -->
<script type="text/javascript" src="http://community.internet.com/earthweb/earthweb.cfm?site=developer&article_id=3447491&URL=http://www.developer.com/security/article.php/3447491/Public-Key-Cryptography-101-Using-Java&title=Public Key Cryptography 101 Using Java"></script>
<script language="javascript">
callScript("http://community.internet.com/earthweb/newCaptcha.cfm");
</script> 
<br>
<!-- END COMMENTING CODE -->
			
			<div class="vspace"></div>
			
			<p></p>
			
			<div class="adsBox ads4">
				<div class="ads_itoffer">
					<span class="title">Networking Solutions</span>
					<ul class="noBullets">
<!-- "featured_links" begin" -->

	<!------ OAS AD 'fl1' begin ------>
	<SCRIPT LANGUAGE=JavaScript>
	<!--
	OAS_AD('fl1');
	//-->
	</SCRIPT>
	<NOSCRIPT>
	<A HREF="http://63.236.18.118/RealMedia/ads/click_nx.ads/intm/webdev/www.developer.com/security@house_ribbon,468x60-1,468x60-2,336x280,flex,336x280-2,120x60-1,120x60-2,120x60-3,125x125-1,125x125-2,125x800,accessunit,accessunit_one,accessunit_two,accessunit_three,ciu,cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10,cp11,cp12,cp13,cp14,fl1,fl2,fl3,fl4,fl5,send,morph!fl1" >
	<IMG SRC="http://63.236.18.118/RealMedia/ads/adstream_nx.ads/intm/webdev/www.developer.com/security@house_ribbon,468x60-1,468x60-2,336x280,flex,336x280-2,120x60-1,120x60-2,120x60-3,125x125-1,125x125-2,125x800,accessunit,accessunit_one,accessunit_two,accessunit_three,ciu,cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10,cp11,cp12,cp13,cp14,fl1,fl2,fl3,fl4,fl5,send,morph!fl1" border=0>
	</A>
	</NOSCRIPT>
	<!------ OAS AD 'fl1' end ------>
	<br>
	<!------ OAS AD 'fl2' begin ------>
	<SCRIPT LANGUAGE=JavaScript>
	<!--
	OAS_AD('fl2');
	//-->
	</SCRIPT>
	<NOSCRIPT>
	<A HREF="http://63.236.18.118/RealMedia/ads/click_nx.ads/intm/webdev/www.developer.com/security@house_ribbon,468x60-1,468x60-2,336x280,flex,336x280-2,120x60-1,120x60-2,120x60-3,125x125-1,125x125-2,125x800,accessunit,accessunit_one,accessunit_two,accessunit_three,ciu,cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10,cp11,cp12,cp13,cp14,fl1,fl2,fl3,fl4,fl5,send,morph!fl2" >
	<IMG SRC="http://63.236.18.118/RealMedia/ads/adstream_nx.ads/intm/webdev/www.developer.com/security@house_ribbon,468x60-1,468x60-2,336x280,flex,336x280-2,120x60-1,120x60-2,120x60-3,125x125-1,125x125-2,125x800,accessunit,accessunit_one,accessunit_two,accessunit_three,ciu,cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10,cp11,cp12,cp13,cp14,fl1,fl2,fl3,fl4,fl5,send,morph!fl2" border=0>
	</A>
	</NOSCRIPT>
	<!------ OAS AD 'fl2' end ------>
	<br>
	<!------ OAS AD 'fl3' begin ------>
	<SCRIPT LANGUAGE=JavaScript>
	<!--
	OAS_AD('fl3');
	//-->
	</SCRIPT>
	<NOSCRIPT>
	<A HREF="http://63.236.18.118/RealMedia/ads/click_nx.ads/intm/webdev/www.developer.com/security@house_ribbon,468x60-1,468x60-2,336x280,flex,336x280-2,120x60-1,120x60-2,120x60-3,125x125-1,125x125-2,125x800,accessunit,accessunit_one,accessunit_two,accessunit_three,ciu,cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10,cp11,cp12,cp13,cp14,fl1,fl2,fl3,fl4,fl5,send,morph!fl3" >
	<IMG SRC="http://63.236.18.118/RealMedia/ads/adstream_nx.ads/intm/webdev/www.developer.com/security@house_ribbon,468x60-1,468x60-2,336x280,flex,336x280-2,120x60-1,120x60-2,120x60-3,125x125-1,125x125-2,125x800,accessunit,accessunit_one,accessunit_two,accessunit_three,ciu,cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10,cp11,cp12,cp13,cp14,fl1,fl2,fl3,fl4,fl5,send,morph!fl3" border=0>
	</A>
	</NOSCRIPT>
	<!------ OAS AD 'fl3' end ------>
	<br>
	<!------ OAS AD 'fl4' begin ------>
	<SCRIPT LANGUAGE=JavaScript>
	<!--
	OAS_AD('fl4');
	//-->
	</SCRIPT>
	<NOSCRIPT>
	<A HREF="http://63.236.18.118/RealMedia/ads/click_nx.ads/intm/webdev/www.developer.com/security@house_ribbon,468x60-1,468x60-2,336x280,flex,336x280-2,120x60-1,120x60-2,120x60-3,125x125-1,125x125-2,125x800,accessunit,accessunit_one,accessunit_two,accessunit_three,ciu,cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10,cp11,cp12,cp13,cp14,fl1,fl2,fl3,fl4,fl5,send,morph!fl4" >
	<IMG SRC="http://63.236.18.118/RealMedia/ads/adstream_nx.ads/intm/webdev/www.developer.com/security@house_ribbon,468x60-1,468x60-2,336x280,flex,336x280-2,120x60-1,120x60-2,120x60-3,125x125-1,125x125-2,125x800,accessunit,accessunit_one,accessunit_two,accessunit_three,ciu,cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10,cp11,cp12,cp13,cp14,fl1,fl2,fl3,fl4,fl5,send,morph!fl4" border=0>
	</A>
	</NOSCRIPT>
	<!------ OAS AD 'fl4' end ------>
	<br>
	<!------ OAS AD 'fl5' begin ------>
	<SCRIPT LANGUAGE=JavaScript>
	<!--
	OAS_AD('fl5');
	//-->
	</SCRIPT>
	<NOSCRIPT>
	<A HREF="http://63.236.18.118/RealMedia/ads/click_nx.ads/intm/webdev/www.developer.com/security@house_ribbon,468x60-1,468x60-2,336x280,flex,336x280-2,120x60-1,120x60-2,120x60-3,125x125-1,125x125-2,125x800,accessunit,accessunit_one,accessunit_two,accessunit_three,ciu,cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10,cp11,cp12,cp13,cp14,fl1,fl2,fl3,fl4,fl5,send,morph!fl5" >
	<IMG SRC="http://63.236.18.118/RealMedia/ads/adstream_nx.ads/intm/webdev/www.developer.com/security@house_ribbon,468x60-1,468x60-2,336x280,flex,336x280-2,120x60-1,120x60-2,120x60-3,125x125-1,125x125-2,125x800,accessunit,accessunit_one,accessunit_two,accessunit_three,ciu,cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10,cp11,cp12,cp13,cp14,fl1,fl2,fl3,fl4,fl5,send,morph!fl5" border=0>
	</A>
	</NOSCRIPT>
	<!------ OAS AD 'fl5' end ------>
	<br><!-- "featured_links" end" -->
					</ul>
				</div>
			</div>
			
		</div>
		
<!-- #include virtual="/component.php/10915_S_article.body.navbar(right)"-->
<div class="col colRight dimMainRight">
	<form action="http://member.internet.com/subscribe.php" method="post" name="sub2nl">
	<div class="newsletter_holder">Free Newsletters :
		<select name="list_names[]" class="dropdown">
			<option value="earthweb-developer-1-html" selected>Developer.com Update</option>
			<option value="dev-javaopensource-daily-html">Java/Open Source Daily</option>
			<option value="earthweb-code-guru-update-html">Codeguru.com Update</option>
			<option value="earthweb-jars-java-update-html">Jars.com Update</option>
			<option value="15seconds-html">15Seconds HTML</option>
			<option value="4guysfromrolla-html">4 Guys from Rolla</option>
			<option value="asp101-html">ASP 101</option>
			<option value="sqlwire-html">Database Journal</option>
			<option value="dba-support-html">DBASupport</option>
			<option value="javaboutique-jnews-html">Java Boutique JNews</option>
			<option value="webdeveloper-weekly-html">WebDeveloper.com</option>
			<option value="webreference-update-html">WebReference HTML</option>
			<option value="virtualdr-html">Virtual Dr. Text</option>
			<option value="enterprise-networking-planet-html">Enterprise Networking Planet</option>
		</select>
		<input type="hidden" value="http://e-newsletters.internet.com/earthweb_opt-in.html" name="redirect_ok" />
		<a href="javascript:void(0);" onclick="document.forms['sub2nl'].submit(); return false;" class="button"><img src="/images0/search_button.png" alt="" width="29" height="26" border="0" /></a>
	</div>
	</form>	
	<div class="vspace" style="height:5px;"></div>
	
	<div class="adsBox">
<!-- "336x280" begin -->

<!------ OAS AD '336x280' begin ------>
<SCRIPT LANGUAGE=JavaScript>
<!--
OAS_AD('336x280');
//-->
</SCRIPT>
<NOSCRIPT>
<A HREF="http://63.236.18.118/RealMedia/ads/click_nx.ads/intm/webdev/www.developer.com/security@house_ribbon,468x60-1,468x60-2,336x280,flex,336x280-2,120x60-1,120x60-2,120x60-3,125x125-1,125x125-2,125x800,accessunit,accessunit_one,accessunit_two,accessunit_three,ciu,cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10,cp11,cp12,cp13,cp14,fl1,fl2,fl3,fl4,fl5,send,morph!336x280" >
<IMG SRC="http://63.236.18.118/RealMedia/ads/adstream_nx.ads/intm/webdev/www.developer.com/security@house_ribbon,468x60-1,468x60-2,336x280,flex,336x280-2,120x60-1,120x60-2,120x60-3,125x125-1,125x125-2,125x800,accessunit,accessunit_one,accessunit_two,accessunit_three,ciu,cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10,cp11,cp12,cp13,cp14,fl1,fl2,fl3,fl4,fl5,send,morph!336x280" border=0>
</A>
</NOSCRIPT>
<!------ OAS AD '336x280' end ------><!-- "336x280" end -->

	</div>
	
	<div class="vspace"></div>
	
	<div class="adsBox">
<!-- "accessunit" begin -->

<!------ OAS AD 'accessunit' begin ------>
<SCRIPT LANGUAGE=JavaScript>
<!--
OAS_AD('accessunit');
//-->
</SCRIPT>
<NOSCRIPT>
<A HREF="http://63.236.18.118/RealMedia/ads/click_nx.ads/intm/webdev/www.developer.com/security@house_ribbon,468x60-1,468x60-2,336x280,flex,336x280-2,120x60-1,120x60-2,120x60-3,125x125-1,125x125-2,125x800,accessunit,accessunit_one,accessunit_two,accessunit_three,ciu,cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10,cp11,cp12,cp13,cp14,fl1,fl2,fl3,fl4,fl5,send,morph!accessunit" >
<IMG SRC="http://63.236.18.118/RealMedia/ads/adstream_nx.ads/intm/webdev/www.developer.com/security@house_ribbon,468x60-1,468x60-2,336x280,flex,336x280-2,120x60-1,120x60-2,120x60-3,125x125-1,125x125-2,125x800,accessunit,accessunit_one,accessunit_two,accessunit_three,ciu,cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10,cp11,cp12,cp13,cp14,fl1,fl2,fl3,fl4,fl5,send,morph!accessunit" border=0>
</A>
</NOSCRIPT>
<!------ OAS AD 'accessunit' end ------><!-- "accessunit" end -->

	</div>
	
	<div class="vspace"></div>
	
	<div id="mostPopularStories" class="section">
		<div class="sectionHeader">
			<h2>Most Popular Stories</h2>
			<a href="#" class="more"></a>
		</div>
		<div class="sectionContent">
			<div class="tabs">
				<div class="tabsMenu clearfix">
					<ul>
						<li><a href="#mostPopularToday" class="selected">Today</a></li>
						<li><a href="#mostPopularThisWeek">This Week</a></li>
						<li><a href="#mostPopularAllTime">All-Time</a></li>
					</ul>
				</div>
				<div class="tabsContents">
					<div class="tabsContent selected" id="mostPopularToday">
						<ul>
				<li><a href="http://www.developer.com/lang/php/article.php/3862461/Facebooks-HipHop-Goes-Public-With-a-New-PHP-Runtime.htm"><span class="graytext">1</span> Facebook's HipHop Goes Public With a New PHP Runtime</a></li>
				<li><a href="http://www.developer.com/java/data/article.php/3417381/Using-JDBC-with-MySQL-Getting-Started.htm"><span class="graytext">2</span> Using JDBC with MySQL, Getting Started</a></li>
				<li><a href="http://www.developer.com/design/article.php/2109801/Creating-Use-Case-Diagrams.htm"><span class="graytext">3</span> Creating Use Case Diagrams</a></li>
				<li><a href="http://www.developer.com/db/article.php/3379271/Oracle-Programming-with-PLSQL-Collections.htm"><span class="graytext">4</span> Oracle Programming with PL/SQL Collections</a></li>
				<li><a href="http://www.developer.com/net/csharp/article.php/3489611/Manipulate-XML-File-Data-Using-C.htm"><span class="graytext">5</span> Manipulate XML File Data Using C#</a></li>

						</ul>
					</div>
					<div class="tabsContent" id="mostPopularThisWeek">
						<ul>
				<li><a href="http://www.developer.com/java/data/article.php/3417381/Using-JDBC-with-MySQL-Getting-Started.htm"><span class="graytext">1</span> Using JDBC with MySQL, Getting Started</a></li>
				<li><a href="http://www.developer.com/design/article.php/2109801/Creating-Use-Case-Diagrams.htm"><span class="graytext">2</span> Creating Use Case Diagrams</a></li>
				<li><a href="http://www.developer.com/db/article.php/3379271/Oracle-Programming-with-PLSQL-Collections.htm"><span class="graytext">3</span> Oracle Programming with PL/SQL Collections</a></li>
				<li><a href="http://www.developer.com/net/csharp/article.php/3489611/Manipulate-XML-File-Data-Using-C.htm"><span class="graytext">4</span> Manipulate XML File Data Using C#</a></li>
				<li><a href="http://www.developer.com/net/asp/article.php/3299641/ServerTransfer-Vs-ResponseRedirect.htm"><span class="graytext">5</span> Server.Transfer Vs. Response.Redirect</a></li>

						</ul>
					</div>
					<div class="tabsContent" id="mostPopularAllTime">
						<ul>
				<li><a href="http://www.developer.com/ws/article.php/3857796/An-Android-Developers-Top-10-Gripes.htm"><span class="graytext">1</span> An Android Developer's Top 10 Gripes</a></li>
				<li><a href="http://www.developer.com/java/data/article.php/3417381/Using-JDBC-with-MySQL-Getting-Started.htm"><span class="graytext">2</span> Using JDBC with MySQL, Getting Started</a></li>
				<li><a href="http://www.developer.com/design/article.php/2109801/Creating-Use-Case-Diagrams.htm"><span class="graytext">3</span> Creating Use Case Diagrams</a></li>
				<li><a href="http://www.developer.com/net/csharp/article.php/3489611/Manipulate-XML-File-Data-Using-C.htm"><span class="graytext">4</span> Manipulate XML File Data Using C#</a></li>
				<li><a href="http://www.developer.com/db/article.php/3379271/Oracle-Programming-with-PLSQL-Collections.htm"><span class="graytext">5</span> Oracle Programming with PL/SQL Collections</a></li>

						</ul>
					</div>
				</div>
			</div>
		</div>
	</div>
	
<!-- "flex" begin -->

<!------ OAS AD 'flex' begin ------>
<SCRIPT LANGUAGE=JavaScript>
<!--
OAS_AD('flex');
//-->
</SCRIPT>
<NOSCRIPT>
<A HREF="http://63.236.18.118/RealMedia/ads/click_nx.ads/intm/webdev/www.developer.com/security@house_ribbon,468x60-1,468x60-2,336x280,flex,336x280-2,120x60-1,120x60-2,120x60-3,125x125-1,125x125-2,125x800,accessunit,accessunit_one,accessunit_two,accessunit_three,ciu,cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10,cp11,cp12,cp13,cp14,fl1,fl2,fl3,fl4,fl5,send,morph!flex" >
<IMG SRC="http://63.236.18.118/RealMedia/ads/adstream_nx.ads/intm/webdev/www.developer.com/security@house_ribbon,468x60-1,468x60-2,336x280,flex,336x280-2,120x60-1,120x60-2,120x60-3,125x125-1,125x125-2,125x800,accessunit,accessunit_one,accessunit_two,accessunit_three,ciu,cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10,cp11,cp12,cp13,cp14,fl1,fl2,fl3,fl4,fl5,send,morph!flex" border=0>
</A>
</NOSCRIPT>
<!------ OAS AD 'flex' end ------><!-- "flex" end -->
	
	<div class="vspace"></div>
	
	<div id="mostCommentedOn" class="section">
		<div class="sectionHeader">
			<h2>Most Commented On</h2>
			<a href="#" class="more"></a>
		</div>
		<div class="sectionContent">
			<div class="tabs">
				<div class="tabsMenu clearfix">
					<ul>
						<li><a href="#mostCommentedOnThisWeek" class="selected">This Week</a></li>
						<li><a href="#mostCommentedOnThisMonth">This Month</a></li>
						<li><a href="#mostCommentedOnAllTime">All-Time</a></li>
					</ul>
				</div>
				<div class="tabsContents">
					<div class="tabsContent selected" id="mostCommentedOnThisWeek">
						<ul>
<li><a href="http://www.developer.com/article.php/3861841"><span class="graytext">1</span> Gardening with Drupal and Dries</a></li>
<li><a href="http://www.developer.com/article.php/777761"><span class="graytext">2</span> Day 1: Learning the Basics of PL/SQL</a></li>
<li><a href="http://www.developer.com/article.php/2109801"><span class="graytext">3</span> Creating Use Case Diagrams</a></li>
<li><a href="http://www.developer.com/article.php/3417381"><span class="graytext">4</span> Using JDBC with MySQL, Getting Started</a></li>
<li><a href="http://www.developer.com/article.php/1463281"><span class="graytext">5</span> Useful Estimation Techniques for Software Projects</a></li>




						</ul>
					</div>
					<div class="tabsContent" id="mostCommentedOnThisMonth">
						<ul>
<li><a href="http://www.developer.com/article.php/3857796"><span class="graytext">1</span> An Android Developer's Top 10 Gripes</a></li>
<li><a href="http://www.developer.com/article.php/3856906"><span class="graytext">2</span> Java vs. C++: The Performance Showdown</a></li>
<li><a href="http://www.developer.com/article.php/777761"><span class="graytext">3</span> Day 1: Learning the Basics of PL/SQL</a></li>
<li><a href="http://www.developer.com/article.php/3417381"><span class="graytext">4</span> Using JDBC with MySQL, Getting Started</a></li>
<li><a href="http://www.developer.com/article.php/3856246"><span class="graytext">5</span> Fat Models and Skinny Controllers Bring Out the Best in Your MVC Framework</a></li>




						</ul>
					</div>
					<div class="tabsContent" id="mostCommentedOnAllTime">
						<ul>
<li><a href="http://www.developer.com/article.php/2109801"><span class="graytext">1</span> Creating Use Case Diagrams</a></li>
<li><a href="http://www.developer.com/article.php/3336751"><span class="graytext">2</span> C# Tip: Placing Your C# Application in the System Tray</a></li>
<li><a href="http://www.developer.com/article.php/777761"><span class="graytext">3</span> Day 1: Learning the Basics of PL/SQL</a></li>
<li><a href="http://www.developer.com/article.php/3096831"><span class="graytext">4</span> Using ASP.NET To Send Email</a></li>
<li><a href="http://www.developer.com/article.php/3417381"><span class="graytext">5</span> Using JDBC with MySQL, Getting Started</a></li>




						</ul>
					</div>
				</div>
			</div>
		</div>
	</div>
	
	<div class="clearfix partners_ITs">
		<div class="colLeft">
			<div id="partners" class="section">
				<div class="sectionHeader">
					<h3>Partners</h3>
				</div>
				<div class="sectionContent">
					<ul class="noBullets">
						<li><a href="http://www.jupitermedia.com/partners/">Partner With Us</a></li>

<!-- "CP" begin -->

	<!------ OAS AD 'cp1' begin ------>
	<SCRIPT LANGUAGE=JavaScript>
	<!--
	OAS_AD('cp1');
	//-->
	</SCRIPT>
	<NOSCRIPT>
	<A HREF="http://63.236.18.118/RealMedia/ads/click_nx.ads/intm/webdev/www.developer.com/security@house_ribbon,468x60-1,468x60-2,336x280,flex,336x280-2,120x60-1,120x60-2,120x60-3,125x125-1,125x125-2,125x800,accessunit,accessunit_one,accessunit_two,accessunit_three,ciu,cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10,cp11,cp12,cp13,cp14,fl1,fl2,fl3,fl4,fl5,send,morph!cp1" >
	<IMG SRC="http://63.236.18.118/RealMedia/ads/adstream_nx.ads/intm/webdev/www.developer.com/security@house_ribbon,468x60-1,468x60-2,336x280,flex,336x280-2,120x60-1,120x60-2,120x60-3,125x125-1,125x125-2,125x800,accessunit,accessunit_one,accessunit_two,accessunit_three,ciu,cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10,cp11,cp12,cp13,cp14,fl1,fl2,fl3,fl4,fl5,send,morph!cp1" border=0>
	</A>
	</NOSCRIPT>
	<!------ OAS AD 'cp1' end ------>
	<br>
	<!------ OAS AD 'cp2' begin ------>
	<SCRIPT LANGUAGE=JavaScript>
	<!--
	OAS_AD('cp2');
	//-->
	</SCRIPT>
	<NOSCRIPT>
	<A HREF="http://63.236.18.118/RealMedia/ads/click_nx.ads/intm/webdev/www.developer.com/security@house_ribbon,468x60-1,468x60-2,336x280,flex,336x280-2,120x60-1,120x60-2,120x60-3,125x125-1,125x125-2,125x800,accessunit,accessunit_one,accessunit_two,accessunit_three,ciu,cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10,cp11,cp12,cp13,cp14,fl1,fl2,fl3,fl4,fl5,send,morph!cp2" >
	<IMG SRC="http://63.236.18.118/RealMedia/ads/adstream_nx.ads/intm/webdev/www.developer.com/security@house_ribbon,468x60-1,468x60-2,336x280,flex,336x280-2,120x60-1,120x60-2,120x60-3,125x125-1,125x125-2,125x800,accessunit,accessunit_one,accessunit_two,accessunit_three,ciu,cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10,cp11,cp12,cp13,cp14,fl1,fl2,fl3,fl4,fl5,send,morph!cp2" border=0>
	</A>
	</NOSCRIPT>
	<!------ OAS AD 'cp2' end ------>
	<br>
	<!------ OAS AD 'cp3' begin ------>
	<SCRIPT LANGUAGE=JavaScript>
	<!--
	OAS_AD('cp3');
	//-->
	</SCRIPT>
	<NOSCRIPT>
	<A HREF="http://63.236.18.118/RealMedia/ads/click_nx.ads/intm/webdev/www.developer.com/security@house_ribbon,468x60-1,468x60-2,336x280,flex,336x280-2,120x60-1,120x60-2,120x60-3,125x125-1,125x125-2,125x800,accessunit,accessunit_one,accessunit_two,accessunit_three,ciu,cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10,cp11,cp12,cp13,cp14,fl1,fl2,fl3,fl4,fl5,send,morph!cp3" >
	<IMG SRC="http://63.236.18.118/RealMedia/ads/adstream_nx.ads/intm/webdev/www.developer.com/security@house_ribbon,468x60-1,468x60-2,336x280,flex,336x280-2,120x60-1,120x60-2,120x60-3,125x125-1,125x125-2,125x800,accessunit,accessunit_one,accessunit_two,accessunit_three,ciu,cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10,cp11,cp12,cp13,cp14,fl1,fl2,fl3,fl4,fl5,send,morph!cp3" border=0>
	</A>
	</NOSCRIPT>
	<!------ OAS AD 'cp3' end ------>
	<br>
	<!------ OAS AD 'cp4' begin ------>
	<SCRIPT LANGUAGE=JavaScript>
	<!--
	OAS_AD('cp4');
	//-->
	</SCRIPT>
	<NOSCRIPT>
	<A HREF="http://63.236.18.118/RealMedia/ads/click_nx.ads/intm/webdev/www.developer.com/security@house_ribbon,468x60-1,468x60-2,336x280,flex,336x280-2,120x60-1,120x60-2,120x60-3,125x125-1,125x125-2,125x800,accessunit,accessunit_one,accessunit_two,accessunit_three,ciu,cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10,cp11,cp12,cp13,cp14,fl1,fl2,fl3,fl4,fl5,send,morph!cp4" >
	<IMG SRC="http://63.236.18.118/RealMedia/ads/adstream_nx.ads/intm/webdev/www.developer.com/security@house_ribbon,468x60-1,468x60-2,336x280,flex,336x280-2,120x60-1,120x60-2,120x60-3,125x125-1,125x125-2,125x800,accessunit,accessunit_one,accessunit_two,accessunit_three,ciu,cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10,cp11,cp12,cp13,cp14,fl1,fl2,fl3,fl4,fl5,send,morph!cp4" border=0>
	</A>
	</NOSCRIPT>
	<!------ OAS AD 'cp4' end ------>
	<br>
	<!------ OAS AD 'cp5' begin ------>
	<SCRIPT LANGUAGE=JavaScript>
	<!--
	OAS_AD('cp5');
	//-->
	</SCRIPT>
	<NOSCRIPT>
	<A HREF="http://63.236.18.118/RealMedia/ads/click_nx.ads/intm/webdev/www.developer.com/security@house_ribbon,468x60-1,468x60-2,336x280,flex,336x280-2,120x60-1,120x60-2,120x60-3,125x125-1,125x125-2,125x800,accessunit,accessunit_one,accessunit_two,accessunit_three,ciu,cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10,cp11,cp12,cp13,cp14,fl1,fl2,fl3,fl4,fl5,send,morph!cp5" >
	<IMG SRC="http://63.236.18.118/RealMedia/ads/adstream_nx.ads/intm/webdev/www.developer.com/security@house_ribbon,468x60-1,468x60-2,336x280,flex,336x280-2,120x60-1,120x60-2,120x60-3,125x125-1,125x125-2,125x800,accessunit,accessunit_one,accessunit_two,accessunit_three,ciu,cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10,cp11,cp12,cp13,cp14,fl1,fl2,fl3,fl4,fl5,send,morph!cp5" border=0>
	</A>
	</NOSCRIPT>
	<!------ OAS AD 'cp5' end ------>
	<br>
	<!------ OAS AD 'cp6' begin ------>
	<SCRIPT LANGUAGE=JavaScript>
	<!--
	OAS_AD('cp6');
	//-->
	</SCRIPT>
	<NOSCRIPT>
	<A HREF="http://63.236.18.118/RealMedia/ads/click_nx.ads/intm/webdev/www.developer.com/security@house_ribbon,468x60-1,468x60-2,336x280,flex,336x280-2,120x60-1,120x60-2,120x60-3,125x125-1,125x125-2,125x800,accessunit,accessunit_one,accessunit_two,accessunit_three,ciu,cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10,cp11,cp12,cp13,cp14,fl1,fl2,fl3,fl4,fl5,send,morph!cp6" >
	<IMG SRC="http://63.236.18.118/RealMedia/ads/adstream_nx.ads/intm/webdev/www.developer.com/security@house_ribbon,468x60-1,468x60-2,336x280,flex,336x280-2,120x60-1,120x60-2,120x60-3,125x125-1,125x125-2,125x800,accessunit,accessunit_one,accessunit_two,accessunit_three,ciu,cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10,cp11,cp12,cp13,cp14,fl1,fl2,fl3,fl4,fl5,send,morph!cp6" border=0>
	</A>
	</NOSCRIPT>
	<!------ OAS AD 'cp6' end ------>
	<br>
	<!------ OAS AD 'cp7' begin ------>
	<SCRIPT LANGUAGE=JavaScript>
	<!--
	OAS_AD('cp7');
	//-->
	</SCRIPT>
	<NOSCRIPT>
	<A HREF="http://63.236.18.118/RealMedia/ads/click_nx.ads/intm/webdev/www.developer.com/security@house_ribbon,468x60-1,468x60-2,336x280,flex,336x280-2,120x60-1,120x60-2,120x60-3,125x125-1,125x125-2,125x800,accessunit,accessunit_one,accessunit_two,accessunit_three,ciu,cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10,cp11,cp12,cp13,cp14,fl1,fl2,fl3,fl4,fl5,send,morph!cp7" >
	<IMG SRC="http://63.236.18.118/RealMedia/ads/adstream_nx.ads/intm/webdev/www.developer.com/security@house_ribbon,468x60-1,468x60-2,336x280,flex,336x280-2,120x60-1,120x60-2,120x60-3,125x125-1,125x125-2,125x800,accessunit,accessunit_one,accessunit_two,accessunit_three,ciu,cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10,cp11,cp12,cp13,cp14,fl1,fl2,fl3,fl4,fl5,send,morph!cp7" border=0>
	</A>
	</NOSCRIPT>
	<!------ OAS AD 'cp7' end ------>
	<br>
	<!------ OAS AD 'cp8' begin ------>
	<SCRIPT LANGUAGE=JavaScript>
	<!--
	OAS_AD('cp8');
	//-->
	</SCRIPT>
	<NOSCRIPT>
	<A HREF="http://63.236.18.118/RealMedia/ads/click_nx.ads/intm/webdev/www.developer.com/security@house_ribbon,468x60-1,468x60-2,336x280,flex,336x280-2,120x60-1,120x60-2,120x60-3,125x125-1,125x125-2,125x800,accessunit,accessunit_one,accessunit_two,accessunit_three,ciu,cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10,cp11,cp12,cp13,cp14,fl1,fl2,fl3,fl4,fl5,send,morph!cp8" >
	<IMG SRC="http://63.236.18.118/RealMedia/ads/adstream_nx.ads/intm/webdev/www.developer.com/security@house_ribbon,468x60-1,468x60-2,336x280,flex,336x280-2,120x60-1,120x60-2,120x60-3,125x125-1,125x125-2,125x800,accessunit,accessunit_one,accessunit_two,accessunit_three,ciu,cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10,cp11,cp12,cp13,cp14,fl1,fl2,fl3,fl4,fl5,send,morph!cp8" border=0>
	</A>
	</NOSCRIPT>
	<!------ OAS AD 'cp8' end ------>
	<br>
	<!------ OAS AD 'cp9' begin ------>
	<SCRIPT LANGUAGE=JavaScript>
	<!--
	OAS_AD('cp9');
	//-->
	</SCRIPT>
	<NOSCRIPT>
	<A HREF="http://63.236.18.118/RealMedia/ads/click_nx.ads/intm/webdev/www.developer.com/security@house_ribbon,468x60-1,468x60-2,336x280,flex,336x280-2,120x60-1,120x60-2,120x60-3,125x125-1,125x125-2,125x800,accessunit,accessunit_one,accessunit_two,accessunit_three,ciu,cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10,cp11,cp12,cp13,cp14,fl1,fl2,fl3,fl4,fl5,send,morph!cp9" >
	<IMG SRC="http://63.236.18.118/RealMedia/ads/adstream_nx.ads/intm/webdev/www.developer.com/security@house_ribbon,468x60-1,468x60-2,336x280,flex,336x280-2,120x60-1,120x60-2,120x60-3,125x125-1,125x125-2,125x800,accessunit,accessunit_one,accessunit_two,accessunit_three,ciu,cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10,cp11,cp12,cp13,cp14,fl1,fl2,fl3,fl4,fl5,send,morph!cp9" border=0>
	</A>
	</NOSCRIPT>
	<!------ OAS AD 'cp9' end ------>
	<br>
	<!------ OAS AD 'cp10' begin ------>
	<SCRIPT LANGUAGE=JavaScript>
	<!--
	OAS_AD('cp10');
	//-->
	</SCRIPT>
	<NOSCRIPT>
	<A HREF="http://63.236.18.118/RealMedia/ads/click_nx.ads/intm/webdev/www.developer.com/security@house_ribbon,468x60-1,468x60-2,336x280,flex,336x280-2,120x60-1,120x60-2,120x60-3,125x125-1,125x125-2,125x800,accessunit,accessunit_one,accessunit_two,accessunit_three,ciu,cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10,cp11,cp12,cp13,cp14,fl1,fl2,fl3,fl4,fl5,send,morph!cp10" >
	<IMG SRC="http://63.236.18.118/RealMedia/ads/adstream_nx.ads/intm/webdev/www.developer.com/security@house_ribbon,468x60-1,468x60-2,336x280,flex,336x280-2,120x60-1,120x60-2,120x60-3,125x125-1,125x125-2,125x800,accessunit,accessunit_one,accessunit_two,accessunit_three,ciu,cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10,cp11,cp12,cp13,cp14,fl1,fl2,fl3,fl4,fl5,send,morph!cp10" border=0>
	</A>
	</NOSCRIPT>
	<!------ OAS AD 'cp10' end ------>
	<br>
	<!------ OAS AD 'cp11' begin ------>
	<SCRIPT LANGUAGE=JavaScript>
	<!--
	OAS_AD('cp11');
	//-->
	</SCRIPT>
	<NOSCRIPT>
	<A HREF="http://63.236.18.118/RealMedia/ads/click_nx.ads/intm/webdev/www.developer.com/security@house_ribbon,468x60-1,468x60-2,336x280,flex,336x280-2,120x60-1,120x60-2,120x60-3,125x125-1,125x125-2,125x800,accessunit,accessunit_one,accessunit_two,accessunit_three,ciu,cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10,cp11,cp12,cp13,cp14,fl1,fl2,fl3,fl4,fl5,send,morph!cp11" >
	<IMG SRC="http://63.236.18.118/RealMedia/ads/adstream_nx.ads/intm/webdev/www.developer.com/security@house_ribbon,468x60-1,468x60-2,336x280,flex,336x280-2,120x60-1,120x60-2,120x60-3,125x125-1,125x125-2,125x800,accessunit,accessunit_one,accessunit_two,accessunit_three,ciu,cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10,cp11,cp12,cp13,cp14,fl1,fl2,fl3,fl4,fl5,send,morph!cp11" border=0>
	</A>
	</NOSCRIPT>
	<!------ OAS AD 'cp11' end ------>
	<br>
	<!------ OAS AD 'cp12' begin ------>
	<SCRIPT LANGUAGE=JavaScript>
	<!--
	OAS_AD('cp12');
	//-->
	</SCRIPT>
	<NOSCRIPT>
	<A HREF="http://63.236.18.118/RealMedia/ads/click_nx.ads/intm/webdev/www.developer.com/security@house_ribbon,468x60-1,468x60-2,336x280,flex,336x280-2,120x60-1,120x60-2,120x60-3,125x125-1,125x125-2,125x800,accessunit,accessunit_one,accessunit_two,accessunit_three,ciu,cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10,cp11,cp12,cp13,cp14,fl1,fl2,fl3,fl4,fl5,send,morph!cp12" >
	<IMG SRC="http://63.236.18.118/RealMedia/ads/adstream_nx.ads/intm/webdev/www.developer.com/security@house_ribbon,468x60-1,468x60-2,336x280,flex,336x280-2,120x60-1,120x60-2,120x60-3,125x125-1,125x125-2,125x800,accessunit,accessunit_one,accessunit_two,accessunit_three,ciu,cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10,cp11,cp12,cp13,cp14,fl1,fl2,fl3,fl4,fl5,send,morph!cp12" border=0>
	</A>
	</NOSCRIPT>
	<!------ OAS AD 'cp12' end ------>
	<br>
	<!------ OAS AD 'cp13' begin ------>
	<SCRIPT LANGUAGE=JavaScript>
	<!--
	OAS_AD('cp13');
	//-->
	</SCRIPT>
	<NOSCRIPT>
	<A HREF="http://63.236.18.118/RealMedia/ads/click_nx.ads/intm/webdev/www.developer.com/security@house_ribbon,468x60-1,468x60-2,336x280,flex,336x280-2,120x60-1,120x60-2,120x60-3,125x125-1,125x125-2,125x800,accessunit,accessunit_one,accessunit_two,accessunit_three,ciu,cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10,cp11,cp12,cp13,cp14,fl1,fl2,fl3,fl4,fl5,send,morph!cp13" >
	<IMG SRC="http://63.236.18.118/RealMedia/ads/adstream_nx.ads/intm/webdev/www.developer.com/security@house_ribbon,468x60-1,468x60-2,336x280,flex,336x280-2,120x60-1,120x60-2,120x60-3,125x125-1,125x125-2,125x800,accessunit,accessunit_one,accessunit_two,accessunit_three,ciu,cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10,cp11,cp12,cp13,cp14,fl1,fl2,fl3,fl4,fl5,send,morph!cp13" border=0>
	</A>
	</NOSCRIPT>
	<!------ OAS AD 'cp13' end ------>
	<br>
	<!------ OAS AD 'cp14' begin ------>
	<SCRIPT LANGUAGE=JavaScript>
	<!--
	OAS_AD('cp14');
	//-->
	</SCRIPT>
	<NOSCRIPT>
	<A HREF="http://63.236.18.118/RealMedia/ads/click_nx.ads/intm/webdev/www.developer.com/security@house_ribbon,468x60-1,468x60-2,336x280,flex,336x280-2,120x60-1,120x60-2,120x60-3,125x125-1,125x125-2,125x800,accessunit,accessunit_one,accessunit_two,accessunit_three,ciu,cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10,cp11,cp12,cp13,cp14,fl1,fl2,fl3,fl4,fl5,send,morph!cp14" >
	<IMG SRC="http://63.236.18.118/RealMedia/ads/adstream_nx.ads/intm/webdev/www.developer.com/security@house_ribbon,468x60-1,468x60-2,336x280,flex,336x280-2,120x60-1,120x60-2,120x60-3,125x125-1,125x125-2,125x800,accessunit,accessunit_one,accessunit_two,accessunit_three,ciu,cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10,cp11,cp12,cp13,cp14,fl1,fl2,fl3,fl4,fl5,send,morph!cp14" border=0>
	</A>
	</NOSCRIPT>
	<!------ OAS AD 'cp14' end ------>
	<br><!-- "CP" end -->
					</ul>
				</div>
			</div>
		</div>
		<div class="colRight">
			<div id="moreITs" class="section">
				<div class="sectionHeader">
					<h3>More for Developers</h3>
				</div>
				<div class="sectionContent">
					<ul class="noBullets">
						<li><a href="/sitemap/">Site Map</a></li>
						<li><a href="/feedback/">Contact Us</a></li>
						<li><a href="http://www.codeguru.com/">CodeGuru</a></li>
						<li><a href="/java/">Gamelan</a></li>
						<li><a href="http://www.jars.com/">Jars</a></li>
						<li><a href="http://www.codeguru.com/forum/">Discussions</a></li>
						<li><a href="http://www.vbforums.com/">VBforums</a></li>
						<li><a href="http://www.devx.com/">DevX</a></li>
						<li><a href="http://www.databasejournal.com/">DatabaseJournal</a></li>
					</ul>
				</div>
				<div class="vspace"></div>
				<div class="adsBox ads_150x125">
<!-- "125x125-1" begin -->

<!------ OAS AD '125x125-1' begin ------>
<SCRIPT LANGUAGE=JavaScript>
<!--
OAS_AD('125x125-1');
//-->
</SCRIPT>
<NOSCRIPT>
<A HREF="http://63.236.18.118/RealMedia/ads/click_nx.ads/intm/webdev/www.developer.com/security@house_ribbon,468x60-1,468x60-2,336x280,flex,336x280-2,120x60-1,120x60-2,120x60-3,125x125-1,125x125-2,125x800,accessunit,accessunit_one,accessunit_two,accessunit_three,ciu,cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10,cp11,cp12,cp13,cp14,fl1,fl2,fl3,fl4,fl5,send,morph!125x125-1" >
<IMG SRC="http://63.236.18.118/RealMedia/ads/adstream_nx.ads/intm/webdev/www.developer.com/security@house_ribbon,468x60-1,468x60-2,336x280,flex,336x280-2,120x60-1,120x60-2,120x60-3,125x125-1,125x125-2,125x800,accessunit,accessunit_one,accessunit_two,accessunit_three,ciu,cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10,cp11,cp12,cp13,cp14,fl1,fl2,fl3,fl4,fl5,send,morph!125x125-1" border=0>
</A>
</NOSCRIPT>
<!------ OAS AD '125x125-1' end ------><!-- "125x125-1" end -->

				</div>
			</div>
		</div>
	</div>
	
	<div class="vspace"></div>
	
	<div id="ontheForums" class="section">
		<div class="sectionHeader">
			<h2>On the Forums</h2>
			<a href="http://www.codeguru.com/forum/" class="more">Visit the Forums &raquo;</a>
		</div>
		<div class="sectionContent">
			<div class="tabs">
				<div class="tabsMenu clearfix">
					<ul>
						<li><a href="#ontheForumsLatest" class="selected">Latest</a></li>
						<li><a href="#ontheForumsMostViews">Most Views</a></li>
						<li><a href="#ontheForumsMostReplies">Most Replies</a></li>
					</ul>
				</div>
				<div class="tabsContents">
					<div class="tabsContent selected" id="ontheForumsLatest">
						<ul>
<ul>
<li> <a href="http://www.codeguru.com/forum/showthread.php?threadid=492046"><span class="graytext">1</span> stuck at AI program frame</a></li>
<li> <a href="http://www.codeguru.com/forum/showthread.php?threadid=492002"><span class="graytext">2</span> Dll Name Mangling - when would I use it?</a></li>
<li> <a href="http://www.codeguru.com/forum/showthread.php?threadid=492015"><span class="graytext">3</span> 3 Tier Architecture in ASP.net 2.0</a></li>
<li> <a href="http://www.codeguru.com/forum/showthread.php?threadid=492055"><span class="graytext">4</span> Hiding form, no longer compares webcam previews</a></li>
<li> <a href="http://www.codeguru.com/forum/showthread.php?threadid=492129"><span class="graytext">5</span> problem with null value reading an ArrayList</a></li>
</ul>

						</ul>
					</div>
					<div class="tabsContent" id="ontheForumsMostViews">
						<ul>
<ul>
<li> <a href="http://www.codeguru.com/forum/showthread.php?threadid=194400"><span class="graytext">1</span> Distance between point and line segment</a></li>
<li> <a href="http://www.codeguru.com/forum/showthread.php?threadid=384364"><span class="graytext">2</span> How to use Widcomm bluetooth driver in my application?</a></li>
<li> <a href="http://www.codeguru.com/forum/showthread.php?threadid=320297"><span class="graytext">3</span> CFileDialog crash in Platform SDK</a></li>
<li> <a href="http://www.codeguru.com/forum/showthread.php?threadid=262871"><span class="graytext">4</span> How to Marshal AccessibleObjectFromWindow</a></li>
<li> <a href="http://www.codeguru.com/forum/showthread.php?threadid=475538"><span class="graytext">5</span> Internet Explorer cannot display the webpage</a></li>
</ul>

						</ul>
					</div>
					<div class="tabsContent" id="ontheForumsMostReplies">
						<ul>
<ul>
<li> <a href="http://www.codeguru.com/forum/showthread.php?threadid=491396"><span class="graytext">1</span> Display highlighted data from Listbox in Textboxes</a></li>
<li> <a href="http://www.codeguru.com/forum/showthread.php?threadid=320297"><span class="graytext">2</span> CFileDialog crash in Platform SDK</a></li>
<li> <a href="http://www.codeguru.com/forum/showthread.php?threadid=384364"><span class="graytext">3</span> How to use Widcomm bluetooth driver in my application?</a></li>
<li> <a href="http://www.codeguru.com/forum/showthread.php?threadid=491985"><span class="graytext">4</span> [RESOLVED] Custom data binding, how should I implement it?</a></li>
<li> <a href="http://www.codeguru.com/forum/showthread.php?threadid=491710"><span class="graytext">5</span> ATL/MFC Multithreading/GFX problem</a></li>
</ul>

						</ul>
					</div>
				</div>
			</div>
		</div>
	</div>
	
<!-- START: MARCHEX -->
<script type="text/javascript" src="http://jlinks.industrybrains.com/jsct?sid=829&amp;ct=INTERNETCOM_DEVELOPER&amp;tr=DEVELOPER&amp;num=5&amp;layt=7&amp;fmt=simp"></script>
<!-- END: MARCHEX -->
	
	

<div class="clearfix ebooksmore">
  <div id="partners" class="section">
    <div class="sectionHeader">
		<h3>Key IT Solutions</h3>
    </div>
    <div class="sectionContent">
      <ul class="noBullets">
					<li><a href="http://www.devx.com/hotlist-Adobe/link/42710">Developer Connection: Free Online Flex Training</a></li>
					<li><a href="http://www.devx.com/BlackBerry/Door/43805">BlackBerry Application Development Resources</a></li>
					<li><a href="http://www.internet.com/Microsoft/Everybodys_Business/Link/41333">SharePoint Development and Programming Forum</a></li>
					<li><a href="http://www.devx.com/VS_2010/Door/43217">Microsoft Visual Studio 2010 Showcase</a></li>
					<li><a href="http://www.devx.com/MSDN/Door/40684">MSDN Spotlight</a></li>
					<li><a href="http://www.devx.com/MS_PHP/Door/42951">PHP for Windows Showcase</a></li>
		      </ul>
    </div>
  </div>
</div>
	
<style type="text/css">
.dmcontent_container
{
	text-align: center;
	background-color: #ffffff;
	width: 125px;
	height: 250px;
	border-top: 2px solid; border-color: #0021b5;
}
.dmcontent_title
{
	text-align: left;
	height: 20px;
	line-height: 20px;
	font-family: Verdana, Arial, Helvetica, sans-serif;
	font-size: 12px;
	font-weight: bolder;
	width: 125px;
	color: #000000;
	background-color: #ffffff;
}
.dmcontent_body
{
	overflow-y: auto;
	text-align: left;
	font-family: Verdana, Arial, Helvetica, sans-serif;
	line-height: 14px;
	font-size: 10px;
	margin-left: auto;
	margin-right: auto;
	width: 123px;
	height: 219px;
	color: #336699;
	background-color: #FFFFFF;
	border: 1px solid; border-color: #dddddd;
}
.dmcontent_link
{
	text-decoration: none;
	color:#000000;
}
</style>
<div class="dmcontent_container">
<div class="dmcontent_title">Local Guides</div>
<div class="dmcontent_body">
&nbsp;><a href="http://local.developer.com/Architecture_Design-s1176.html" title="Architecture & Design" class="dmcontent_link">Architecture & Design</a><br />
&nbsp;><a href="http://local.developer.com/Database-s1177.html" title="Database" class="dmcontent_link">Database</a><br />
&nbsp;><a href="http://local.developer.com/Java-s1178.html" title="Java" class="dmcontent_link">Java</a><br />
&nbsp;><a href="http://local.developer.com/Languages_Tools-s1179.html" title="Languages & Tools" class="dmcontent_link">Languages & Tools</a><br />
&nbsp;><a href="http://local.developer.com/Microsoft_NET-s1180.html" title="Microsoft & .NET" class="dmcontent_link">Microsoft & .NET</a><br />
&nbsp;><a href="http://local.developer.com/Open_Source-s1181.html" title="Open Source" class="dmcontent_link">Open Source</a><br />
&nbsp;><a href="http://local.developer.com/Project_Management-s1182.html" title="Project Management" class="dmcontent_link">Project Management</a><br />
&nbsp;><a href="http://local.developer.com/Security-s1183.html" title="Security" class="dmcontent_link">Security</a><br />
&nbsp;><a href="http://local.developer.com/Techniques-s1184.html" title="Techniques" class="dmcontent_link">Techniques</a><br />
&nbsp;><a href="http://local.developer.com/Wireless-s1186.html" title="Wireless" class="dmcontent_link">Wireless</a><br />
</div>
</div>

</div>
		<div class="vspace clear"></div>
		<div class="vspace clear"></div>
		
<FONT SIZE="-1" FACE="arial, helvetica">

<!-- Google Analytics -->
<script src="/icom_includes/footers/scripts/ga.js"  type="text/javascript">
</script>
<script  type="text/javascript" >
<!--     hide from no js browsers
delete Array.prototype.itemValidation;
delete Array.prototype.isArray;
var superTracker = _gat._getTracker("UA-2838492-1");
superTracker._initData();
superTracker._trackPageview();

-->
</script>
<script  type="text/javascript" >
   var site_name =  location.hostname;
   if ( site_name.indexOf("www.") != 0 ) {
     site_name  = "www."+site_name ;
   }
   document.write("<SCR" + "IPT LANGUAGE='JavaScript1.2' SRC='/icom_includes/footers/sites/"+ site_name +".js' TYPE='text/javascript'><\/SCR" + "IPT>");
-->
</script>
<script  type="text/javascript" >
<!--     hide from no js browsers
   pageTracker._initData();
   pageTracker._trackPageview();
   // -->
</script>
<!-- End Google Analytics -->


<!-- Revenue Science API -->
<script src="http://js.revsci.net/gateway/gw.js?csid=K08784"></script>
<script>
  DM_addEncToLoc("pid","INT");
  DM_tag();

</script>
<!-- Revenue Science API -->




<style type="text/css">
@charset "UTF-8";
/* CSS Document */


/* JOM CSS */

#jomfooter {
	border: 0;
	margin: 5px;
	padding: 5px;
	}

#jomfooter * {
	font-family: Arial, Helvetica, sans-serif;
	padding: 0;
	margin: 0;
	}

#jomfooter img {
	border: 0;
	behavior: url('/icom_includes/footers/css/iepngfix.htc');
	padding: 5px;
	padding: expression('0');
	}

#jomfooter p {
	font-size: 11px;
	line-height: 20px;
	margin: 10px;
	}

#jomfooter form b {
	font-size: 12px;
	}

#jomfooter a {
	text-decoration: underline;
	}

#jomfooter a:hover {
	text-decoration: none;
	}

#jomfooter table td {
	border: 0;
	}


/* GEMS Solutions CSS */

#jomfooter #solsect {
	margin: 0 auto;
	padding: 10px 0;
	width: 720px;
	}

#jomfooter #solsect .top {
	background: url('/icom_includes/footers/soltopbg.gif') repeat-x #bbb;
	height: 26px;
	margin-bottom: 1px;
	}

#jomfooter #solsect .top a {
	font-size: 16px;
	font-weight: bold;
	color:#333;
	text-decoration:none;
	margin-left: 5px;
	padding: 0;
	line-height: 25px;
	}

#jomfooter #solsect .top a:hover {
	text-decoration: none;
	}

#jomfooter #solsect .solsectpad {
	background: #fff;
	}

#jomfooter #solsect .solsectpad .main {
	background:url('/icom_includes/footers/solmidbg.gif') repeat-x #e7e8e3;
	padding: 5px;
	margin-bottom: 1px;
	}

#jomfooter #solsect .solsectpad .main h2 {
	font-size: 12px;
	color: #000;
	font-weight: normal;
	padding-bottom: 3px;
	}

#jomfooter #solsect a {
	color: #333;
	font-size: 10px;
	text-decoration: none;
	line-height: 13px;
	}

#jomfooter #solsect a:hover {
	text-decoration: underline;
	}
</style>



<!-- Begin JOM Footer -->


<div id="jomfooter" align="center">
<p>
    <a href="http://www.internet.com/"><img src="http://www.internet.com/icom_includes/footers/img/icom_logo_qsfooter.png" width="240" height="40" hspace="0" /></a>

    <br>
    The Network for Technology Professionals</p>
<form method="POST" action="http://search.internet.com/www.jupiterweb.com" target="_top">        
        <input type="HIDDEN" name="IC_Summary" value="1">
        <input type="HIDDEN" name="IC_StartNumber" value="0">
        <input type="HIDDEN" name="IC_BatchSize" value="10">
        <input type="HIDDEN" name="IC_RelevanceThreshold" value="50">
        <input type="hidden" name="IC_QueryDatabase" value="all">
        <b>Search:</b> 
        <input type="text" name="IC_QueryText" size="45">

        <input type="image" border="0" value="Find" name="SUBMIT" src="/icom_includes/footers/but_find.gif" width="41" height="20" align="absmiddle">
  </form>
    <p>
        <a target="_blank" rel="nofollow" href="http://www.internet.com/Internetcom/Door/41188"> About Internet.com</a> 
        <br>
      <script type="text/javascript">
            document.write(' Copyright ');
            var today = new Date();
            document.write(  + today.getFullYear());
            document.write(' QuinStreet Inc. All Rights Reserved.');
        </script>
  <noscript>
        Copyright 2010 QuinStreet Inc. All Rights Reserved.
  </noscript>

  </p>
       <p> <a target="_blank" rel="nofollow" href="http://www.internet.com/Internetcom/Door/41187">Legal Notices</a>, <a target="_blank" rel="nofollow" href="http://www.internet.com/Internetcom/Door/41189#Licensing1">Licensing</a>, <a target="_blank" rel="nofollow" href="http://www.internet.com/Internetcom/Door/41189#Permissions">Permissions</a>, <a target="_blank" rel="nofollow" href="http://www.internet.com/Internetcom/Door/41186">Privacy  Policy</a>.
        <br />

        <a target="_blank" rel="nofollow" href="http://www.internet.com/mediakit/">Advertise</a> | <a target="_blank" rel="nofollow" href="http://e-newsletters.internet.com/">Newsletters</a> |  <a target="_blank" rel="nofollow" href="http://e-newsletters.internet.com/announcement_list.html">E-mail Offers</a>

  </p>


<!-- start solutions links section -->
    <div id="solsect">
        <div class="top" align="left"><a href="#">Solutions</a></div>
        <div class="solsectpad">
                        <div class="main" align="left">
				<h2>Whitepapers and eBooks</h2>
                <table cellpadding="0" cellspacing="0" border="0">
                    <tr>
                        <td width="50%" valign="top" align="left">
                                                        <a target="_blank" href="http://www.internet.com/Microsoft/Everybodys_Business/Door/40965">Microsoft Personalized Whitepapers and Resources for You</a><br>
						   						                              <a target="_blank" href="http://www.devx.com/HotList/HotList-IBM/Article/43201">Articles: Build a More Agile Business with IBM</a><br>
						   						                              <a target="_blank" href="http://www.devx.com/HotList/HotList-IBM/Article/43173">Articles: IBM Offers Enhanced Measurement and Management for Energy Usage</a><br>
						   						                              <a target="_blank" href="http://www.devx.com/HotList/HotList-IBM/Article/43176">Articles: IBM Helps Transformation to an Information-Based Enterprise</a><br>
						                               </td>
                        <td width="10"> </td>
                        <td width="50%" valign="top" align="left">
												                              <a target="_blank" href="http://www.devx.com/VS_2010/Door/43217">Microsoft Articles: Visual Studio 2010</a><br>
						   						                              <a target="_blank" href="http://www.devx.com/HotList/hotlist-Adobe/link/42707">Adobe Article: Java Developers Finding a Home at Adobe Flex</a><br>
						   						                              <a target="_blank" href="http://www.devx.com/solutions">MORE WHITEPAPERS, EBOOKS, AND ARTICLES</a><br>
						   						                          </td>
                    </tr>
                </table>
            </div>
                        <div class="main" align="left">
				<h2>Webcasts</h2>
                <table cellpadding="0" cellspacing="0" border="0">
                    <tr>
                        <td width="50%" valign="top" align="left">
                                                        <a target="_blank" href="http://www.devx.com/MS_PHP/Door/42951">Webcast: Connecting PHP to Microsoft Technologies</a><br>
						   						                              <a target="_blank" href="http://www.internet.com/Microsoft/Everybodys_Business/Link/41264">Microsoft Video: Desktop Optimization</a><br>
						                               </td>
                        <td width="10"> </td>
                        <td width="50%" valign="top" align="left">
												                              <a target="_blank" href="http://www.devx.com/MS_Azure/Door/41806">Video: Windows Azure Debugging Tips</a><br>
						   						                              <a target="_blank" href="http://www.devx.com/solutions">MORE WEBCASTS, PODCASTS, AND VIDEOS</a><br>
						   						                          </td>
                    </tr>
                </table>
            </div>
                        <div class="main" align="left">
				<h2>Downloads and eKits</h2>
                <table cellpadding="0" cellspacing="0" border="0">
                    <tr>
                        <td width="50%" valign="top" align="left">
                                                        <a target="_blank" href="http://www.internet.com/Solutions/Link/41398">HP PartnerONE | SolutionsINFINITE   Visit us at hp.com/partners/us</a><br>
						   						                              <a target="_blank" href="http://www.devx.com/MicrosoftSC/Door/43162">Microsoft Free Trials: Windows Server 2008 R2, Exchange Server 2010 and Windows 7</a><br>
						   						                              <a target="_blank" href="http://www.devx.com/MSDN/Door/40684">Get the Windows 7 SDK</a><br>
						                               </td>
                        <td width="10"> </td>
                        <td width="50%" valign="top" align="left">
												                              <a target="_blank" href="http://www.devx.com/RedGateVS/Door/41829">Free Trial: Red Gate SQL Backup Pro 6</a><br>
						   						                              <a target="_blank" href="http://www.devx.com/HotList/HotList-IronSpeed/Article/40848">Iron Speed Designer Application Generator</a><br>
						   						                              <a target="_blank" href="http://www.devx.com/solutions">MORE DOWNLOADS, EKITS, AND FREE TRIALS</a><br>
						   						                          </td>
                    </tr>
                </table>
            </div>
                        <div class="main" align="left">
				<h2>Tutorials and Demos</h2>
                <table cellpadding="0" cellspacing="0" border="0">
                    <tr>
                        <td width="50%" valign="top" align="left">
                                                        <a target="_blank" href="http://www.internet.com/Microsoft/Everybodys_Business/Door/40967">Learn Unified Communications</a><br>
						   						                              <a target="_blank" href="http://www.devx.com/BlackBerry/Door/43805">BlackBerry Application Development Resources</a><br>
						   						                              <a target="_blank" href="http://www.internet.com/Microsoft/Everybodys_Business/Door/40968">Learn SQL Server 2008</a><br>
						   						                              <a target="_blank" href="http://www.internet.com/Microsoft/Everybodys_Business/Door/40966">Learn Windows Server 2008 R2</a><br>
						   						                              <a target="_blank" href="http://www.devx.com/HotList/Link/40644">Internet.com Hot List: Get the Inside Scoop on IT and Developer Products</a><br>
						                               </td>
                        <td width="10"> </td>
                        <td width="50%" valign="top" align="left">
												                              <a target="_blank" href="http://www.internet.com/Microsoft/Everybodys_Business/Door/40970">Learn Forefront</a><br>
						   						                              <a target="_blank" href="http://www.internet.com/Microsoft/Everybodys_Business/Door/40969">Learn System Center</a><br>
						   						                              <a target="_blank" href="http://www.devx.com/ebook/Article/39031">All About Botnets</a><br>
						   						                              <a target="_blank" href="http://www.internet.com/Microsoft/Everybodys_Business/Door/40971">Learn SharePoint</a><br>
						   						                              <a target="_blank" href="http://www.devx.com/solutions">MORE TUTORIALS, DEMOS AND STEP-BY-STEP GUIDES</a><br>
						   						                          </td>
                    </tr>
                </table>
            </div>
                    </div>
    </div>
</div>

<!-- End JOM Footer -->
</FONT>

		
	</div>
</div> 
</div>
</body>
</html>   

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
"http://www.w3.org/TR/REC-html4/loose.dtd">

 


	

<html lang="en">
<head>
<title>accesselearning 
Module 10: Scripts/Java Double-Buffering</title>

<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta name="author" content="Marsha Allen">
<meta name="copyright" content="Copyright &copy; 2003 Georgia Institute of Technology Research Corporation. All rights reserved.">
<meta name="keywords" content=", assistive technology, disability, disabilities, handicapped, environmental access, wheelchair, CATEA, The Center for Assistive Technology and Environmental Access, Georgia Tech, Georgia Institute of Technology, research, non-profit, rehabilitation technology, Jon Sanford, College of Architecture, accesselearning, access e learning, GRADE, tutorial, Distance Education, instructional techniques">
<meta name="generator" content="Emacs. It's free, and it works.">
<link rel="stylesheet" href="http://www.accesselearning.net/images/aeltableless.css" type="text/css">
</head>

<body><!-- HIDDEN SKIP NAV, SITE LOGO AND BUTTONS -->
<div class="invisitext"><a href="#content" target="_self" accesskey="k" title="Skip to Content (ctrl/alt + k)" class="invisilink">Skip to Page Content</a> 
    | <a href='#lnav' target='_self' accesskey='g' title='Navigation (ctrl/alt + g)' class='invisilink'>Navigation for Module</a></div>
<div id="banner"><a href="http://www.catea.org"><img src="http://www.accesselearning.net/images/accesselearning_banner_cate.gif" alt="catea"></a><a href="http://www.accesselearning.net"><img src="http://www.accesselearning.net/images/accesselearning_banner_logo.gif" alt="access e learning"></a></div>


<!-- /HIDDEN SKIP NAV, SITE LOGO AND BUTTONS -->




	
		  
     <div id="toolbar">
		
	<form action="" name="pageGoto" id="pageGoto" class="modulesdropdown">
		<label for="pageList" class="leftmainlink">Go to Module:</label>
		<select id="pageList"><option selected="selected" value="http://www.accesselearning.net/coursemap.php">- Select Module -</option>
					<option value="http://www.accesselearning.net/mod1/1_01.php">1 -- Disabilities</option>
					<option value="http://www.accesselearning.net/mod2/2_01.php">2 -- Access Plan</option>
					<option value="http://www.accesselearning.net/mod3/3_01.php">3 -- Powerpoint</option>
					<option value="http://www.accesselearning.net/mod4/4_01.php">4 -- Video</option>
					<option value="http://www.accesselearning.net/mod5/5_01.php">5 -- Flash</option>
					<option value="http://www.accesselearning.net/mod6/6_01.php">6 -- Word</option>
					<option value="http://www.accesselearning.net/mod7/7_01.php">7 -- Excel</option>
					<option value="http://www.accesselearning.net/mod8/8_01.php">8 -- PDF</option>
					<option value="http://www.accesselearning.net/mod9/9_01.php">9 -- HTML</option>
					<option value="http://www.accesselearning.net/mod10/10_01.php">10 -- Scripts/Java</option>
				</select>
		<input type="button" value="Go!" onClick="self.location=document.pageGoto.pageList.options[document.pageGoto.pageList.selectedIndex].value;" onKeyPress="self.location=document.pageGoto.pageList.options[document.pageGoto.pageList.selectedIndex].value;">
	</form>
	
	 			<div id="rightBar">
				<ul class="Rprint">
					<li><a href="http://www.catea.org/grade/" target="_self">GRADE Project</a></li>
					<li><a href="http://www.accesselearning.net/coursemap.php" target="_self"accesskey="m">Site Map</a></li>
										<li><a href="http://www.accesselearning.net/mod10/10_18.php?vprint=y" target="_self" >Printer Friendly Version</a></li>
									</ul> 
			</div>
		  </div><br><br>
<div id="leftnavbox">
	<span class="leftmodabbr"><a name="lnav"></a><img src="http://www.accesselearning.net/images/10_30blue.gif" height="25" width="25" alt="Navigation for Module 10:" border="0"> Scripts/Java</span><br><span class="leftpageof">Page 17 of 19</span>
	<br><br>
	<ol class="leftnav">
						<li class="leftmainlink"><img src="http://www.accesselearning.net/images/blank_img.gif" alt="*" height="9" width="13"><a href="http://www.accesselearning.net/mod10/10_01.php" target="_self">Introduction</a>
			</li>					<li class="leftmainlink"><img src="http://www.accesselearning.net/images/blank_img.gif" alt="*" height="9" width="13"><a href="http://www.accesselearning.net/mod10/10_21.php" target="_self">Files You Need</a>
			</li>					<li class="leftmainlink"><img src="http://www.accesselearning.net/images/blank_img.gif" alt="*" height="9" width="13"><a href="http://www.accesselearning.net/mod10/10_04.php" target="_self">Scripts</a>
			</li>					<li class="leftmainlink"><img src="http://www.accesselearning.net/images/blank_img.gif" alt="*" height="9" width="13"><a href="http://www.accesselearning.net/mod10/10_07.php" target="_self">Doc. Object Model</a>
			</li>					<li class="leftmainlink"><img src="http://www.accesselearning.net/images/blank_img.gif" alt="*" height="9" width="13"><a href="http://www.accesselearning.net/mod10/10_08.php" target="_self">Pop-ups</a>
			</li>					<li class="leftmainlink"><img src="http://www.accesselearning.net/images/blank_img.gif" alt="*" height="9" width="13"><a href="http://www.accesselearning.net/mod10/10_09.php" target="_self">Forms & Navigation</a>
			</li>					<li class="leftmainlink"><img src="http://www.accesselearning.net/images/blank_img.gif" alt="*" height="9" width="13"><a href="http://www.accesselearning.net/mod10/10_10.php" target="_self">Testing Scripts</a>
			</li>					<li class="leftmainlink"><img src="http://www.accesselearning.net/images/blank_img.gif" alt="*" height="9" width="13"><a href="http://www.accesselearning.net/mod10/10_11.php" target="_self">Applets  & Java</a>
			</li>					<li class="leftmainlink"><img src="http://www.accesselearning.net/images/blank_img.gif" alt="*" height="9" width="13"><a href="http://www.accesselearning.net/mod10/10_13.php" target="_self">Java Accessibility API</a>
			</li>					<li class="leftmainlink"><img src="http://www.accesselearning.net/images/blank_img.gif" alt="*" height="9" width="13"><a href="http://www.accesselearning.net/mod10/10_12.php" target="_self">Java Applications</a>
			<ol class='leftsubnav' type='a'> <li class="leftsublink"><a href="http://www.accesselearning.net/mod10/10_14.php" target="_self">ToolTips </a></li> <li class="leftsublink"><a href="http://www.accesselearning.net/mod10/10_15.php" target="_self">Mnemonics & Accelerators</a></li> <li class="leftsublink"><a href="http://www.accesselearning.net/mod10/10_16.php" target="_self">Image Icons </a></li> <li class="leftsublink"><a href="http://www.accesselearning.net/mod10/10_17.php" target="_self">Labels & Tables </a></li>								<li class="leftsubitem"><img src="http://www.accesselearning.net/images/newrightblue.gif" alt="*" height="9" width="9"> Double-Buffering</li>
					  </ol></li>					<li class="leftmainlink"><img src="http://www.accesselearning.net/images/blank_img.gif" alt="*" height="9" width="13"><a href="http://www.accesselearning.net/mod10/10_19.php" target="_self">Testing Java</a>
			</li>					<li class="leftmainlink"><img src="http://www.accesselearning.net/images/blank_img.gif" alt="*" height="9" width="13"><a href="http://www.accesselearning.net/mod10/10_20.php" target="_self">Resources</a>
			</li>	</ol>
</div>


<div id="contentarea"><a name="content"></a>
<h1>Double-Buffering in Java</h1>
<p>When creating animated applets, it is important to double-buffer 
  your animation to avoid flicker. Flicker can trigger seizures in certain individuals, 
  and is caused because the human eye is fast enough to see the screen being drawn. 
  <A href="applets/flicker.html">If you are not prone to seizures, an example of an applet 
  with bad flicker</a> is provided. By double-buffering the animation, you can see that an 
  <A href="applets/nonFlicker.html">applet with eliminated flicker</a> appears 
  to run much smoother. </p>
<p>There are several techniques for double-buffering, with the 
  easiest already being built into Java. JApplets, by default, double-buffer, 
  so extending it solves your problem (you should still avoid any blinking images 
  in your Applet). </p>
<p>If, for some reason, you do not have the option of working 
  with Swing components, you can still manually double-buffer. The algorithm behind 
  double-buffering is:</p>
<ul>
  <li>To have a secondary image that the user never sees, and do all of your "slow" 
    drawing on it. </li>
  <li>Once your off-screen image is ready to be shown, you use the <code>drawImage( 
    ) </code>method to display that image. </li>
  <li>While the user is viewing that 'frame' of the animation, the applet can 
    begin drawing the next frame on the non-visible off-screen image again. </li>
</ul>
<p>You may be thinking that this would produce the same flickering example, but 
  drawing an image is much quicker than drawing all of the individual lines, arcs, 
  and whatever else. </p>
<p>The real nemesis here is the <code>public void update ( )</code> method.  This is an inherited method that clears the screen by filling a huge rectangle
the same color as the background color, and then call paint.</p>
<div class="notebox"><span class="notetext">Note:</span> Update is almost always indirectly called before paint.</div>
<h3>Code example approximating the inherited update method.</h3>
<code>
public void update (Graphics h) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Color c = this.getBackground();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;h.setColor(c);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;h.fillRect(0, 0, widthOfApplet, heightOfApplet);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c = this.getForeground();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;h.setColor(c);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;paint (h);<br>
}<br>
</code>	
<p>Most of the flicker is caused by this clearing of the screen, so we can simply override (redefine) the method as follows:</p>
<code>
public void update (Graphics h) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;paint (h);<br>
}<br></code>

<p>Realize now that it is necessary to 'clear the screen' in a similar fashion when drawing on the
off-screen image. </p>
<h3>Code example of the double-buffered version of a bouncing ball. </h3>
<code>
  import java.awt.*;<br>
    &nbsp;<br>
    // A simple Ball class<br>
    class Ball {<br>
    &nbsp;&nbsp;&nbsp;double x, y, xVel, yVel, width, height;<br>
    &nbsp;&nbsp;&nbsp;final static double GRAVITY = 0.1;<br>
    &nbsp;&nbsp;&nbsp;final static int BALL_SIZE = 160;<br>
    &nbsp;<br>
    &nbsp;&nbsp;&nbsp;Ball(int x, int y, int width, int height) {<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.width = width; this.height = height;<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.x = x; this.y = y;<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xVel = 0.7; yVel = 0.5;<br>
    &nbsp;&nbsp;&nbsp;}<br>
    &nbsp;&nbsp;&nbsp;public void updateBall() {<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ((x &gt;= width-BALL_SIZE) || (x &lt;= 
    0)) { xVel = -xVel; }<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ((y &gt;= height-BALL_SIZE) || (y &lt;= 
    0)) { yVel = -yVel; }<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x += xVel;<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yVel += Ball.GRAVITY;<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y += yVel;<br>
    &nbsp;&nbsp;&nbsp;}<br>
    }<br>
    &nbsp;<br>
    public class BufferedBall extends java.applet.Applet implements Runnable {<br>
    &nbsp;&nbsp;&nbsp;Thread t;<br>
    &nbsp;&nbsp;&nbsp;Ball ball;<br>
    &nbsp;&nbsp;&nbsp;int width, height;<br>
    &nbsp;&nbsp;&nbsp;// Here is the offscreen image, and the related Graphics 
    object<br>
    &nbsp;&nbsp;&nbsp;Image image;<br>
    &nbsp;&nbsp;&nbsp;Graphics offscreen;<br>
    &nbsp;<br>
    &nbsp;&nbsp;&nbsp;public void init() {<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;width = Integer.parseInt(getParameter 
    (&quot;width&quot;));<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;height = Integer.parseInt(getParameter 
    (&quot;height&quot;));<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ball = new Ball (100, 50, width, height);<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// Bring the offscreen image to life<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;image = this.createImage (width, height);<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// Pull the Graphics object from it, so 
    we can draw later<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;offscreen = image.getGraphics ();<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.setBackground (Color.white);<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t = new Thread (this);<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t.start();<br>
    &nbsp;&nbsp;&nbsp;}<br>
    &nbsp;&nbsp;&nbsp;// Override update so it *does not* clear the screen<br>
    &nbsp;&nbsp;&nbsp;public void update (Graphics h) {<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;paint (h);<br>
    &nbsp;&nbsp;&nbsp;}<br>
    &nbsp;&nbsp;&nbsp;// In paint, we draw on the screen image first<br>
    &nbsp;&nbsp;&nbsp;public void paint (Graphics g) {<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;offscreen.setColor (Color.black);<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;offscreen.fillRect(0,0,width,height);<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;offscreen.setColor (Color.white);<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;offscreen.fillOval ((int)ball.x, 
    (int)ball.y, ball.BALL_SIZE, ball.BALL_SIZE);<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// Now that image is 
    ready to go, we can paint it using drawImage<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g.drawImage (image, 
    0, 0, width, height, this);<br>
    &nbsp;&nbsp;&nbsp;}<br>
    &nbsp;&nbsp;&nbsp;public void run() {<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while (true) {<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try {<br>
    &nbsp;<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ball.updateBall();<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;repaint();<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Thread.sleep(35);<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} catch (InterruptedException 
    e) { }<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
    &nbsp;&nbsp;&nbsp;}<br>
    }<br>
  </code>
  <P class="nextpage">The next page will discuss testing Java.</p>



<!-- PAGE NAVIGATION -->
 
		<table summary="Page navigation: previous page, top of page, next page." border="0" cellpadding="0" width="90%">
		<tr>
		<td width="30%">
		<div>
						<a href="../mod10/10_17.php#content" target="_self" accesskey="b" title="Previous Page - Module 10: Labels and Tables in Java" class="pageoflink"><img src="http://www.accesselearning.net/images/arrowLeft.gif" alt="left arrow" border="0" class="txtTop">Previous Page<br>
							Page 16:<br><span class="pageoftitle">Labels & Tables </span></a>
		  
		</div>
		</td>
		
<!-- One error is in this block. Between here: -->
		<td width="30%" class="calign"><div><a href="#content" target="_self" title="Top of Page">Top of Page <img src="http://www.accesselearning.net/images/arrowTop.gif" border="0" alt="arrow up" class="txttop"></a><br>&nbsp;<span class="pageoftext">&nbsp; &nbsp; &nbsp;  Page 17</span></div></td>		
<!-- And Here. No, I am not kidding -->

		<td width="30%"><div class="Ralign">
 
				<a href="../mod10/10_19.php#content" target="_self" accesskey="n" title="Next Page - Module 10: Testing Java for Accessibility" class="pageoflink">
						
			Next Page <img src="http://www.accesselearning.net/images/arrowRight.gif" alt="Next" border="0" class="txtTop"><br>
			
			 Page 18:<br><span class="pageoftitle">Testing Java</span></a>
			    </div>
    </td>
    </tr>
	</table>
	<br><br>
	<!-- </td>
</tr> -->
</div> 	 
<div class="footerbar">&nbsp;</div><div id="footer">
      <strong>Georgia Tech Research 
        on Accessible Distance Education</strong> (<a href="http://www.catea.org/grade/index.html" target="_self" title="Georgia Tech Research on Accessible Distance Education">GRADE</a>) 
        <br>
        Center for Assistive Technology and Environmental Access (<a href="http://www.catea.org" target="_self" title="Center for Assistive Technology and Environmental Access">CATEA</a>) 
        <br>
        Georgia Institute of Technology (<a href="http://www.gatech.edu" target="_self" title="Georgia Institute of Technology">GT</a>) 
        <img src="http://www.accesselearning.net/images/bullet.gif" border="0" width="5" height="5" alt=""> 
        College of Architecture (<a href="http://www.coa.gatech.edu" target="_self" title="Georgia Tech College of Architecture">COA</a>) 
        <br>
        Email: <a href="mailto:gradeproject@coa.gatech.edu">gradeproject@coa.gatech.edu</a> <img src="http://www.accesselearning.net/images/bullet.gif" border="0" width="5" height="5" alt=""> Fax: 404-894-9320 <img src="http://www.accesselearning.net/images/bullet.gif" border="0" width="5" height="5" alt=""> 
        Phone: 404-894-4960 (v/tty)
      <br><br>
	            <a href="http://www.accesselearning.net/accessibility.php" target="_self" title="Accessibility and Design Features of Access E-Learning">Accessibility</a> <img src="http://www.accesselearning.net/images/bullet.gif" border="0" width="5" height="5" alt="">
		  
                 <a href="http://www.accesselearning.net/usage.php" target="_self" title="User Agreement">User Agreement</a>		  
        <br>Developed in collaboration with IDET Communication (<a href="http://www.idetcom.com" class="footlink" title="IDET Communication">IDET</a>).<br>
        Funded by the Office of Post Secondary Education (<a href="http://www.ed.gov/offices/OPE/" target="_self" title="U.S. Department of Education, Office of Postsecondary Education" class="footlink">OPE</a>) 
        under Grant #P333A020050. <br>
        &copy;          	<a href="http://www.accesselearning.net/copyright.php" target="_self" title="Copyright Notice">Copyright</a>
          2003-2006 All Rights Reserved, Georgia Tech Research Corporation.</div>
    <span class="invisitext">-- END OF PAGE</span>
</body>
</html>
